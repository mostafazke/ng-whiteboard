"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[343],{5686:(G,k,u)=>{u.d(k,{D:()=>f});var f=function(t){return t.BRUSH="BRUSH",t.LINE="LINE",t.RECT="RECT",t.ELLIPSE="ELLIPSE",t.IMAGE="IMAGE",t.TEXT="TEXT",t.SHAPE="SHAPE",t}(f||{})},9165:(G,k,u)=>{u.d(k,{a:()=>f});var f=function(t){return t.Png="png",t.Jpeg="jpeg",t.Svg="svg",t.Base64="base64",t}(f||{})},7162:(G,k,u)=>{u.d(k,{F:()=>f});var f=function(t){return t.BUTT="butt",t.SQUARE="square",t.ROUND="round",t}(f||{})},2603:(G,k,u)=>{u.d(k,{h:()=>f});var f=function(t){return t.MITER="miter",t.ROUND="round",t.BEVEL="bevel",t.MITER_CLIP="miter-clip",t}(f||{})},5556:(G,k,u)=>{u.d(k,{e:()=>f});var f=function(t){return t.SELECT="SELECT",t.BRUSH="BRUSH",t.IMAGE="IMAGE",t.LINE="LINE",t.RECT="RECT",t.ELLIPSE="ELLIPSE",t.TEXT="TEXT",t.ERASER="ERASER",t}(f||{})},343:(G,k,u)=>{u.d(k,{v:()=>pt});var f=u(9671),t=u(4769),Z=u(5619),U=u(2438),I=u(2181),p=u(5556),m=u(5686),b=u(2603),O=u(7162),z=u(9165);class ne{constructor(o){this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.lineCap=o.lineCap||O.F.ROUND,this.lineJoin=o.lineJoin||b.h.ROUND,this.dasharray=o.dasharray||"",this.dashoffset=o.dashoffset||0}}class Te{constructor(o){this.width=o.width||0,this.height=o.height||0,this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.dasharray=o.dasharray||"",this.fill=o.fill||"#000000"}}class Me{constructor(o){this.width=o.width||0,this.height=o.height||0,this.x1=o.x1||0,this.y1=o.y1||0,this.rx=o.rx||0,this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.fill=o.fill||"#000000",this.dasharray=o.dasharray||"",this.dashoffset=o.dashoffset||0}}class Ie{constructor(o){this.x1=o.x1||0,this.y1=o.y1||0,this.x2=o.x2||0,this.y2=o.y2||0,this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.lineCap=o.lineCap||O.F.ROUND,this.lineJoin=o.lineJoin||b.h.ROUND,this.dasharray=o.dasharray||"",this.dashoffset=o.dashoffset||0}}class Oe{constructor(o){this.cx=o.cx||0,this.cy=o.cy||0,this.rx=o.rx||0,this.ry=o.ry||0,this.dasharray=o.dasharray||"",this.dashoffset=o.dashoffset||0,this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.fill=o.fill||"#000000",this.lineCap=o.lineCap||O.F.ROUND,this.lineJoin=o.lineJoin||b.h.ROUND}}class Ne{constructor(o){this.left=o.left||0,this.top=o.top||0,this.width=o.width||0,this.height=o.height||0,this.fontFamily=o.fontFamily||"Arial",this.fontSize=o.fontSize||14,this.fontStyle=o.fontStyle||"normal",this.fontWeight=o.fontWeight||"normal",this.strokeWidth=o.strokeWidth||2,this.strokeColor=o.strokeColor||"#000000",this.fill=o.fill||"#000000",this.lineJoin=o.lineJoin||b.h.ROUND,this.lineCap=o.lineCap||O.F.ROUND,this.dasharray=o.dasharray||"",this.dashoffset=o.dashoffset||0}}class Pe{constructor(o,e,i){switch(this.x=0,this.y=0,this.rotation=0,this.opacity=100,this.options={},this.type=o,this.value=i||"",this.id=`element_${this.type}_${Math.floor(1e3*Math.random())}`,o){case m.D.BRUSH:this.options=new ne(e);break;case m.D.IMAGE:this.options=new Te(e);break;case m.D.RECT:this.options=new Me(e);break;case m.D.LINE:this.options=new Ie(e);break;case m.D.ELLIPSE:this.options=new Oe(e);break;case m.D.TEXT:this.options=new Ne(e);break;default:this.options={}}}}class v{static toSvgString(o){let i=(new XMLSerializer).serializeToString(o);return i=i.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),i=i.replace(/NS\d+:href/g,"xlink:href"),i}static snapToGrid(o,e){const i=e;return Math.round(o/i)*i}static snapToAngle(o,e,i,s){const r=Math.PI/4,h=i-o,a=s-e,l=Math.atan2(a,h),d=Math.sqrt(h*h+a*a),c=Math.round(l/r)*r;return{x:o+d*Math.cos(c),y:e+d*Math.sin(c),a:c}}static downloadFile(o,e){const i=document.createElement("a");i.href=o,i.setAttribute("visibility","hidden"),i.download=e||"new white-board",document.body.appendChild(i),i.click(),document.body.removeChild(i)}static svgToBase64(o,e,i,s=z.a.Png){return new Promise((r,h)=>{const a=document.createElement("canvas");a.width=e,a.height=i;const l=a.getContext("2d"),d=new Image;d.src=`data:image/svg+xml;base64,${btoa(o)}`,d.onload=()=>{l.drawImage(d,0,0,e,i);const c=a.toDataURL(`image/${s}`);r(c)},d.onerror=c=>{h(c)}})}static getSvgPathFromStroke(o,e=!0){const i=o.length;if(i<4)return"";let s=o[0],r=o[1];const h=o[2];let a=`M${s[0].toFixed(2)},${s[1].toFixed(2)} Q${r[0].toFixed(2)},${r[1].toFixed(2)} ${((r[0]+h[0])/2).toFixed(2)},${((r[1]+h[1])/2).toFixed(2)} T`;for(let l=2,d=i-1;l<d;l++)s=o[l],r=o[l+1],a+=`${((s[0]+r[0])/2).toFixed(2)},${((s[1]+r[1])/2).toFixed(2)} `;return e&&(a+="Z"),a}}var se=u(8645);let oe=(()=>{class n{constructor(){this.isPointing=!1,this.pointerDownSubject=new se.x,this.pointerMoveSubject=new se.x,this.pointerUpSubject=new se.x}onPointerDown(e){this.isPointing=!0,this.pointerDownSubject.next(e)}onPointerMove(e){this.isPointing&&this.pointerMoveSubject.next(e)}onPointerUp(e){this.isPointing=!1,this.pointerUpSubject.next(e)}getPointerDown$(){return this.pointerDownSubject.asObservable()}getPointerMove$(){return this.pointerMoveSubject.asObservable()}getPointerUp$(){return this.pointerUpSubject.asObservable()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();function _e(n,o,e,i=(s=>s)){return n*i(.5-o*(.5-e))}function N(n,o){return[n[0]+o[0],n[1]+o[1]]}function M(n,o){return[n[0]-o[0],n[1]-o[1]]}function P(n,o){return[n[0]*o,n[1]*o]}function Y(n){return[n[1],-n[0]]}function Ee(n,o){return n[0]*o[0]+n[1]*o[1]}function De(n,o){return n[0]===o[0]&&n[1]===o[1]}function xe(n,o){return function Ae(n){return n[0]*n[0]+n[1]*n[1]}(M(n,o))}function ve(n){return function Be(n,o){return[n[0]/o,n[1]/o]}(n,function We(n){return Math.hypot(n[0],n[1])}(n))}function Ge(n,o){return Math.hypot(n[1]-o[1],n[0]-o[0])}function $(n,o,e){let i=Math.sin(e),s=Math.cos(e),r=n[0]-o[0],h=n[1]-o[1];return[r*s-h*i+o[0],r*i+h*s+o[1]]}function re(n,o,e){return N(n,P(M(o,n),e))}function ye(n,o,e){return N(n,P(o,e))}var{min:H,PI:Ze}=Math,X=Ze+1e-4;function ae(n,o={}){return function Ue(n,o={}){let{size:e=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:h=(g=>g),start:a={},end:l={},last:d=!1}=o,{cap:c=!0,easing:E=(g=>g*(2-g))}=a,{cap:T=!0,easing:C=(g=>--g*g*g+1)}=l;if(0===n.length||e<=0)return[];let de,w=n[n.length-1].runningLength,B=!1===a.taper?0:!0===a.taper?Math.max(e,w):a.taper,j=!1===l.taper?0:!0===l.taper?Math.max(e,w):l.taper,ke=Math.pow(e*i,2),K=[],J=[],le=n.slice(0,10).reduce((g,y)=>{let _=y.pressure;if(r){let x=H(1,y.distance/e),ue=H(1,1-x);_=H(1,g+.275*x*(ue-g))}return(g+_)/2},n[0].pressure),S=_e(e,s,n[n.length-1].pressure,h),ce=n[0].vector,q=n[0].point,ee=q,L=q,F=ee,pe=!1;for(let g=0;g<n.length;g++){let{pressure:y}=n[g],{point:_,vector:x,distance:ue,runningLength:V}=n[g];if(g<n.length-1&&w-V<3)continue;if(s){if(r){let A=H(1,ue/e),fe=H(1,1-A);y=H(1,le+.275*A*(fe-le))}S=_e(e,s,y,h)}else S=e/2;void 0===de&&(de=S);let gt=V<B?E(V/B):1,ut=w-V<j?C((w-V)/j):1;S=Math.max(.01,S*Math.min(gt,ut));let Ce=(g<n.length-1?n[g+1]:n[g]).vector,me=g<n.length-1?Ee(x,Ce):1,Se=null!==me&&me<0;if(Ee(x,ce)<0&&!pe||Se){let A=P(Y(ce),S);for(let fe=1/13,ie=0;ie<=1;ie+=fe)L=$(M(_,A),_,X*ie),K.push(L),F=$(N(_,A),_,X*-ie),J.push(F);q=L,ee=F,Se&&(pe=!0);continue}if(pe=!1,g===n.length-1){let A=P(Y(x),S);K.push(M(_,A)),J.push(N(_,A));continue}let be=P(Y(re(Ce,x,me)),S);L=M(_,be),(g<=1||xe(q,L)>ke)&&(K.push(L),q=L),F=N(_,be),(g<=1||xe(ee,F)>ke)&&(J.push(F),ee=F),le=y,ce=x}let D=n[0].point.slice(0,2),W=n.length>1?n[n.length-1].point.slice(0,2):N(n[0].point,[1,1]),ge=[],te=[];if(1===n.length){if(!B&&!j||d){let g=ye(D,ve(Y(M(D,W))),-(de||S)),y=[];for(let _=1/13,x=_;x<=1;x+=_)y.push($(g,D,2*X*x));return y}}else{if(!(B||j&&1===n.length))if(c)for(let y=1/13,_=y;_<=1;_+=y){let x=$(J[0],D,X*_);ge.push(x)}else{let y=M(K[0],J[0]),_=P(y,.5),x=P(y,.51);ge.push(M(D,_),M(D,x),N(D,x),N(D,_))}let g=Y(function ze(n){return[-n[0],-n[1]]}(n[n.length-1].vector));if(j||B&&1===n.length)te.push(W);else if(T){let y=ye(W,g,S);for(let _=1/29,x=_;x<1;x+=_)te.push($(y,W,3*X*x))}else te.push(N(W,P(g,S)),N(W,P(g,.99*S)),M(W,P(g,.99*S)),M(W,P(g,S)))}return K.concat(te,J.reverse(),ge)}(function Le(n,o={}){var e;let{streamline:i=.5,size:s=16,last:r=!1}=o;if(0===n.length)return[];let h=.15+.85*(1-i),a=Array.isArray(n[0])?n:n.map(({x:C,y:w,pressure:B=.5})=>[C,w,B]);if(2===a.length){let C=a[1];a=a.slice(0,-1);for(let w=1;w<5;w++)a.push(re(a[0],C,w/4))}1===a.length&&(a=[...a,[...N(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],d=!1,c=0,E=l[0],T=a.length-1;for(let C=1;C<a.length;C++){let w=r&&C===T?a[C].slice(0,2):re(E.point,a[C],h);if(De(E.point,w))continue;let B=Ge(w,E.point);if(c+=B,C<T&&!d){if(c<s)continue;d=!0}E={point:w,pressure:a[C][2]>=0?a[C][2]:.5,vector:ve(M(E.point,w)),distance:B,runningLength:c},l.push(E)}return l[0].vector=(null==(e=l[1])?void 0:e.vector)||[0,0],l}(n,o),o)}var Fe=u(8915),Q=u(6814);let Re=(()=>{class n{constructor(e,i){this.elementRef=e,this.svgService=i}onPointerDown(e){0!==e.button&&1!==e.button&&5!==e.button||(this.elementRef.nativeElement.setPointerCapture(e.pointerId),this.svgService.onPointerDown(e))}onPointerMove(e){e.clientX===this.lastX&&e.clientY===this.lastY||(this.lastX=e.clientX,this.lastY=e.clientY,this.svgService.onPointerMove(e))}onPointerUp(e){0!==e.button&&1!==e.button&&2!==e.button&&5!==e.button||(this.lastX=e.clientX,this.lastY=e.clientY,this.elementRef.nativeElement.hasPointerCapture(e.pointerId)&&this.elementRef.nativeElement?.releasePointerCapture(e.pointerId),this.svgService.onPointerUp(e))}static#e=this.\u0275fac=function(i){return new(i||n)(t.Y36(t.SBq),t.Y36(oe))};static#t=this.\u0275dir=t.lG2({type:n,selectors:[["","svg",""]],hostBindings:function(i,s){1&i&&t.NdJ("pointerdown",function(h){return s.onPointerDown(h)})("pointermove",function(h){return s.onPointerMove(h)})("pointerup",function(h){return s.onPointerUp(h)})}})}return n})();const He=["svgContainer"],Je=["textInput"];function Ye(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"rect",19),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.uIk("width",e.canvasWidth*e.zoom+200)("height",e.canvasHeight*e.zoom+200)}}function $e(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"path",23),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("d",e.value)("stroke-dasharray",e.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.options.strokeWidth)("stroke-linecap",e.options.lineCap)("stroke-linejoin",e.options.lineJoin)("stroke",e.options.strokeColor)}}function Xe(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"image",24),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("height",e.options.height)("width",e.options.width)("href",e.value,null,"xlink")("href",e.value)("stroke-width",e.options.strokeWidth)("stroke-dasharray",e.options.dasharray)("fill",e.options.fill)("stroke",e.options.strokeColor)}}function Qe(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"line",25),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("x1",e.options.x1)("y1",e.options.y1)("x2",e.options.x2)("y2",e.options.y2)("stroke-dasharray",e.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.options.strokeWidth)("stroke-linecap",e.options.lineCap)("stroke-linejoin",e.options.lineJoin)("stroke",e.options.strokeColor)}}function je(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"rect",26),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("x",e.options.x2)("y",e.options.y2)("rx",e.options.rx)("width",e.options.width)("height",e.options.height)("stroke-dasharray",e.options.dasharray)("stroke-dashoffset",e.options.dashoffset)("stroke-width",e.options.strokeWidth)("fill",e.options.fill)("stroke",e.options.strokeColor)}}function Ke(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"ellipse",27),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("cx",e.options.cx)("cy",e.options.cy)("rx",e.options.rx)("ry",e.options.ry)("stroke-dasharray",e.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.options.strokeWidth)("stroke-linecap",e.options.lineCap)("stroke-linejoin",e.options.lineJoin)("stroke",e.options.strokeColor)("fill",e.options.fill)}}function qe(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g")(1,"text",28),t._uU(2),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.uIk("x",e.options.left)("y",e.options.top)("width",e.options.width)("height",e.options.height)("font-size",e.options.fontSize)("font-family",e.options.fontFamily)("stroke-dasharray",e.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.options.strokeWidth)("stroke-linecap",e.options.lineCap)("stroke-linejoin",e.options.lineJoin)("stroke",e.options.strokeColor)("fill",e.options.fill)("font-style",e.options.fontStyle)("font-weight",e.options.fontWeight),t.xp6(1),t.hij(" ",e.value," ")}}function Ve(n,o){1&n&&(t.O4$(),t.TgZ(0,"g")(1,"text"),t._uU(2,"Not defined type"),t.qZA()())}function et(n,o){if(1&n&&(t.O4$(),t.ynx(0),t.TgZ(1,"g",20),t.YNc(2,$e,2,7,"g",21),t.YNc(3,Xe,2,8,"g",21),t.YNc(4,Qe,2,10,"g",21),t.YNc(5,je,2,10,"g",21),t.YNc(6,Ke,2,11,"g",21),t.YNc(7,qe,3,16,"g",21),t.YNc(8,Ve,3,0,"g",22),t.qZA(),t.BQk()),2&n){const e=o.$implicit,i=t.oxw();t.xp6(1),t.Q6J("id","item_"+e.id)("ngSwitch",e.type),t.uIk("data-wb-id",e.id)("transform","translate("+e.x+","+e.y+")rotate("+e.rotation+")")("opacity",e.opacity/100),t.xp6(1),t.Q6J("ngSwitchCase",i.types.BRUSH),t.xp6(1),t.Q6J("ngSwitchCase",i.types.IMAGE),t.xp6(1),t.Q6J("ngSwitchCase",i.types.LINE),t.xp6(1),t.Q6J("ngSwitchCase",i.types.RECT),t.xp6(1),t.Q6J("ngSwitchCase",i.types.ELLIPSE),t.xp6(1),t.Q6J("ngSwitchCase",i.types.TEXT)}}function tt(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"path",23),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.uIk("d",e.tempElement.value)("stroke-dasharray",e.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.tempElement.options.strokeWidth)("stroke-linecap",e.tempElement.options.lineCap)("stroke-linejoin",e.tempElement.options.lineJoin)("stroke",e.tempElement.options.strokeColor)}}function it(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"image",24),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.uIk("height",e.tempElement.options.height)("width",e.tempElement.options.width)("href",e.tempElement.value,null,"xlink")("href",e.tempElement.value)("stroke-width",e.tempElement.options.strokeWidth)("stroke-dasharray",e.tempElement.options.dasharray)("fill",e.tempElement.options.fill)("stroke",e.tempElement.options.strokeColor)}}function nt(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"line",25),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.uIk("x1",e.tempElement.options.x1)("y1",e.tempElement.options.y1)("x2",e.tempElement.options.x2)("y2",e.tempElement.options.y2)("stroke-dasharray",e.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.tempElement.options.strokeWidth)("stroke-linecap",e.tempElement.options.lineCap)("stroke-linejoin",e.tempElement.options.lineJoin)("stroke",e.tempElement.options.strokeColor)}}function st(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"rect",26),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.uIk("x",e.tempElement.options.x2)("y",e.tempElement.options.y2)("rx",e.tempElement.options.rx)("width",e.tempElement.options.width)("height",e.tempElement.options.height)("stroke-dasharray",e.tempElement.options.dasharray)("stroke-dashoffset",e.tempElement.options.dashoffset)("stroke-width",e.tempElement.options.strokeWidth)("fill",e.tempElement.options.fill)("stroke",e.tempElement.options.strokeColor)}}function ot(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"ellipse",27),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.uIk("cx",e.tempElement.options.cx)("cy",e.tempElement.options.cy)("rx",e.tempElement.options.rx)("ry",e.tempElement.options.ry)("stroke-dasharray",e.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",e.tempElement.options.strokeWidth)("stroke-linecap",e.tempElement.options.lineCap)("stroke-linejoin",e.tempElement.options.lineJoin)("stroke",e.tempElement.options.strokeColor)("fill",e.tempElement.options.fill)}}function rt(n,o){1&n&&(t.O4$(),t._UZ(0,"g"))}function at(n,o){1&n&&(t.O4$(),t.TgZ(0,"g")(1,"text"),t._uU(2,"Not defined type"),t.qZA()())}function ht(n,o){if(1&n&&(t.O4$(),t.TgZ(0,"g",29),t.YNc(1,tt,2,7,"g",21),t.YNc(2,it,2,8,"g",21),t.YNc(3,nt,2,10,"g",21),t.YNc(4,st,2,10,"g",21),t.YNc(5,ot,2,11,"g",21),t.YNc(6,rt,1,0,"g",21),t.YNc(7,at,3,0,"g",22),t.qZA()),2&n){const e=t.oxw();t.Q6J("ngSwitch",e.selectedTool),t.xp6(1),t.Q6J("ngSwitchCase",e.tools.BRUSH),t.xp6(1),t.Q6J("ngSwitchCase",e.types.IMAGE),t.xp6(1),t.Q6J("ngSwitchCase",e.types.LINE),t.xp6(1),t.Q6J("ngSwitchCase",e.types.RECT),t.xp6(1),t.Q6J("ngSwitchCase",e.types.ELLIPSE),t.xp6(1),t.Q6J("ngSwitchCase",e.types.TEXT)}}function lt(n,o){if(1&n){const e=t.EpF();t.O4$(),t.TgZ(0,"g",30)(1,"g",31)(2,"g",32)(3,"rect",33),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.moveSelect(s))}),t.qZA()(),t.TgZ(4,"g",32),t._UZ(5,"circle",34)(6,"circle",35)(7,"circle",36)(8,"circle",37),t.TgZ(9,"rect",38),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(10,"rect",39),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(11,"rect",40),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(12,"rect",41),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(13,"rect",42),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(14,"rect",43),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(15,"rect",44),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA(),t.TgZ(16,"rect",45),t.NdJ("pointerdown",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.resizeSelect(s))}),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(1),t.Udp("display",e.rubberBox.display),t.uIk("transform","translate("+e.selectedElement.x+","+e.selectedElement.y+")rotate("+e.selectedElement.rotation+")"),t.xp6(2),t.uIk("x",e.rubberBox.x)("y",e.rubberBox.y)("width",e.rubberBox.width)("height",e.rubberBox.height),t.xp6(2),t.uIk("cx",e.rubberBox.x-4)("cy",e.rubberBox.y-4),t.xp6(1),t.uIk("cx",e.rubberBox.x+e.rubberBox.width+4)("cy",e.rubberBox.y-4),t.xp6(1),t.uIk("cx",e.rubberBox.x+e.rubberBox.width+4)("cy",e.rubberBox.y+e.rubberBox.height+4),t.xp6(1),t.uIk("cx",e.rubberBox.x-4)("cy",e.rubberBox.y+e.rubberBox.height+4),t.xp6(1),t.uIk("x",e.rubberBox.x-4)("y",e.rubberBox.y-4),t.xp6(1),t.uIk("x",e.rubberBox.x+e.rubberBox.width/2-4)("y",e.rubberBox.y-4),t.xp6(1),t.uIk("x",e.rubberBox.x+e.rubberBox.width-4)("y",e.rubberBox.y-4),t.xp6(1),t.uIk("x",e.rubberBox.x+e.rubberBox.width-4)("y",e.rubberBox.y+e.rubberBox.height/2-4),t.xp6(1),t.uIk("x",e.rubberBox.x+e.rubberBox.width-4)("y",e.rubberBox.y+e.rubberBox.height-4),t.xp6(1),t.uIk("x",e.rubberBox.x+e.rubberBox.width/2-4)("y",e.rubberBox.y+e.rubberBox.height-4),t.xp6(1),t.uIk("x",e.rubberBox.x-4)("y",e.rubberBox.y+e.rubberBox.height-4),t.xp6(1),t.uIk("x",e.rubberBox.x-4)("y",e.rubberBox.y+e.rubberBox.height/2-4)}}function dt(n,o){if(1&n){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div")(1,"input",46,47),t.NdJ("input",function(){t.CHM(e);const s=t.MAs(2),r=t.oxw();return t.KtG(r.updateTextItem(s.value))}),t.qZA()()}if(2&n){const e=t.MAs(2),i=t.oxw();t.Udp("font-family",i.fontFamily)("font-size",i.fontSize,"px")("pointer-events","none")("width",i.canvasWidth*i.zoom,"px")("height",i.canvasHeight*i.zoom,"px")("position","absolute")("top",i.y,"px")("left",i.x,"px"),t.xp6(1),t.Udp("width",e.value.length+"ch")("height",2*i.zoom+"ch")("top",(i.tempElement.options.top||0)*i.zoom,"px")("left",(i.tempElement.options.left||0)*i.zoom,"px")("font-size",i.tempElement.options.fontSize,"px"),t.Q6J("value",i.tempElement.value)}}const ct=function(n,o){return[0,0,n,o]},he={size:1,smoothing:1,thinning:0,streamline:.9};let pt=(()=>{class n{set data(e){e&&this._data.next(e)}get data(){return this._data.getValue()}set selectedTool(e){this._selectedTool!==e&&(this._selectedTool===p.e.TEXT&&this.tempElement?.type===m.D.TEXT&&this.finishTextInput(),this._selectedTool=e,this.toolChanged.emit(e),this.clearSelectedElement(),this.tempElement=null)}get selectedTool(){return this._selectedTool}constructor(e,i,s){this.whiteboardService=e,this._cd=i,this._svgService=s,this._data=new Z.X([]),this.drawingEnabled=!0,this.canvasWidth=800,this.canvasHeight=600,this.fullScreen=!0,this.center=!0,this.strokeColor="#000",this.strokeWidth=2,this.backgroundColor="#fff",this.lineJoin=b.h.ROUND,this.lineCap=O.F.ROUND,this.fill="#333",this.zoom=1,this.fontFamily="sans-serif",this.fontSize=24,this.dasharray="",this.dashoffset=0,this.x=0,this.y=0,this.enableGrid=!1,this.gridSize=10,this.snapToGrid=!1,this.ready=new t.vpe,this.dataChange=new t.vpe,this.clear=new t.vpe,this.undo=new t.vpe,this.redo=new t.vpe,this.save=new t.vpe,this.imageAdded=new t.vpe,this.selectElement=new t.vpe,this.deleteElement=new t.vpe,this.toolChanged=new t.vpe,this._subscriptionList=[],this._initialData=[],this.undoStack=[],this.redoStack=[],this._selectedTool=p.e.BRUSH,this.types=m.D,this.tools=p.e,this.rubberBox={x:0,y:0,width:0,height:0,display:"none"}}ngOnInit(){this._initInputsFromOptions(this.options),this._initObservables(),this._initialData=JSON.parse(JSON.stringify(this.data))}ngOnChanges(e){e.options&&this._initInputsFromOptions(e.options.currentValue)}ngAfterViewInit(){this._resizeScreen(),this._cd.detectChanges(),this.ready.emit()}ngOnDestroy(){this._subscriptionList.forEach(e=>this._unsubscribe(e))}_initInputsFromOptions(e){e&&(null!=e.drawingEnabled&&(this.drawingEnabled=e.drawingEnabled),null!=e.selectedTool&&(this.selectedTool=e.selectedTool),null!=e.canvasWidth&&(this.canvasWidth=e.canvasWidth),null!=e.canvasHeight&&(this.canvasHeight=e.canvasHeight),null!=e.fullScreen&&(this.fullScreen=e.fullScreen),null!=e.center&&(this.center=e.center),null!=e.strokeColor&&(this.strokeColor=e.strokeColor),null!=e.strokeWidth&&(this.strokeWidth=e.strokeWidth),null!=e.backgroundColor&&(this.backgroundColor=e.backgroundColor),null!=e.lineJoin&&(this.lineJoin=e.lineJoin),null!=e.lineCap&&(this.lineCap=e.lineCap),null!=e.fill&&(this.fill=e.fill),null!=e.zoom&&(this.zoom=e.zoom),null!=e.fontFamily&&(this.fontFamily=e.fontFamily),null!=e.fontSize&&(this.fontSize=e.fontSize),null!=e.dasharray&&(this.dasharray=e.dasharray),null!=e.dashoffset&&(this.dashoffset=e.dashoffset),null!=e.x&&(this.x=e.x),null!=e.y&&(this.y=e.y),null!=e.enableGrid&&(this.enableGrid=e.enableGrid),null!=e.gridSize&&(this.gridSize=e.gridSize),null!=e.snapToGrid&&(this.snapToGrid=e.snapToGrid))}_initObservables(){this._subscriptionList.push(this._svgService.getPointerDown$().subscribe(this.handleStartEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerMove$().subscribe(this.handleDragEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerUp$().subscribe(this.handleEndEvent.bind(this))),this._subscriptionList.push(this.whiteboardService.saveMethodCalled$.subscribe(({name:e,format:i})=>this.saveDraw(e,i))),this._subscriptionList.push(this.whiteboardService.addImageMethodCalled$.subscribe(e=>this.addImage(e))),this._subscriptionList.push(this.whiteboardService.eraseMethodCalled$.subscribe(()=>this.clearDraw())),this._subscriptionList.push(this.whiteboardService.undoMethodCalled$.subscribe(()=>this.undoDraw())),this._subscriptionList.push(this.whiteboardService.redoMethodCalled$.subscribe(()=>this.redoDraw())),this._subscriptionList.push((0,U.R)(window,"resize").subscribe(()=>this._resizeScreen())),this._subscriptionList.push(this._data.pipe(function R(n){return(0,I.h)((o,e)=>n<=e)}(1)).subscribe(e=>{this.dataChange.emit(e)}))}handleStartEvent(e){this.redoStack=[];const s={[p.e.BRUSH]:this.handleStartBrush,[p.e.IMAGE]:this.handleImageTool,[p.e.LINE]:this.handleStartLine,[p.e.RECT]:this.handleStartRect,[p.e.ELLIPSE]:this.handleStartEllipse,[p.e.TEXT]:this.handleTextTool,[p.e.SELECT]:this.handleSelectTool,[p.e.ERASER]:this.handleEraserTool}[this.selectedTool];s&&s.apply(this,[e])}handleDragEvent(e){const s={[p.e.BRUSH]:this.handleDragBrush,[p.e.LINE]:this.handleDragLine,[p.e.RECT]:this.handleDragRect,[p.e.ELLIPSE]:this.handleDragEllipse,[p.e.TEXT]:this.handleTextDrag}[this.selectedTool];s&&s.apply(this,[e])}handleEndEvent(e){const s={[p.e.BRUSH]:this.handleEndBrush,[p.e.LINE]:this.handleEndLine,[p.e.RECT]:this.handleEndRect,[p.e.ELLIPSE]:this.handleEndEllipse,[p.e.TEXT]:this.handleTextEnd}[this.selectedTool];s&&s.apply(this,[e])}handleStartBrush(e){const i=this._generateNewElement(m.D.BRUSH);this.tempDraw=[this._calculateXAndY([e.offsetX,e.offsetY])];const s=ae(this.tempDraw,he),r=v.getSvgPathFromStroke(s);i.value=r,i.options.strokeWidth=this.strokeWidth,this.tempElement=i}handleDragBrush(e){this.tempDraw.push(this._calculateXAndY([e.offsetX,e.offsetY]));const i=ae(this.tempDraw,he),s=v.getSvgPathFromStroke(i);this.tempElement.value=s}handleEndBrush(e){this.tempDraw.push(this._calculateXAndY([e.offsetX,e.offsetY]));const i=ae(this.tempDraw,he),s=v.getSvgPathFromStroke(i);this.tempElement.value=s,this._pushToData(this.tempElement),this._pushToUndo(),this.tempDraw=null,this.tempElement=null}handleImageTool(e){const[i,s]=this._calculateXAndY([e.offsetX,e.offsetY]),r=document.createElement("input");r.type="file",r.accept="image/*",r.onchange=h=>{const a=h.target.files;if(a){const l=new FileReader;l.onload=d=>{this.addImage({image:d.target.result,x:i,y:s})},l.readAsDataURL(a[0])}},r.click()}handleStartLine(e){const i=this._generateNewElement(m.D.LINE);let[s,r]=this._calculateXAndY([e.offsetX,e.offsetY]);this.snapToGrid&&(s=v.snapToGrid(s,this.gridSize),r=v.snapToGrid(r,this.gridSize)),i.options.x1=s,i.options.y1=r,i.options.x2=s,i.options.y2=r,this.tempElement=i}handleDragLine(e){let[i,s]=this._calculateXAndY([e.offsetX,e.offsetY]);if(this.snapToGrid&&(i=v.snapToGrid(i,this.gridSize),s=v.snapToGrid(s,this.gridSize)),e.shiftKey){const r=this.tempElement.options.x1,h=this.tempElement.options.y1,{x:a,y:l}=v.snapToAngle(r,h,i,s);[i,s]=[a,l]}this.tempElement.options.x2=i,this.tempElement.options.y2=s}handleEndLine(){(this.tempElement.options.x1!=this.tempElement.options.x2||this.tempElement.options.y1!=this.tempElement.options.y2)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartRect(e){const i=this._generateNewElement(m.D.RECT);let[s,r]=this._calculateXAndY([e.offsetX,e.offsetY]);this.snapToGrid&&(s=v.snapToGrid(s,this.gridSize),r=v.snapToGrid(r,this.gridSize)),i.options.x1=s,i.options.y1=r,i.options.x2=s,i.options.y2=r,i.options.width=1,i.options.height=1,this.tempElement=i}handleDragRect(e){const[i,s]=this._calculateXAndY([e.offsetX,e.offsetY]),r=this.tempElement.options.x1||0,h=this.tempElement.options.y1||0;let a=Math.abs(i-r),l=Math.abs(s-h),d=null,c=null;e.shiftKey?(a=l=Math.max(a,l),d=r<i?r:r-a,c=h<s?h:h-l):(d=Math.min(r,i),c=Math.min(h,s)),e.altKey&&(a*=2,l*=2,d=r-a/2,c=h-l/2),this.snapToGrid&&(a=v.snapToGrid(a,this.gridSize),l=v.snapToGrid(l,this.gridSize),d=v.snapToGrid(d,this.gridSize),c=v.snapToGrid(c,this.gridSize)),this.tempElement.options.width=a,this.tempElement.options.height=l,this.tempElement.options.x2=d,this.tempElement.options.y2=c}handleEndRect(){(0!=this.tempElement.options.width||0!=this.tempElement.options.height)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartEllipse(e){const i=this._generateNewElement(m.D.ELLIPSE),[s,r]=this._calculateXAndY([e.offsetX,e.offsetY]);i.options.x1=s,i.options.y1=r,i.options.cx=s,i.options.cy=r,this.tempElement=i}handleDragEllipse(e){const[i,s]=this._calculateXAndY([e.offsetX,e.offsetY]),r=this.tempElement.options.x1||0,h=this.tempElement.options.y1||0;let a=Math.abs(r+(i-r)/2),l=Math.abs(h+(s-h)/2),d=Math.abs(r-a),c=Math.abs(h-l);e.shiftKey&&(c=d,l=s>h?h+d:h-d),e.altKey&&(a=r,l=h,d=Math.abs(i-a),c=e.shiftKey?d:Math.abs(s-l)),this.tempElement.options.rx=d,this.tempElement.options.ry=c,this.tempElement.options.cx=a,this.tempElement.options.cy=l}handleEndEllipse(){(0!=this.tempElement.options.rx||0!=this.tempElement.options.ry)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleTextTool(e){if(this.tempElement)return void this.finishTextInput();let i=this._getTargetElement(e);if(i&&i.type===m.D.TEXT)this._removeFromData(i);else{i=this._generateNewElement(m.D.TEXT);const[s,r]=this._calculateXAndY([e.offsetX,e.offsetY]);i.options.top=r,i.options.left=s,i.options.strokeWidth=0}this.tempElement=i,this._cd.detectChanges(),setTimeout(()=>{this.textInput.nativeElement.focus()},0)}handleTextDrag(e){if(!this.tempElement)return;const[i,s]=this._calculateXAndY([e.offsetX,e.offsetY]);this.tempElement.options.top=s,this.tempElement.options.left=i}handleTextEnd(){this.tempElement&&this._pushToUndo()}handleSelectTool(e){const i=this._getMouseTarget(e);if(i){if("selectorGroup"===i.id)return;const s=i.getAttribute("data-wb-id"),r=this.data.find(h=>h.id===s);this.setSelectedElement(r)}else this.clearSelectedElement()}handleEraserTool(e){const i=this._getTargetElement(e);i&&(this.data=this.data.filter(s=>s.id!==i.id),this._pushToUndo(),this.deleteElement.emit(i))}finishTextInput(){this.tempElement.value=this.textInput.nativeElement.value,this.tempElement.value&&(this._pushToData(this.tempElement),this._pushToUndo()),this.tempElement=null}updateTextItem(e){this.tempElement&&this.selectedTool==p.e.TEXT&&(this.tempElement.value=e)}setSelectedElement(e){this.selectedTool=p.e.SELECT;const i=this._getElementBbox(e);this.selectedElement=e,this.selectElement.emit(e),this._showGrips(i)}clearSelectedElement(){this.selectedElement=null,this.rubberBox.display="none",this.selectElement.emit(null)}addImage(e){const i=new Image;i.onload=()=>{const s=this.canvasHeight,r=i.width,h=i.height,l=h>s?s-40:h,d=l===s-40?i.width/i.height*(s-40):r;let c=e.x||(r-d)*(e.x||0),E=e.y||(h-l)*(e.y||0);c<0&&(c=0),E<0&&(E=0);const T=this._generateNewElement(m.D.IMAGE);T.value=e.image,T.options.width=d,T.options.height=l,T.x=c,T.y=E,this._pushToData(T),this.imageAdded.emit(),this._pushToUndo()},i.src=e.image}saveDraw(e,i){var s=this;return(0,f.Z)(function*(){const h=s.svgContainer.nativeElement.getElementById("svgcontent").cloneNode(!0),a=h.getElementById("selectorParentGroup");a&&a.remove();const l=h.getElementById("contentBackground");l&&l.removeAttribute("opacity"),h.setAttribute("x","0"),h.setAttribute("y","0");const d=(new XMLSerializer).serializeToString(h),c=yield v.svgToBase64(d,s.canvasWidth,s.canvasHeight,i);switch(i){case z.a.Base64:s.save.emit(c);break;case z.a.Svg:{const E="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(d)));v.downloadFile(E,e),s.save.emit(E);break}default:v.downloadFile(c,e),s.save.emit(c)}})()}clearDraw(){this.data=[],this._data.next(this.data),this._pushToUndo(),this.clear.emit()}undoDraw(){if(!this.undoStack.length)return;const e=this.undoStack.pop();this.redoStack.push(e),this.data=this.undoStack.length?JSON.parse(JSON.stringify(this.undoStack[this.undoStack.length-1])):JSON.parse(JSON.stringify(this._initialData)),this.undo.emit()}redoDraw(){if(!this.redoStack.length)return;const e=this.redoStack.pop();this.undoStack.push(JSON.parse(JSON.stringify(e))),this.data=e,this.redo.emit()}_pushToUndo(){this.undoStack.push(JSON.parse(JSON.stringify(this.data)))}_pushToData(e){this.data.push(e),this._data.next(this.data)}_removeFromData(e){const i=this.data.indexOf(e);i>-1&&(this.data.splice(i,1),this._data.next(this.data))}_generateNewElement(e){return new Pe(e,{strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fill:this.fill,lineJoin:this.lineJoin,lineCap:this.lineCap,fontSize:this.fontSize,fontFamily:this.fontFamily,dasharray:this.dasharray,dashoffset:this.dashoffset})}_calculateXAndY([e,i]){return[(e-this.x)/this.zoom,(i-this.y)/this.zoom]}_resizeScreen(){const e=this.svgContainer.nativeElement;this.fullScreen&&(this.canvasWidth=e.clientWidth,this.canvasHeight=e.clientHeight),this.center&&(this.x=e.clientWidth/2-this.canvasWidth/2,this.y=e.clientHeight/2-this.canvasHeight/2)}_getElementBbox(e){return this.svgContainer.nativeElement.getElementById(`item_${e.id}`).getBBox()}_getMouseTarget(e){if(null==e||null==e.target)return null;let i=e.target;if("svgroot"===i.id)return null;if(i.parentNode){if(i=i.parentNode.parentNode,"selectorGroup"===i.id)return i;for(;!i.id.includes("item_");){if("svgroot"===i.id)return null;i=i.parentNode}}return i}_getTargetElement(e){const i=this._getMouseTarget(e);if(i){if("selectorGroup"===i.id)return null;const s=i.getAttribute("data-wb-id");return this.data.find(r=>r.id===s)}return null}_showGrips(e){this.rubberBox={x:e.x-.5*(this.selectedElement.options.strokeWidth||0),y:e.y-.5*(this.selectedElement.options.strokeWidth||0),width:e.width+this.selectedElement.options.strokeWidth||0,height:e.height+this.selectedElement.options.strokeWidth||0,display:"block"}}moveSelect(e){let i=!0;e.stopPropagation();const s=e.target;s.addEventListener("pointermove",r=>{i&&this.selectedElement&&(this.selectedElement.x+=r.movementX,this.selectedElement.y+=r.movementY)}),s.addEventListener("pointerup",()=>{i=!1})}resizeSelect(e){let i=!0;const s=e.target;document.addEventListener("pointermove",r=>{if(!i)return;const h=s.id.split("_")[2],a=r.movementX,l=r.movementY,d=this._getElementBbox(this.selectedElement),c=d.width,E=d.height;switch(this.selectedElement.type){case m.D.ELLIPSE:this._resizeElipse(h,{x:a,y:l,width:c,height:E});break;case m.D.LINE:this._resizeLine(h,{x:a,y:l,width:c,height:E});break;default:this._resizeDefault(h,{x:a,y:l,width:c,height:E})}this._showGrips(this._getElementBbox(this.selectedElement))}),document.addEventListener("pointerup",()=>{i=!1})}_resizeLine(e,i){switch(e){case"nw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y1+=i.y;break;case"n":this.selectedElement.options.y1+=i.y;break;case"ne":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y1+=i.y;break;case"e":this.selectedElement.options.x2+=i.x;break;case"se":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y2+=i.y;break;case"s":this.selectedElement.options.y2+=i.y;break;case"sw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y2+=i.y;break;case"w":this.selectedElement.options.x1+=i.x}}_resizeElipse(e,i){switch(e){case"nw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"n":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry-=i.y/2;break;case"ne":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"e":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx+=i.x/2;break;case"se":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"s":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry+=i.y/2;break;case"sw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"w":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx-=i.x/2}}_resizeDefault(e,i){switch(e){case"nw":this.selectedElement.x+=i.x,this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height-i.y;break;case"n":this.selectedElement.y+=i.y,this.selectedElement.options.height=i.height-i.y;break;case"ne":this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height-i.y;break;case"e":this.selectedElement.options.width=i.width+i.x;break;case"se":this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height+i.y;break;case"s":this.selectedElement.options.height=i.height+i.y;break;case"sw":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height+i.y;break;case"w":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x}}_unsubscribe(e){e&&e.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(t.Y36(Fe.v),t.Y36(t.sBO),t.Y36(oe))};static#t=this.\u0275cmp=t.Xpm({type:n,selectors:[["ng-whiteboard"]],viewQuery:function(i,s){if(1&i&&(t.Gf(He,5),t.Gf(Je,5)),2&i){let r;t.iGM(r=t.CRH())&&(s.svgContainer=r.first),t.iGM(r=t.CRH())&&(s.textInput=r.first)}},inputs:{data:"data",options:"options",selectedTool:"selectedTool",drawingEnabled:"drawingEnabled",canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",fullScreen:"fullScreen",center:"center",strokeColor:"strokeColor",strokeWidth:"strokeWidth",backgroundColor:"backgroundColor",lineJoin:"lineJoin",lineCap:"lineCap",fill:"fill",zoom:"zoom",fontFamily:"fontFamily",fontSize:"fontSize",dasharray:"dasharray",dashoffset:"dashoffset",x:"x",y:"y",enableGrid:"enableGrid",gridSize:"gridSize",snapToGrid:"snapToGrid"},outputs:{ready:"ready",dataChange:"dataChange",clear:"clear",undo:"undo",redo:"redo",save:"save",imageAdded:"imageAdded",selectElement:"selectElement",deleteElement:"deleteElement",toolChanged:"toolChanged"},features:[t._Bn([oe]),t.TTD],decls:19,vars:24,consts:[["id","svgroot","xlinkns","http://www.w3.org/2000/svg","svg",""],["svgContainer",""],["id","canvasBackground",2,"pointer-events","none"],["id","grid-pattern"],["id","smallGrid","patternUnits","userSpaceOnUse"],["fill","none","stroke","gray","stroke-width","0.5"],["id","grid","width","100","height","100","patternUnits","userSpaceOnUse"],["width","100","height","100","fill","url(#smallGrid)"],["d","M 100 0 H 0 V 100","fill","none","stroke","gray","stroke-width","2"],["id","placeholder_defs"],["width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent",2,"pointer-events","none"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","id","svgcontent"],["id","contentBackground","opacity","0","width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent"],[2,"pointer-events","all"],[4,"ngFor","ngForOf"],["class","temp-element",3,"ngSwitch",4,"ngIf"],["id","selectorParentGroup",4,"ngIf"],[3,"font-family","font-size","pointer-events","width","height","position","top","left",4,"ngIf"],["x","-100","y","-100","fill","url(#grid)"],[1,"wb_element",3,"id","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["fill","none",1,"brush"],["preserveAspectRatio","none",2,"pointer-events","inherit"],[1,"line",2,"pointer-events","inherit"],[1,"rect"],[2,"pointer-events","inherit"],["text-anchor","start",0,"xml","space","preserve","alignment-baseline","before-edge",1,"text_element",2,"pointer-events","inherit","white-space","normal"],[1,"temp-element",3,"ngSwitch"],["id","selectorParentGroup"],["id","selectorGroup","transform","",1,"selectorGroup"],["display","inline"],["id","selectedBox","fill","none","stroke","#4F80FF","shape-rendering","crispEdges",2,"cursor","move",3,"pointerdown"],["id","selectorGrip_rotate_nw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_ne","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_se","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_sw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_resize_nw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","nw-resize",3,"pointerdown"],["id","selectorGrip_resize_n","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","n-resize",3,"pointerdown"],["id","selectorGrip_resize_ne","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","ne-resize",3,"pointerdown"],["id","selectorGrip_resize_e","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","e-resize",3,"pointerdown"],["id","selectorGrip_resize_se","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","se-resize",3,"pointerdown"],["id","selectorGrip_resize_s","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","s-resize",3,"pointerdown"],["id","selectorGrip_resize_sw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","sw-resize",3,"pointerdown"],["id","selectorGrip_resize_w","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","w-resize",3,"pointerdown"],["type","text","autofocus","",1,"text-input",3,"value","input"],["textInput",""]],template:function(i,s){1&i&&(t.O4$(),t.TgZ(0,"svg",0,1)(2,"svg",2)(3,"defs",3)(4,"pattern",4),t._UZ(5,"path",5),t.qZA(),t.TgZ(6,"pattern",6),t._UZ(7,"rect",7)(8,"path",8),t.qZA()(),t._UZ(9,"defs",9)(10,"rect",10),t.YNc(11,Ye,2,2,"g",11),t.qZA(),t.TgZ(12,"svg",12),t._UZ(13,"rect",13),t.TgZ(14,"g",14),t.YNc(15,et,9,11,"ng-container",15),t.YNc(16,ht,8,7,"g",16),t.YNc(17,lt,17,31,"g",17),t.qZA()()(),t.YNc(18,dt,3,27,"div",18)),2&i&&(t.Tol("svgroot "+s.selectedTool),t.xp6(2),t.uIk("width",s.canvasWidth*s.zoom)("height",s.canvasHeight*s.zoom)("x",s.x)("y",s.y),t.xp6(2),t.uIk("width",s.gridSize)("height",s.gridSize),t.xp6(1),t.uIk("d","M "+s.gridSize+" 0 H 0 V "+s.gridSize),t.xp6(5),t.uIk("fill",s.backgroundColor),t.xp6(1),t.Q6J("ngIf",s.enableGrid),t.xp6(1),t.uIk("width",s.canvasWidth*s.zoom)("height",s.canvasHeight*s.zoom)("viewBox",t.WLB(21,ct,s.canvasWidth,s.canvasHeight))("x",s.x)("y",s.y),t.xp6(1),t.uIk("fill",s.backgroundColor),t.xp6(2),t.Q6J("ngForOf",s.data),t.xp6(1),t.Q6J("ngIf",s.tempElement),t.xp6(1),t.Q6J("ngIf",s.selectedElement),t.xp6(1),t.Q6J("ngIf",s.tempElement&&s.selectedTool===s.tools.TEXT))},dependencies:[Q.sg,Q.O5,Q.RF,Q.n9,Q.ED,Re],styles:["[_nghost-%COMP%]{width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit;background-size:cover;background-position:50%;background-repeat:no-repeat}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .wb_element[_ngcontent-%COMP%], [_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .selectorGroup[_ngcontent-%COMP%]{transform-box:fill-box;transform-origin:center}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif}[_nghost-%COMP%]   .svgroot.drawing[_ngcontent-%COMP%]{cursor:url(cursor.26a16ca9d3ef8cca.svg) 5 5,crosshair}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]{cursor:move}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .HAND[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]   .SELECT[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .BRUSH[_ngcontent-%COMP%]{cursor:url(pencil.01bca0b683fe9ac2.svg) 1 18,crosshair}[_nghost-%COMP%]   .IMAGE[_ngcontent-%COMP%]{cursor:copy}[_nghost-%COMP%]   .LINE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .RECT[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .ELLIPSE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .TEXT[_ngcontent-%COMP%]{cursor:text}[_nghost-%COMP%]   .ERASER[_ngcontent-%COMP%]{cursor:url(eraser.beda18ae5a379b15.svg) 0 12,crosshair}.foreign[_ngcontent-%COMP%]{text-align:left}.insideforeign[_ngcontent-%COMP%]{display:inline-block}.text-input[_ngcontent-%COMP%]{position:absolute;background:transparent;border:1px dashed #0b89f0;outline:none;height:25px;font-size:inherit;font-family:inherit;min-width:5ch;height:2ch;padding:0;pointer-events:auto;z-index:5}"]})}return n})()},8915:(G,k,u)=>{u.d(k,{v:()=>U});var f=u(8645),t=u(9165),Z=u(4769);let U=(()=>{class I{constructor(){this.eraseMethodCallSource=new f.x,this.saveMethodCallSource=new f.x,this.undoMethodCallSource=new f.x,this.redoMethodCallSource=new f.x,this.addImageMethodCallSource=new f.x,this.eraseMethodCalled$=this.eraseMethodCallSource.asObservable(),this.saveMethodCalled$=this.saveMethodCallSource.asObservable(),this.undoMethodCalled$=this.undoMethodCallSource.asObservable(),this.redoMethodCalled$=this.redoMethodCallSource.asObservable(),this.addImageMethodCalled$=this.addImageMethodCallSource.asObservable()}erase(){this.eraseMethodCallSource.next()}save(p=t.a.Base64,m="New board"){this.saveMethodCallSource.next({name:m,format:p})}undo(){this.undoMethodCallSource.next()}redo(){this.redoMethodCallSource.next()}addImage(p,m,b){this.addImageMethodCallSource.next({image:p,x:m,y:b})}static#e=this.\u0275fac=function(m){return new(m||I)};static#t=this.\u0275prov=Z.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"})}return I})()},9671:(G,k,u)=>{function f(Z,U,I,R,p,m,b){try{var O=Z[m](b),z=O.value}catch(ne){return void I(ne)}O.done?U(z):Promise.resolve(z).then(R,p)}function t(Z){return function(){var U=this,I=arguments;return new Promise(function(R,p){var m=Z.apply(U,I);function b(z){f(m,R,p,b,O,"next",z)}function O(z){f(m,R,p,b,O,"throw",z)}b(void 0)})}}u.d(k,{Z:()=>t})}}]);