"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[213],{4213:(d_,nr,X)=>{X.r(nr),X.d(nr,{LiveAppModule:()=>c_});var ze=X(177),ir=X(8935),xe=X(6158),b=X(4523);const _=function(n,e){if(!n)throw Ge(e)},Ge=function(n){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+n)},sr=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=63&s|128):55296==(64512&s)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++i)),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=63&s|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=63&s|128)}return e},jn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],a=s+1<n.length,l=a?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0;let p=(15&l)<<2|u>>6,f=63&u;c||(f=64,a||(p=64)),i.push(t[o>>2],t[(3&o)<<4|l>>4],t[p],t[f])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(sr(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((31&s)<<6|63&o)}else if(s>239&&s<365){const c=((7&s)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(1023&c))}else{const o=n[t++],a=n[t++];e[i++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,null==o||null==l||null==u||null==d)throw new cl;i.push(o<<2|l>>4),64!==u&&(i.push(l<<4&240|u>>2),64!==d&&i.push(u<<6&192|d))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cl extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rr=function(n){const e=sr(n);return jn.encodeByteArray(e,!0)},Bt=function(n){return rr(n).replace(/\./g,"")},Vt=function(n){try{return jn.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ul(n){return or(void 0,n)}function or(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!dl(t)||(n[t]=or(n[t],e[t]));return n}function dl(n){return"__proto__"!==n}const zt=()=>{try{return function hl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Vt(n[1]);return e&&JSON.parse(e)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},ar=()=>{var n;return null===(n=zt())||void 0===n?void 0:n.config};class at{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,i))}}}function lr(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function Gt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}function cr(){try{return"object"==typeof indexedDB}catch{return!1}}function ur(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e((null===(o=s.error)||void 0===o?void 0:o.message)||"")}}catch(t){e(t)}})}class Ie extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,Ie.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wt.prototype.create)}}class Wt{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?function Il(n,e){return n.replace(Tl,(t,i)=>{const s=e[i];return null!=s?String(s):`<${i}?>`})}(o,i):"Error";return new Ie(s,`${this.serviceName}: ${a} (${s}).`,i)}}const Tl=/\{\$([^}]+)}/g;function lt(n){return JSON.parse(n)}function D(n){return JSON.stringify(n)}const $t=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=lt(Vt(o[0])||""),t=lt(Vt(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}};function K(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function We(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function dr(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ut(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ht(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],a=e[s];if(hr(o)&&hr(a)){if(!Ht(o,a))return!1}else if(o!==a)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function hr(n){return null!==n&&"object"==typeof n}class Nl{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if("string"==typeof e)for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const p=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=4294967295&(p<<1|p>>>31)}let u,h,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(u=l^o&(a^l),h=1518500249):(u=o^a^l,h=1859775393):d<60?(u=o&a|l&(o|a),h=2400959708):(u=o^a^l,h=3395469782);const p=(s<<5|s>>>27)+u+c+h+i[d]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=p}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let a=this.inbuf_;for(;s<t;){if(0===a)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(o[a]=e.charCodeAt(s),++a,++s,a===this.blockSize){this.compress_(o),a=0;break}}else for(;s<t;)if(o[a]=e[s],++a,++s,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=255&t,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function $e(n,e){return`${n} failed: ${e} argument `}const Yt=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e},Pl=1e3,Ll=2,jl=144e5,Ol=.5;function pr(n,e=Pl,t=Ll){const i=e*Math.pow(t,n),s=Math.round(Ol*i*(Math.random()-.5)*2);return Math.min(jl,i+s)}function Te(n){return n&&n._delegate?n._delegate:n}class re{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Se="[DEFAULT]";class Bl{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new at;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),s=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function zl(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Se})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Se){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return(0,b.A)(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...t.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=Se){return this.instances.has(e)}getOptions(e=Se){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,a]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(o)&&a.resolve(s);return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=null!==(i=this.onInitCallbacks.get(s))&&void 0!==i?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const a=this.instances.get(s);return a&&e(a,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e,n===Se?void 0:n),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}var n;return i||null}normalizeInstanceIdentifier(e=Se){return this.component?this.component.multipleInstances?e:Se:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Gl{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Bl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Mn=[];var T=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(T||{});const fr={debug:T.DEBUG,verbose:T.VERBOSE,info:T.INFO,warn:T.WARN,error:T.ERROR,silent:T.SILENT},Wl=T.INFO,$l={[T.DEBUG]:"log",[T.VERBOSE]:"log",[T.INFO]:"info",[T.WARN]:"warn",[T.ERROR]:"error"},Ul=(n,e,...t)=>{if(e<n.logLevel)return;const i=(new Date).toISOString(),s=$l[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${n.name}:`,...t)};class Bn{constructor(e){this.name=e,this._logLevel=Wl,this._logHandler=Ul,this._userLogHandler=null,Mn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in T))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?fr[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,T.DEBUG,...e),this._logHandler(this,T.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,T.VERBOSE,...e),this._logHandler(this,T.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,T.INFO,...e),this._logHandler(this,T.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,T.WARN,...e),this._logHandler(this,T.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,T.ERROR,...e),this._logHandler(this,T.ERROR,...e)}}const Hl=(n,e)=>e.some(t=>n instanceof t);let _r,mr;const gr=new WeakMap,Vn=new WeakMap,vr=new WeakMap,zn=new WeakMap,Gn=new WeakMap;let Wn={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return Vn.get(n);if("objectStoreNames"===e)return n.objectStoreNames||vr.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ue(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function Zl(n){return"function"==typeof n?function Jl(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ql(){return mr||(mr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply($n(this),e),ue(gr.get(this))}:function(...e){return ue(n.apply($n(this),e))}:function(e,...t){const i=n.call($n(this),e,...t);return vr.set(i,e.sort?e.sort():[e]),ue(i)}}(n):(n instanceof IDBTransaction&&function Kl(n){if(Vn.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),s()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Vn.set(n,e)}(n),Hl(n,function Yl(){return _r||(_r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,Wn):n)}function ue(n){if(n instanceof IDBRequest)return function Xl(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(ue(n.result)),s()},a=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&gr.set(t,n)}).catch(()=>{}),Gn.set(e,n),e}(n);if(zn.has(n))return zn.get(n);const e=Zl(n);return e!==n&&(zn.set(n,e),Gn.set(e,n)),e}const $n=n=>Gn.get(n);function yr(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const a=indexedDB.open(n,e),l=ue(a);return i&&a.addEventListener("upgradeneeded",c=>{i(ue(a.result),c.oldVersion,c.newVersion,ue(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const ec=["get","getKey","getAll","getAllKeys","count"],tc=["put","add","delete","clear"],Un=new Map;function br(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(Un.get(e))return Un.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=tc.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!ec.includes(t))return;const o=function(){var a=(0,b.A)(function*(l,...c){const u=this.transaction(l,s?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(c.shift())),(yield Promise.all([h[t](...c),s&&u.done]))[0]});return function(c){return a.apply(this,arguments)}}();return Un.set(e,o),o}!function Ql(n){Wn=n(Wn)}(n=>({...n,get:(e,t,i)=>br(e,t)||n.get(e,t,i),has:(e,t)=>!!br(e,t)||n.has(e,t)}));class nc{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function ic(n){const e=n.getComponent();return"VERSION"===e?.type}(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}return null}).filter(t=>t).join(" ")}}const qt="@firebase/app",oe=new Bn("@firebase/app"),Xt="[DEFAULT]",Rc={[qt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ke=new Map,ct=new Map,ut=new Map;function wr(n,e){try{n.container.addComponent(e)}catch(t){oe.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function de(n){const e=n.name;if(ut.has(e))return oe.debug(`There were multiple attempts to register component ${e}.`),!1;ut.set(e,n);for(const t of ke.values())wr(t,n);for(const t of ct.values())wr(t,n);return!0}function Ue(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}const G=new Wt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Er{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new re("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw G.create("app-deleted",{appName:this._name})}}function xr(n,e={}){let t=n;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:Xt,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw G.create("bad-app-name",{appName:String(s)});if(t||(t=ar()),!t)throw G.create("no-options");const o=ke.get(s);if(o){if(Ht(t,o.options)&&Ht(i,o.config))return o;throw G.create("duplicate-app",{appName:s})}const a=new Gl(s);for(const c of ut.values())a.addComponent(c);const l=new Er(t,i,a);return ke.set(s,l),l}function Ir(n=Xt){const e=ke.get(n);if(!e&&n===Xt&&ar())return xr();if(!e)throw G.create("no-app",{appName:n});return e}function $(n,e,t){var i;let s=null!==(i=Rc[n])&&void 0!==i?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const l=[`Unable to register library "${s}" with version "${e}":`];return o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void oe.warn(l.join(" "))}de(new re(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Mc="firebase-heartbeat-database",Bc=1,dt="firebase-heartbeat-store";let qn=null;function Tr(){return qn||(qn=yr(Mc,Bc,{upgrade:(n,e)=>{if(0===e)try{n.createObjectStore(dt)}catch(t){console.warn(t)}}}).catch(n=>{throw G.create("idb-open",{originalErrorMessage:n.message})})),qn}function Xn(){return(Xn=(0,b.A)(function*(n){try{const t=(yield Tr()).transaction(dt),i=yield t.objectStore(dt).get(kr(n));return yield t.done,i}catch(e){if(e instanceof Ie)oe.warn(e.message);else{const t=G.create("idb-get",{originalErrorMessage:e?.message});oe.warn(t.message)}}})).apply(this,arguments)}function Sr(n,e){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,b.A)(function*(n,e){try{const i=(yield Tr()).transaction(dt,"readwrite");yield i.objectStore(dt).put(e,kr(n)),yield i.done}catch(t){if(t instanceof Ie)oe.warn(t.message);else{const i=G.create("idb-set",{originalErrorMessage:t?.message});oe.warn(i.message)}}})).apply(this,arguments)}function kr(n){return`${n.name}!${n.options.appId}`}class Wc{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Uc(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var e=this;return(0,b.A)(function*(){var t,i;try{const o=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ar();if(null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(e._heartbeatsCache=yield e._heartbeatsCachePromise,null==(null===(i=e._heartbeatsCache)||void 0===i?void 0:i.heartbeats))||e._heartbeatsCache.lastSentHeartbeatDate===a||e._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(e._heartbeatsCache.heartbeats.push({date:a,agent:o}),e._heartbeatsCache.heartbeats.length>30){const l=function Hc(n){if(0===n.length)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}(e._heartbeatsCache.heartbeats);e._heartbeatsCache.heartbeats.splice(l,1)}return e._storage.overwrite(e._heartbeatsCache)}catch(s){oe.warn(s)}})()}getHeartbeatsHeader(){var e=this;return(0,b.A)(function*(){var t;try{if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===e._heartbeatsCache.heartbeats.length)return"";const i=Ar(),{heartbeatsToSend:s,unsentEntries:o}=function $c(n,e=1024){const t=[];let i=n.slice();for(const s of n){const o=t.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),Nr(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Nr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}(e._heartbeatsCache.heartbeats),a=Bt(JSON.stringify({version:2,heartbeats:s}));return e._heartbeatsCache.lastSentHeartbeatDate=i,o.length>0?(e._heartbeatsCache.heartbeats=o,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),a}catch(i){return oe.warn(i),""}})()}}function Ar(){return(new Date).toISOString().substring(0,10)}class Uc{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,b.A)(function*(){return!!cr()&&ur().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return(0,b.A)(function*(){if(yield e._canUseIndexedDBPromise){const i=yield function Vc(n){return Xn.apply(this,arguments)}(e.app);return i?.heartbeats?i:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var t=this;return(0,b.A)(function*(){var i;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return Sr(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return(0,b.A)(function*(){var i;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return Sr(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}})()}}function Nr(n){return Bt(JSON.stringify({version:2,heartbeats:n})).length}!function Yc(n){de(new re("platform-logger",e=>new nc(e),"PRIVATE")),de(new re("heartbeat",e=>new Wc(e),"PRIVATE")),$(qt,"0.11.0",n),$(qt,"0.11.0","esm2017"),$("fire-js","")}(""),$("firebase","11.3.0","app");const Rr="@firebase/installations",Qn="0.6.12",Dr=1e4,Fr=`w:${Qn}`,Pr="FIS_v2",Kc="https://firebaseinstallations.googleapis.com/v1",Qc=36e5,ae=new Wt("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Lr(n){return n instanceof Ie&&n.code.includes("request-failed")}function Jn({projectId:n}){return`${Kc}/projects/${n}/installations`}function jr(n){return{token:n.token,requestStatus:2,expiresIn:tu(n.expiresIn),creationTime:Date.now()}}function Zn(n,e){return ei.apply(this,arguments)}function ei(){return(ei=(0,b.A)(function*(n,e){const i=(yield e.json()).error;return ae.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})})).apply(this,arguments)}function Or({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function ti(n){return ni.apply(this,arguments)}function ni(){return(ni=(0,b.A)(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e})).apply(this,arguments)}function tu(n){return Number(n.replace("s","000"))}function ii(){return(ii=(0,b.A)(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=Jn(n),s=Or(n),o=e.getImmediate({optional:!0});if(o){const u=yield o.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const l={method:"POST",headers:s,body:JSON.stringify({fid:t,authVersion:Pr,appId:n.appId,sdkVersion:Fr})},c=yield ti(()=>fetch(i,l));if(c.ok){const u=yield c.json();return{fid:u.fid||t,registrationStatus:2,refreshToken:u.refreshToken,authToken:jr(u.authToken)}}throw yield Zn("Create Installation",c)})).apply(this,arguments)}function Br(n){return new Promise(e=>{setTimeout(e,n)})}const ru=/^[cdef][\w-]{21}$/,si="";function ou(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function au(n){return function su(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return ru.test(t)?t:si}catch{return si}}function He(n){return`${n.appName}!${n.appId}`}const Ye=new Map;function Vr(n,e){const t=He(n);zr(t,e),function uu(n,e){const t=function Gr(){return!Ae&&"BroadcastChannel"in self&&(Ae=new BroadcastChannel("[Firebase] FID Change"),Ae.onmessage=n=>{zr(n.data.key,n.data.fid)}),Ae}();t&&t.postMessage({key:n,fid:e}),function Wr(){0===Ye.size&&Ae&&(Ae.close(),Ae=null)}()}(t,e)}function zr(n,e){const t=Ye.get(n);if(t)for(const i of t)i(e)}let Ae=null;const du="firebase-installations-database",hu=1,Ne="firebase-installations-store";let ri=null;function oi(){return ri||(ri=yr(du,hu,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ne)}})),ri}function Kt(n,e){return ai.apply(this,arguments)}function ai(){return(ai=(0,b.A)(function*(n,e){const t=He(n),s=(yield oi()).transaction(Ne,"readwrite"),o=s.objectStore(Ne),a=yield o.get(t);return yield o.put(e,t),yield s.done,(!a||a.fid!==e.fid)&&Vr(n,e.fid),e})).apply(this,arguments)}function li(n){return ci.apply(this,arguments)}function ci(){return(ci=(0,b.A)(function*(n){const e=He(n),i=(yield oi()).transaction(Ne,"readwrite");yield i.objectStore(Ne).delete(e),yield i.done})).apply(this,arguments)}function ht(n,e){return ui.apply(this,arguments)}function ui(){return(ui=(0,b.A)(function*(n,e){const t=He(n),s=(yield oi()).transaction(Ne,"readwrite"),o=s.objectStore(Ne),a=yield o.get(t),l=e(a);return void 0===l?yield o.delete(t):yield o.put(l,t),yield s.done,l&&(!a||a.fid!==l.fid)&&Vr(n,l.fid),l})).apply(this,arguments)}function di(n){return hi.apply(this,arguments)}function hi(){return hi=(0,b.A)(function*(n){let e;const t=yield ht(n.appConfig,i=>{const s=function pu(n){return Ur(n||{fid:ou(),registrationStatus:0})}(i),o=function fu(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(ae.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function _u(n,e){return pi.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:mu(n)}:{installationEntry:e}}(n,s);return e=o.registrationPromise,o.installationEntry});return t.fid===si?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),hi.apply(this,arguments)}function pi(){return pi=(0,b.A)(function*(n,e){try{const t=yield function iu(n,e){return ii.apply(this,arguments)}(n,e);return Kt(n.appConfig,t)}catch(t){throw Lr(t)&&409===t.customData.serverCode?yield li(n.appConfig):yield Kt(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}),pi.apply(this,arguments)}function mu(n){return fi.apply(this,arguments)}function fi(){return(fi=(0,b.A)(function*(n){let e=yield $r(n.appConfig);for(;1===e.registrationStatus;)yield Br(100),e=yield $r(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:i}=yield di(n);return i||t}return e})).apply(this,arguments)}function $r(n){return ht(n,e=>{if(!e)throw ae.create("installation-not-found");return Ur(e)})}function Ur(n){return function gu(n){return 1===n.registrationStatus&&n.registrationTime+Dr<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function _i(){return(_i=(0,b.A)(function*({appConfig:n,heartbeatServiceProvider:e},t){const i=function yu(n,{fid:e}){return`${Jn(n)}/${e}/authTokens:generate`}(n,t),s=function Mr(n,{refreshToken:e}){const t=Or(n);return t.append("Authorization",function nu(n){return`${Pr} ${n}`}(e)),t}(n,t),o=e.getImmediate({optional:!0});if(o){const u=yield o.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const l={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:Fr,appId:n.appId}})},c=yield ti(()=>fetch(i,l));if(c.ok)return jr(yield c.json());throw yield Zn("Generate Auth Token",c)})).apply(this,arguments)}function mi(n){return gi.apply(this,arguments)}function gi(){return gi=(0,b.A)(function*(n,e=!1){let t;const i=yield ht(n.appConfig,o=>{if(!Yr(o))throw ae.create("not-registered");const a=o.authToken;if(!e&&function Eu(n){return 2===n.requestStatus&&!function Cu(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Qc}(n)}(a))return o;if(1===a.requestStatus)return t=function bu(n,e){return vi.apply(this,arguments)}(n,e),o;{if(!navigator.onLine)throw ae.create("app-offline");const l=function xu(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}(o);return t=function wu(n,e){return yi.apply(this,arguments)}(n,l),l}});return t?yield t:i.authToken}),gi.apply(this,arguments)}function vi(){return(vi=(0,b.A)(function*(n,e){let t=yield Hr(n.appConfig);for(;1===t.authToken.requestStatus;)yield Br(100),t=yield Hr(n.appConfig);const i=t.authToken;return 0===i.requestStatus?mi(n,e):i})).apply(this,arguments)}function Hr(n){return ht(n,e=>{if(!Yr(e))throw ae.create("not-registered");return function Iu(n){return 1===n.requestStatus&&n.requestTime+Dr<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function yi(){return yi=(0,b.A)(function*(n,e){try{const t=yield function vu(n,e){return _i.apply(this,arguments)}(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return yield Kt(n.appConfig,i),t}catch(t){if(!Lr(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield Kt(n.appConfig,i)}else yield li(n.appConfig);throw t}}),yi.apply(this,arguments)}function Yr(n){return void 0!==n&&2===n.registrationStatus}function bi(){return(bi=(0,b.A)(function*(n){const e=n,{installationEntry:t,registrationPromise:i}=yield di(e);return i?i.catch(console.error):mi(e).catch(console.error),t.fid})).apply(this,arguments)}function wi(){return wi=(0,b.A)(function*(n,e=!1){const t=n;return yield function ku(n){return Ei.apply(this,arguments)}(t),(yield mi(t,e)).token}),wi.apply(this,arguments)}function Ei(){return(Ei=(0,b.A)(function*(n){const{registrationPromise:e}=yield di(n);e&&(yield e)})).apply(this,arguments)}function Ii(n){return ae.create("missing-app-config-values",{valueName:n})}const qr="installations",Fu=n=>{const e=n.getProvider("app").getImmediate(),t=function Ru(n){if(!n||!n.options)throw Ii("App Configuration");if(!n.name)throw Ii("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Ii(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:Ue(e,"heartbeat"),_delete:()=>Promise.resolve()}},Pu=n=>{const t=Ue(n.getProvider("app").getImmediate(),qr).getImmediate();return{getId:()=>function Tu(n){return bi.apply(this,arguments)}(t),getToken:s=>function Su(n){return wi.apply(this,arguments)}(t,s)}};(function Lu(){de(new re(qr,Fu,"PUBLIC")),de(new re("installations-internal",Pu,"PRIVATE"))})(),$(Rr,Qn),$(Rr,Qn,"esm2017");const Qt="analytics",ju="firebase_id",Ou="origin",Mu=6e4,Bu="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ti="https://www.googletagmanager.com/gtag/js",F=new Bn("@firebase/analytics"),O=new Wt("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function zu(n){if(!n.startsWith(Ti)){const e=O.create("invalid-gtag-resource",{gtagURL:n});return F.warn(e.message),""}return n}function Xr(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Si(){return(Si=(0,b.A)(function*(n,e,t,i,s,o){const a=i[s];try{if(a)yield e[a];else{const c=(yield Xr(t)).find(u=>u.measurementId===s);c&&(yield e[c.appId])}}catch(l){F.error(l)}n("config",s,o)})).apply(this,arguments)}function ki(){return(ki=(0,b.A)(function*(n,e,t,i,s){try{let o=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const l=yield Xr(t);for(const c of a){const u=l.find(d=>d.measurementId===c),h=u&&e[u.appId];if(!h){o=[];break}o.push(h)}}0===o.length&&(o=Object.values(e)),yield Promise.all(o),n("event",i,s||{})}catch(o){F.error(o)}})).apply(this,arguments)}const Ku=30,Kr=new class Ju{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Zu(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function Ai(){return(Ai=(0,b.A)(function*(n){var e;const{appId:t,apiKey:i}=n,s={method:"GET",headers:Zu(i)},o=Bu.replace("{app-id}",t),a=yield fetch(o,s);if(200!==a.status&&304!==a.status){let l="";try{const c=yield a.json();null!==(e=c.error)&&void 0!==e&&e.message&&(l=c.error.message)}catch{}throw O.create("config-fetch-failed",{httpStatus:a.status,responseMessage:l})}return a.json()})).apply(this,arguments)}function Ni(){return(Ni=(0,b.A)(function*(n,e=Kr,t){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw O.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw O.create("no-api-key")}const a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new sd;return setTimeout((0,b.A)(function*(){l.abort()}),void 0!==t?t:Mu),Qr({appId:i,apiKey:s,measurementId:o},a,l,e)})).apply(this,arguments)}function Qr(n,e,t){return Ri.apply(this,arguments)}function Ri(){return Ri=(0,b.A)(function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=Kr){var o;const{appId:a,measurementId:l}=n;try{yield function nd(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(o),i(O.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(i,e)}catch(c){if(l)return F.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:a,measurementId:l};throw c}try{const c=yield function ed(n){return Ai.apply(this,arguments)}(n);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!function id(n){if(!(n instanceof Ie&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(u)){if(s.deleteThrottleMetadata(a),l)return F.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u?.message}]`),{appId:a,measurementId:l};throw c}const h=503===Number(null===(o=u?.customData)||void 0===o?void 0:o.httpStatus)?pr(t,s.intervalMillis,Ku):pr(t,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:t+1};return s.setThrottleMetadata(a,d),F.debug(`Calling attemptFetch again in ${h} millis`),Qr(n,d,i,s)}}),Ri.apply(this,arguments)}class sd{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let Di,Bi;function Fi(){return(Fi=(0,b.A)(function*(n,e,t,i,s){if(s&&s.global)n("event",t,i);else{const o=yield e;n("event",t,Object.assign(Object.assign({},i),{send_to:o}))}})).apply(this,arguments)}function Vi(){return(Vi=(0,b.A)(function*(){if(!cr())return F.warn(O.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield ur()}catch(n){return F.warn(O.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}return!0})).apply(this,arguments)}function zi(){return zi=(0,b.A)(function*(n,e,t,i,s,o,a){var l;const c=function td(n){return Ni.apply(this,arguments)}(n);c.then(f=>{t[f.measurementId]=f.appId,n.options.measurementId&&f.measurementId!==n.options.measurementId&&F.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>F.error(f)),e.push(c);const u=function dd(){return Vi.apply(this,arguments)}().then(f=>{if(f)return i.getId()}),[h,d]=yield Promise.all([c,u]);(function Xu(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Ti)&&t.src.includes(n))return t;return null})(o)||function Wu(n,e){const t=function Gu(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}("firebase-js-sdk-policy",{createScriptURL:zu}),i=document.createElement("script"),s=`${Ti}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(o,h.measurementId),Bi&&(s("consent","default",Bi),function Jr(n){Bi=n}(void 0)),s("js",new Date);const p=null!==(l=a?.config)&&void 0!==l?l:{};return p[Ou]="firebase",p.update=!0,null!=d&&(p[ju]=d),s("config",h.measurementId,p),Di&&(s("set",Di),function Zr(n){Di=n}(void 0)),h.measurementId}),zi.apply(this,arguments)}class pd{constructor(e){this.app=e}_delete(){return delete Q[this.app.options.appId],Promise.resolve()}}let Q={},eo=[];const to={};let io,J,Jt="dataLayer",Gi=!1;function _d(n,e,t){!function fd(){const n=[];if(function wl(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}()&&n.push("This is a browser extension environment."),function Cl(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=O.create("invalid-analytics-context",{errorInfo:e});F.warn(t.message)}}();const i=n.options.appId;if(!i)throw O.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw O.create("no-api-key");F.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Q[i])throw O.create("already-exists",{id:i});if(!Gi){!function $u(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(Jt);const{wrappedGtag:o,gtagCore:a}=function qu(n,e,t,i,s){let o=function(...a){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(o=window[s]),window[s]=function Yu(n,e,t,i){function o(){return o=(0,b.A)(function*(a,...l){try{if("event"===a){const[c,u]=l;yield function Hu(n,e,t,i,s){return ki.apply(this,arguments)}(n,e,t,c,u)}else if("config"===a){const[c,u]=l;yield function Uu(n,e,t,i,s,o){return Si.apply(this,arguments)}(n,e,t,i,c,u)}else if("consent"===a){const[c,u]=l;n("consent",c,u)}else if("get"===a){const[c,u,h]=l;n("get",c,u,h)}else if("set"===a){const[c]=l;n("set",c)}else n(a,...l)}catch(c){F.error(c)}}),o.apply(this,arguments)}return function s(a){return o.apply(this,arguments)}}(o,n,e,t),{gtagCore:o,wrappedGtag:window[s]}}(Q,eo,to,Jt,"gtag");J=o,io=a,Gi=!0}return Q[i]=function hd(n,e,t,i,s,o,a){return zi.apply(this,arguments)}(n,eo,to,e,io,Jt,t),new pd(n)}const so="@firebase/analytics",ro="0.10.11";!function yd(){de(new re(Qt,(e,{options:t})=>_d(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),de(new re("analytics-internal",function n(e){try{const t=e.getProvider(Qt).getImmediate();return{logEvent:(i,s,o)=>function vd(n,e,t,i){n=Te(n),function rd(n,e,t,i,s){return Fi.apply(this,arguments)}(J,Q[n.app.options.appId],e,t,i).catch(s=>F.error(s))}(t,i,s,o)}}catch(t){throw O.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),$(so,ro),$(so,ro,"esm2017")}();const oo="@firebase/database";let Ui="";class bd{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),D(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:lt(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class wd{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return K(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const co=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new bd(e)}}catch{}return new wd},Re=co("localStorage"),Hi=co("sessionStorage"),qe=new Bn("@firebase/database"),uo=function(){let n=1;return function(){return n++}}(),ho=function(n){const e=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,_(i<n.length,"Surrogate pair missing trail surrogate."),s=65536+(o<<10)+(n.charCodeAt(i)-56320)}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=63&s|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=63&s|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=63&s|128)}return e}(n),t=new Nl;t.update(e);const i=t.digest();return jn.encodeByteArray(i)},pt=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=pt.apply(null,i):e+="object"==typeof i?D(i):i,e+=" "}return e};let De=null,po=!0;const P=function(...n){if(!0===po&&(po=!1,null===De&&!0===Hi.get("logging_enabled")&&function(n,e){_(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(qe.logLevel=T.VERBOSE,De=qe.log.bind(qe),e&&Hi.set("logging_enabled",!0)):"function"==typeof n?De=n:(De=null,Hi.remove("logging_enabled"))}(!0)),De){const e=pt.apply(null,n);De(e)}},ft=function(n){return function(...e){P(n,...e)}},Yi=function(...n){const e="FIREBASE INTERNAL ERROR: "+pt(...n);qe.error(e)},Z=function(...n){const e=`FIREBASE FATAL ERROR: ${pt(...n)}`;throw qe.error(e),new Error(e)},j=function(...n){const e="FIREBASE WARNING: "+pt(...n);qe.warn(e)},Zt=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},he="[MIN_NAME]",le="[MAX_NAME]",Fe=function(n,e){if(n===e)return 0;if(n===he||e===le)return-1;if(e===he||n===le)return 1;{const t=go(n),i=go(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},xd=function(n,e){return n===e?0:n<e?-1:1},_t=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+D(e))},qi=function(n){if("object"!=typeof n||null===n)return D(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=D(e[i]),t+=":",t+=qi(n[e[i]]);return t+="}",t},_o=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)i.push(n.substring(s,s+e>t?t:s+e));return i};function L(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const mo=function(n){_(!Zt(n),"Invalid JSON number");const i=1023;let s,o,a,l,c;0===n?(o=0,a=0,s=1/n==-1/0?1:0):(s=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=l+i,a=Math.round(n*Math.pow(2,52-l)-Math.pow(2,52))):(o=0,a=Math.round(n/Math.pow(2,-1074))));const u=[];for(c=52;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=11;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(s?1:0),u.reverse();const h=u.join("");let d="";for(c=0;c<64;c+=8){let p=parseInt(h.substr(c,8),2).toString(16);1===p.length&&(p="0"+p),d+=p}return d.toLowerCase()},kd=new RegExp("^-?(0*)\\d{1,10}$"),go=function(n){if(kd.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},Xe=function(n){try{n()}catch(e){setTimeout(()=>{throw j("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},mt=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class Dd{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,function Fc(n){return null!=n&&void 0!==n.settings}(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){j(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Fd{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(P("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',j(e)}}let gt=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Eo=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Io="websocket",To="long_polling";class Ki{constructor(e,t,i,s,o=!1,a="",l=!1,c=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Re.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Re.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function So(n,e,t){let i;if(_("string"==typeof e,"typeof type must == string"),_("object"==typeof t,"typeof params must == object"),e===Io)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==To)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Pd(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const s=[];return L(t,(o,a)=>{s.push(o+"="+a)}),i+s.join("&")}class Ld{constructor(){this.counters_={}}incrementCounter(e,t=1){K(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ul(this.counters_)}}const Qi={},Ji={};function Zi(n){const e=n.toString();return Qi[e]||(Qi[e]=new Ld),Qi[e]}class Od{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Xe(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class pe{constructor(e,t,i,s,o,a,l){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ft(e),this.stats_=Zi(t),this.urlFn=c=>(this.appCheckToken&&(c.ac=this.appCheckToken),So(t,To,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Od(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if("complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new es((...o)=>{const[a,l,c,u,h]=o;if(this.incrementIncomingBytes_(o),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=l,this.password=c;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_()}},(...o)=>{const[a,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Eo.test(location.hostname)&&(i.r="f");const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){pe.forceAllow_=!0}static forceDisallow(){pe.forceDisallow_=!0}static isAvailable(){return!(!pe.forceAllow_&&(pe.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=D(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=rr(t),s=_o(i,1840);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=D(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class es{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=uo(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=es.createIFrame_();let o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){P("frame writing exception"),l.stack&&P(l.stack),P(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||P("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const a=this.pendingSegs.shift();i=i+"&seg"+s+"="+a.seg+"&ts"+s+"="+a.ts+"&d"+s+"="+a.d,s++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(s),i()})}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||"loaded"===s||"complete"===s)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{P("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let tn=null;typeof MozWebSocket<"u"?tn=MozWebSocket:typeof WebSocket<"u"&&(tn=WebSocket);let Ke=(()=>{class n{constructor(t,i,s,o,a,l,c){this.connId=t,this.applicationId=s,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ft(this.connId),this.stats_=Zi(i),this.connURL=n.connectionURL_(i,l,c,o,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,s,o,a){const l={v:"5"};return typeof location<"u"&&location.hostname&&Eo.test(location.hostname)&&(l.r="f"),i&&(l.s=i),s&&(l.ls=s),o&&(l.ac=o),a&&(l.p=a),So(t,Io,l)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Re.set("previous_websocket_failure",!0);try{let s;0,this.mySock=new tn(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const o=s.message||s.data;return o&&this.log_(o),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const o=s.message||s.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const s=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);s&&s.length>1&&parseFloat(s[1])<4.4&&(t=!0)}return!t&&null!==tn&&!n.forceDisallow_}static previouslyFailed(){return Re.isInMemoryStorage||!0===Re.get("previous_websocket_failure")}markConnectionHealthy(){Re.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const s=lt(i);this.onMessage(s)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(_(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const s=this.extractFrameCount_(i);null!==s&&this.appendFrame_(s)}}send(t){this.resetKeepAlive();const i=D(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const s=_o(i,16384);s.length>1&&this.sendString_(String(s.length));for(let o=0;o<s.length;o++)this.sendString_(s[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Po=(()=>{class n{static get ALL_TRANSPORTS(){return[pe,Ke]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const i=Ke&&Ke.isAvailable();let s=i&&!Ke.previouslyFailed();if(t.webSocketOnly&&(i||j("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Ke];else{const o=this.transports_=[];for(const a of n.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class zo{constructor(e,t,i,s,o,a,l,c,u,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ft("c:"+this.id+":"),this.transportManager_=new Po(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=mt(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=_t("t",e),i=_t("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=_t("t",e),i=_t("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=_t("t",e);if("d"in e){const i=e.d;if("h"===t){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?Yi("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Yi("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&j("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),mt(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):mt(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Re.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Go{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class Wo{constructor(e){this.allowedEvents_=e,this.listeners_={},_(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context))return void s.splice(o,1)}validateEventType_(e){_(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class nn extends Wo{static getInstance(){return new nn}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!lr()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return _("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class x{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function C(){return new x("")}function v(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function fe(n){return n.pieces_.length-n.pieceNum_}function I(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new x(n.pieces_,e)}function ns(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function vt(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Ho(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new x(e,0)}function N(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof x)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new x(t,0)}function y(n){return n.pieceNum_>=n.pieces_.length}function M(n,e){const t=v(n),i=v(e);if(null===t)return e;if(t===i)return M(I(n),I(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function is(n,e){if(fe(n)!==fe(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function W(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(fe(n)>fe(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class oh{constructor(e,t){this.errorPrefix_=t,this.parts_=vt(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Yt(this.parts_[i]);Yo(this)}}function Yo(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Pe(n))}function Pe(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class ss extends Wo{static getInstance(){return new ss}constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return _("visible"===e,"Unknown event type: "+e),[this.visible_]}}const yt=1e3;let rn,Le=(()=>{class n extends Go{constructor(t,i,s,o,a,l,c,u){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=s,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=ft("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yt,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ss.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&nn.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,s){const o=++this.requestNumber_,a={r:o,a:t,b:i};this.log_(D(a)),_(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),s&&(this.requestCBHash_[o]=s)}get(t){this.initConnection_();const i=new at,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:l=>{const c=l.d;"ok"===l.s?i.resolve(c):i.reject(c)}};return this.outstandingGets_.push(o),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(t,i,s,o){this.initConnection_();const a=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),_(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),_(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");const c={onComplete:o,hashFn:i,query:t,tag:s};this.listens.get(l).set(a,c),this.connected_&&this.sendListen_(c)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,s=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(s)})}sendListen_(t){const i=t.query,s=i._path.toString(),o=i._queryIdentifier;this.log_("Listen on "+s+" for "+o);const a={p:s};t.tag&&(a.q=i._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,c=>{const u=c.d,h=c.s;n.warnOnListenWarnings_(u,i),(this.listens.get(s)&&this.listens.get(s).get(o))===t&&(this.log_("listen response",c),"ok"!==h&&this.removeListen_(s,o),t.onComplete&&t.onComplete(h,u))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&K(t,"w")){const s=We(t,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const o='".indexOn": "'+i._queryParams.getIndex().toString()+'"',a=i._path.toString();j(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(n){const e=$t(n).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=function(n){const t=$t(n).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",s={cred:t};null===this.authOverride_?s.noauth=!0:"object"==typeof this.authOverride_&&(s.authvar=this.authOverride_),this.sendRequest(i,s,o=>{const a=o.s,l=o.d||"error";this.authToken_===t&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,s=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,s)})}unlisten(t,i){const s=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+s+" "+o),_(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,o)&&this.connected_&&this.sendUnlisten_(s,o,t._queryObject,i)}sendUnlisten_(t,i,s,o){this.log_("Unlisten on "+t+" for "+i);const a={p:t};o&&(a.q=s,a.t=o),this.sendRequest("n",a)}onDisconnectPut(t,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,s):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:s})}onDisconnectMerge(t,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,s):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:s})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,s,o){const a={p:i,d:s};this.log_("onDisconnect "+t,a),this.sendRequest(t,a,l=>{o&&setTimeout(()=>{o(l.s,l.d)},Math.floor(0))})}put(t,i,s,o){this.putInternal("p",t,i,s,o)}merge(t,i,s,o){this.putInternal("m",t,i,s,o)}putInternal(t,i,s,o,a){this.initConnection_();const l={p:i,d:s};void 0!==a&&(l.h=a),this.outstandingPuts_.push({action:t,request:l,onComplete:o}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,s=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,s,a=>{this.log_(i+" response",a),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,s=>{"ok"!==s.s&&this.log_("reportStats","Error sending stats: "+s.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+D(t));const i=t.r,s=this.requestCBHash_[i];s&&(delete this.requestCBHash_[i],s(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):Yi("Unrecognized action received from server: "+D(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){_(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=yt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=yt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,b.A)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),s=t.onReady_.bind(t),o=t.onRealtimeDisconnect_.bind(t),a=t.id+":"+n.nextConnectionId_++,l=t.lastSessionId;let c=!1,u=null;const h=function(){u?u.close():(c=!0,o())};t.realtime_={close:h,sendRequest:function(f){_(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(f)}};const p=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[f,m]=yield Promise.all([t.authTokenProvider_.getToken(p),t.appCheckTokenProvider_.getToken(p)]);c?P("getToken() completed but was canceled"):(P("getToken() completed. Creating connection."),t.authToken_=f&&f.accessToken,t.appCheckToken_=m&&m.token,u=new zo(a,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,s,o,E=>{j(E+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},l))}catch(f){t.log_("Failed to get token: "+f),c||(t.repoInfo_.nodeAdmin&&j(f),h())}}})()}interrupt(t){P("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){P("Resuming connection for reason: "+t),delete this.interruptReasons_[t],dr(this.interruptReasons_)&&(this.reconnectDelay_=yt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let s;s=i?i.map(a=>qi(a)).join("$"):"default";const o=this.removeListen_(t,s);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,i){const s=new x(t).toString();let o;if(this.listens.has(s)){const a=this.listens.get(s);o=a.get(i),a.delete(i),0===a.size&&this.listens.delete(s)}else o=void 0;return o}onAuthRevoked_(t,i){P("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){P("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";t["sdk."+i+"."+Ui.replace(/\./g,"-")]=1,lr()?t["framework.cordova"]=1:function El(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=nn.getInstance().currentlyOnline();return dr(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class w{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new w(e,t)}}class sn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new w(he,e),s=new w(he,t);return 0!==this.compare(i,s)}minPost(){return w.MIN}}class Ko extends sn{static get __EMPTY_NODE(){return rn}static set __EMPTY_NODE(e){rn=e}compare(e,t){return Fe(e.name,t.name)}isDefinedOn(e){throw Ge("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return w.MIN}maxPost(){return new w(le,rn)}makePost(e,t){return _("string"==typeof e,"KeyIndex indexValue must always be a string."),new w(e,rn)}toString(){return".key"}}const ee=new Ko;class on{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,s&&(a*=-1),a<0)e=this.isReverse_?e.left:e.right;else{if(0===a){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let os,U=(()=>{class n{constructor(t,i,s,o,a){this.key=t,this.value=i,this.color=s??n.RED,this.left=o??B.EMPTY_NODE,this.right=a??B.EMPTY_NODE}copy(t,i,s,o,a){return new n(t??this.key,i??this.value,s??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,s){let o=this;const a=s(t,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(t,i,s),null):0===a?o.copy(null,i,null,null,null):o.copy(null,null,null,null,o.right.insert(t,i,s)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return B.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let s,o;if(s=this,i(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(t,i),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),0===i(t,s.key)){if(s.right.isEmpty())return B.EMPTY_NODE;o=s.right.min_(),s=s.copy(o.key,o.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(t,i))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class B{constructor(e,t=B.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new B(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,U.BLACK,null,null))}remove(e){return new B(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,U.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(s=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new on(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new on(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new on(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new on(this.root_,null,this.comparator_,!0,e)}}function fh(n,e){return Fe(n.name,e.name)}function rs(n,e){return Fe(n,e)}B.EMPTY_NODE=new class ph{copy(e,t,i,s,o){return this}insert(e,t,i){return new U(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Qo=function(n){return"number"==typeof n?"number:"+mo(n):"string:"+n},Jo=function(n){if(n.isLeafNode()){const e=n.val();_("string"==typeof e||"number"==typeof e||"object"==typeof e&&K(e,".sv"),"Priority must be a string or number.")}else _(n===os||n.isEmpty(),"priority of unexpected type.");_(n===os||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Zo,ea,ta,Qe=(()=>{class n{static set __childrenNodeConstructor(t){Zo=t}static get __childrenNodeConstructor(){return Zo}constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,_(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Jo(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return y(t)?this:".priority"===v(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const s=v(t);return null===s?i:i.isEmpty()&&".priority"!==s?this:(_(".priority"!==s||1===fe(t),".priority must be the last token in a path"),this.updateImmediateChild(s,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(I(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Qo(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?mo(this.value_):this.value_,this.lazyHash_=ho(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(_(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,s=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(i),a=n.VALUE_TYPE_ORDER.indexOf(s);return _(o>=0,"Unknown leaf type: "+i),_(a>=0,"Unknown leaf type: "+s),o===a?"object"===s?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const S=new class vh extends sn{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return 0===o?Fe(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return w.MIN}maxPost(){return new w(le,new Qe("[PRIORITY-POST]",ta))}makePost(e,t){const i=ea(e);return new w(t,new Qe("[PRIORITY-POST]",i))}toString(){return".priority"}},yh=Math.log(2);class bh{constructor(e){this.count=parseInt(Math.log(e+1)/yh,10),this.current_=this.count-1;const s=(o=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const an=function(n,e,t,i){n.sort(e);const s=function(c,u){const h=u-c;let d,p;if(0===h)return null;if(1===h)return d=n[c],p=t?t(d):d,new U(p,d.node,U.BLACK,null,null);{const f=parseInt(h/2,10)+c,m=s(c,f),E=s(f+1,u);return d=n[f],p=t?t(d):d,new U(p,d.node,U.BLACK,m,E)}},l=function(c){let u=null,h=null,d=n.length;const p=function(m,E){const A=d-m,Ce=d;d-=m;const Pn=s(A+1,Ce),tr=n[A],u_=t?t(tr):tr;f(new U(u_,tr.node,E,null,Pn))},f=function(m){u?(u.left=m,u=m):(h=m,u=m)};for(let m=0;m<c.count;++m){const E=c.nextBitIsOne(),A=Math.pow(2,c.count-(m+1));E?p(A,U.BLACK):(p(A,U.BLACK),p(A,U.RED))}return h}(new bh(n.length));return new B(i||e,l)};let as;const Je={};class ce{static get Default(){return _(Je&&S,"ChildrenNode.ts has not been loaded"),as=as||new ce({".priority":Je},{".priority":S}),as}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=We(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof B?t:null}hasIndex(e){return K(this.indexSet_,e.toString())}addIndex(e,t){_(e!==ee,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(w.Wrap);let l,a=o.getNext();for(;a;)s=s||e.isDefinedOn(a.node),i.push(a),a=o.getNext();l=s?an(i,e.getCompare()):Je;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const h=Object.assign({},this.indexes_);return h[c]=l,new ce(h,u)}addToIndexes(e,t){const i=Ut(this.indexes_,(s,o)=>{const a=We(this.indexSet_,o);if(_(a,"Missing index implementation for "+o),s===Je){if(a.isDefinedOn(e.node)){const l=[],c=t.getIterator(w.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&l.push(u),u=c.getNext();return l.push(e),an(l,a.getCompare())}return Je}{const l=t.get(e.name);let c=s;return l&&(c=c.remove(new w(e.name,l))),c.insert(e,e.node)}});return new ce(i,this.indexSet_)}removeFromIndexes(e,t){const i=Ut(this.indexes_,s=>{if(s===Je)return s;{const o=t.get(e.name);return o?s.remove(new w(e.name,o)):s}});return new ce(i,this.indexSet_)}}let bt,g=(()=>{class n{static get EMPTY_NODE(){return bt||(bt=new n(new B(rs),null,ce.Default))}constructor(t,i,s){this.children_=t,this.priorityNode_=i,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Jo(this.priorityNode_),this.children_.isEmpty()&&_(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||bt}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?bt:i}}getChild(t){const i=v(t);return null===i?this:this.getImmediateChild(i).getChild(I(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if(_(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const s=new w(t,i);let o,a;i.isEmpty()?(o=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(s,this.children_)):(o=this.children_.insert(t,i),a=this.indexMap_.addToIndexes(s,this.children_));const l=o.isEmpty()?bt:this.priorityNode_;return new n(o,l,a)}}updateChild(t,i){const s=v(t);if(null===s)return i;{_(".priority"!==v(t)||1===fe(t),".priority must be the last token in a path");const o=this.getImmediateChild(s).updateChild(I(t),i);return this.updateImmediateChild(s,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let s=0,o=0,a=!0;if(this.forEachChild(S,(l,c)=>{i[l]=c.val(t),s++,a&&n.INTEGER_REGEXP_.test(l)?o=Math.max(o,Number(l)):a=!1}),!t&&a&&o<2*s){const l=[];for(const c in i)l[c]=i[c];return l}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Qo(this.getPriority().val())+":"),this.forEachChild(S,(i,s)=>{const o=s.hash();""!==o&&(t+=":"+i+":"+o)}),this.lazyHash_=""===t?"":ho(t)}return this.lazyHash_}getPredecessorChildName(t,i,s){const o=this.resolveIndex_(s);if(o){const a=o.getPredecessorKey(new w(t,i));return a?a.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const s=i.minKey();return s&&s.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new w(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const s=i.maxKey();return s&&s.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new w(i,this.children_.get(i)):null}forEachChild(t,i){const s=this.resolveIndex_(t);return s?s.inorderTraversal(o=>i(o.name,o.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const s=this.resolveIndex_(i);if(s)return s.getIteratorFrom(t,o=>o);{const o=this.children_.getIteratorFrom(t.name,w.Wrap);let a=o.peek();for(;null!=a&&i.compare(a,t)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const s=this.resolveIndex_(i);if(s)return s.getReverseIteratorFrom(t,o=>o);{const o=this.children_.getReverseIteratorFrom(t.name,w.Wrap);let a=o.peek();for(;null!=a&&i.compare(a,t)>0;)o.getNext(),a=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===wt?-1:0}withIndex(t){if(t===ee||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===ee||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const s=this.getIterator(S),o=i.getIterator(S);let a=s.getNext(),l=o.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=s.getNext(),l=o.getNext()}return null===a&&null===l}return!1}return!1}}resolveIndex_(t){return t===ee?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const wt=new class wh extends g{constructor(){super(new B(rs),g.EMPTY_NODE,ce.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return g.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(w,{MIN:{value:new w(he,g.EMPTY_NODE)},MAX:{value:new w(le,wt)}}),Ko.__EMPTY_NODE=g.EMPTY_NODE,Qe.__childrenNodeConstructor=g,function _h(n){os=n}(wt),function gh(n){ta=n}(wt);const Eh=!0;function R(n,e=null){if(null===n)return g.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),_(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Qe(n,R(e));if(n instanceof Array||!Eh){let t=g.EMPTY_NODE;return L(n,(i,s)=>{if(K(n,i)&&"."!==i.substring(0,1)){const o=R(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(R(e))}{const t=[];let i=!1;if(L(n,(a,l)=>{if("."!==a.substring(0,1)){const c=R(l);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),t.push(new w(a,c)))}}),0===t.length)return g.EMPTY_NODE;const o=an(t,fh,a=>a.name,rs);if(i){const a=an(t,S.getCompare());return new g(o,R(e),new ce({".priority":a},{".priority":S}))}return new g(o,R(e),ce.Default)}}!function mh(n){ea=n}(R);class ls extends sn{constructor(e){super(),this.indexPath_=e,_(!y(e)&&".priority"!==v(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return 0===o?Fe(e.name,t.name):o}makePost(e,t){const i=R(e),s=g.EMPTY_NODE.updateChild(this.indexPath_,i);return new w(t,s)}maxPost(){const e=g.EMPTY_NODE.updateChild(this.indexPath_,wt);return new w(le,e)}toString(){return vt(this.indexPath_,0).join("/")}}const cs=new class Ch extends sn{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?Fe(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return w.MIN}maxPost(){return w.MAX}makePost(e,t){const i=R(e);return new w(t,i)}toString(){return".value"}};function na(n){return{type:"value",snapshotNode:n}}function Ze(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Et(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Ct(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class us{constructor(e){this.index_=e}updateChild(e,t,i,s,o,a){_(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(null!=a&&(i.isEmpty()?e.hasChild(t)?a.trackChildChange(Et(t,l)):_(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(Ze(t,i)):a.trackChildChange(Ct(t,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return null!=i&&(e.isLeafNode()||e.forEachChild(S,(s,o)=>{t.hasChild(s)||i.trackChildChange(Et(s,o))}),t.isLeafNode()||t.forEachChild(S,(s,o)=>{if(e.hasChild(s)){const a=e.getImmediateChild(s);a.equals(o)||i.trackChildChange(Ct(s,o,a))}else i.trackChildChange(Ze(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?g.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class xt{constructor(e){this.indexedFilter_=new us(e.getIndex()),this.index_=e.getIndex(),this.startPost_=xt.getStartPost_(e),this.endPost_=xt.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,a){return this.matches(new w(t,i))||(i=g.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,a)}updateFullNode(e,t,i){t.isLeafNode()&&(t=g.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(g.EMPTY_NODE);const o=this;return t.forEachChild(S,(a,l)=>{o.matches(new w(a,l))||(s=s.updateImmediateChild(a,g.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Ih{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new xt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,a){return this.rangedFilter_.matches(new w(t,i))||(i=g.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,a):this.fullLimitUpdateChild_(e,t,i,o,a)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=g.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let o;s=g.EMPTY_NODE.withIndex(this.index_),o=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l)){if(!this.withinDirectionalEnd(l))break;s=s.updateImmediateChild(l.name,l.node),a++}}}else{let o;s=t.withIndex(this.index_),s=s.updatePriority(g.EMPTY_NODE),o=this.reverse_?s.getReverseIterator(this.index_):s.getIterator(this.index_);let a=0;for(;o.hasNext();){const l=o.getNext();a<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?a++:s=s.updateImmediateChild(l.name,g.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let a;if(this.reverse_){const d=this.index_.getCompare();a=(p,f)=>d(f,p)}else a=this.index_.getCompare();const l=e;_(l.numChildren()===this.limit_,"");const c=new w(t,i),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(l.hasChild(t)){const d=l.getImmediateChild(t);let p=s.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=p&&(p.name===t||l.hasChild(p.name));)p=s.getChildAfterChild(this.index_,p,this.reverse_);const f=null==p?1:a(p,c);if(h&&!i.isEmpty()&&f>=0)return o?.trackChildChange(Ct(t,i,d)),l.updateImmediateChild(t,i);{o?.trackChildChange(Et(t,d));const E=l.updateImmediateChild(t,g.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(o?.trackChildChange(Ze(p.name,p.node)),E.updateImmediateChild(p.name,p.node)):E}}return i.isEmpty()?e:h&&a(u,c)>=0?(null!=o&&(o.trackChildChange(Et(u.name,u.node)),o.trackChildChange(Ze(t,i))),l.updateImmediateChild(t,i).updateImmediateChild(u.name,g.EMPTY_NODE)):e}}class ds{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=S}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return _(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return _(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:he}hasEnd(){return this.endSet_}getIndexEndValue(){return _(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return _(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:le}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return _(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===S}copy(){const e=new ds;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ia(n){const e={};if(n.isDefault())return e;let t;if(n.index_===S?t="$priority":n.index_===cs?t="$value":n.index_===ee?t="$key":(_(n.index_ instanceof ls,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=D(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=D(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+D(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=D(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+D(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function sa(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==S&&(e.i=n.index_.toString()),e}class cn extends Go{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(_(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=ft("p:rest:"),this.listens_={}}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const a=cn.getListenId_(e,i),l={};this.listens_[a]=l;const c=ia(e._queryParams);this.restRequest_(o+".json",c,(u,h)=>{let d=h;if(404===u&&(d=null,u=null),null===u&&this.onDataUpdate_(o,d,!1,i),We(this.listens_,a)===l){let p;p=u?401===u?"permission_denied":"rest_error:"+u:"ok",s(p,null)}})}unlisten(e,t){const i=cn.getListenId_(e,t);delete this.listens_[i]}get(e){const t=ia(e._queryParams),i=e._path.toString(),s=new at;return this.restRequest_(i+".json",t,(o,a)=>{let l=a;404===o&&(l=null,o=null),null===o?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function Al(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}(t);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&4===l.readyState){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=lt(l.responseText)}catch{j("Failed to parse JSON response for "+a+": "+l.responseText)}i(null,c)}else 401!==l.status&&404!==l.status&&j("Got unsuccessful REST response for "+a+" Status: "+l.status),i(l.status);i=null}},l.open("GET",a,!0),l.send()})}}class Rh{constructor(){this.rootNode_=g.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function un(){return{value:null,children:new Map}}function et(n,e,t){if(y(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=v(e);n.children.has(i)||n.children.set(i,un()),et(n.children.get(i),e=I(e),t)}}function _s(n,e,t){null!==n.value?t(e,n.value):function Dh(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,s)=>{_s(s,new x(e.toString()+"/"+i),t)})}class Fh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&L(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}class jh{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Fh(e);const i=1e4+2e4*Math.random();mt(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;L(e,(s,o)=>{o>0&&K(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),mt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var te=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(te||{});function vs(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class dn{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=te.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(y(this.path)){if(null!=this.affectedTree.value)return _(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new x(e));return new dn(C(),t,this.revert)}}return _(v(this.path)===e,"operationForChild called for unrelated child."),new dn(I(this.path),this.affectedTree,this.revert)}}class It{constructor(e,t){this.source=e,this.path=t,this.type=te.LISTEN_COMPLETE}operationForChild(e){return y(this.path)?new It(this.source,C()):new It(this.source,I(this.path))}}class je{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=te.OVERWRITE}operationForChild(e){return y(this.path)?new je(this.source,C(),this.snap.getImmediateChild(e)):new je(this.source,I(this.path),this.snap)}}class tt{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=te.MERGE}operationForChild(e){if(y(this.path)){const t=this.children.subtree(new x(e));return t.isEmpty()?null:t.value?new je(this.source,C(),t.value):new tt(this.source,C(),t)}return _(v(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new tt(this.source,I(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class _e{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(y(e))return this.isFullyInitialized()&&!this.filtered_;const t=v(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Oh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Tt(n,e,t,i,s,o){const a=i.filter(l=>l.type===t);a.sort((l,c)=>function Vh(n,e,t){if(null==e.childName||null==t.childName)throw Ge("Should only compare child_ events.");const i=new w(e.childName,e.snapshotNode),s=new w(t.childName,t.snapshotNode);return n.index_.compare(i,s)}(n,l,c)),a.forEach(l=>{const c=function Bh(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,l,o);s.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(c,n.query_))})})}function hn(n,e){return{eventCache:n,serverCache:e}}function St(n,e,t,i){return hn(new _e(e,t,i),n.serverCache)}function oa(n,e,t,i){return hn(n.eventCache,new _e(e,t,i))}function pn(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Oe(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let ys;class k{static fromObject(e){let t=new k(null);return L(e,(i,s)=>{t=t.set(new x(i),s)}),t}constructor(e,t=(()=>(ys||(ys=new B(xd)),ys))()){this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:C(),value:this.value};if(y(e))return null;{const i=v(e),s=this.children.get(i);if(null!==s){const o=s.findRootMostMatchingPathAndValue(I(e),t);return null!=o?{path:N(new x(i),o.path),value:o.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(y(e))return this;{const t=v(e),i=this.children.get(t);return null!==i?i.subtree(I(e)):new k(null)}}set(e,t){if(y(e))return new k(t,this.children);{const i=v(e),o=(this.children.get(i)||new k(null)).set(I(e),t),a=this.children.insert(i,o);return new k(this.value,a)}}remove(e){if(y(e))return this.children.isEmpty()?new k(null):new k(null,this.children);{const t=v(e),i=this.children.get(t);if(i){const s=i.remove(I(e));let o;return o=s.isEmpty()?this.children.remove(t):this.children.insert(t,s),null===this.value&&o.isEmpty()?new k(null):new k(this.value,o)}return this}}get(e){if(y(e))return this.value;{const t=v(e),i=this.children.get(t);return i?i.get(I(e)):null}}setTree(e,t){if(y(e))return t;{const i=v(e),o=(this.children.get(i)||new k(null)).setTree(I(e),t);let a;return a=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new k(this.value,a)}}fold(e){return this.fold_(C(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(N(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,C(),t)}findOnPath_(e,t,i){const s=!!this.value&&i(t,this.value);if(s)return s;if(y(e))return null;{const o=v(e),a=this.children.get(o);return a?a.findOnPath_(I(e),N(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,C(),t)}foreachOnPath_(e,t,i){if(y(e))return this;{this.value&&i(t,this.value);const s=v(e),o=this.children.get(s);return o?o.foreachOnPath_(I(e),N(t,s),i):new k(null)}}foreach(e){this.foreach_(C(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(N(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class H{constructor(e){this.writeTree_=e}static empty(){return new H(new k(null))}}function kt(n,e,t){if(y(e))return new H(new k(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const s=i.path;let o=i.value;const a=M(s,e);return o=o.updateChild(a,t),new H(n.writeTree_.set(s,o))}{const s=new k(t),o=n.writeTree_.setTree(e,s);return new H(o)}}}function bs(n,e,t){let i=n;return L(t,(s,o)=>{i=kt(i,N(e,s),o)}),i}function aa(n,e){if(y(e))return H.empty();{const t=n.writeTree_.setTree(e,new k(null));return new H(t)}}function ws(n,e){return null!=Me(n,e)}function Me(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(M(t.path,e)):null}function la(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(S,(i,s)=>{e.push(new w(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{null!=s.value&&e.push(new w(i,s.value))}),e}function me(n,e){if(y(e))return n;{const t=Me(n,e);return new H(null!=t?new k(t):n.writeTree_.subtree(e))}}function Es(n){return n.writeTree_.isEmpty()}function nt(n,e){return ca(C(),n.writeTree_,e)}function ca(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{".priority"===s?(_(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):t=ca(N(n,s),o,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(N(n,".priority"),i)),t}}function fn(n,e){return fa(e,n)}function Hh(n,e){if(n.snap)return W(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&W(N(n.path,t),e))return!0;return!1}function qh(n){return n.visible}function ua(n,e,t){let i=H.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const a=o.path;let l;if(o.snap)W(t,a)?(l=M(t,a),i=kt(i,l,o.snap)):W(a,t)&&(l=M(a,t),i=kt(i,C(),o.snap.getChild(l)));else{if(!o.children)throw Ge("WriteRecord should have .snap or .children");if(W(t,a))l=M(t,a),i=bs(i,l,o.children);else if(W(a,t))if(l=M(a,t),y(l))i=bs(i,C(),o.children);else{const c=We(o.children,v(l));if(c){const u=c.getChild(I(l));i=kt(i,C(),u)}}}}}return i}function da(n,e,t,i,s){if(i||s){const o=me(n.visibleWrites,e);return!s&&Es(o)?t:s||null!=t||ws(o,C())?nt(ua(n.allWrites,function(u){return(u.visible||s)&&(!i||!~i.indexOf(u.writeId))&&(W(u.path,e)||W(e,u.path))},e),t||g.EMPTY_NODE):null}{const o=Me(n.visibleWrites,e);if(null!=o)return o;{const a=me(n.visibleWrites,e);return Es(a)?t:null!=t||ws(a,C())?nt(a,t||g.EMPTY_NODE):null}}}function _n(n,e,t,i){return da(n.writeTree,n.treePath,e,t,i)}function Cs(n,e){return function Xh(n,e,t){let i=g.EMPTY_NODE;const s=Me(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(S,(o,a)=>{i=i.updateImmediateChild(o,a)}),i;if(t){const o=me(n.visibleWrites,e);return t.forEachChild(S,(a,l)=>{const c=nt(me(o,new x(a)),l);i=i.updateImmediateChild(a,c)}),la(o).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}return la(me(n.visibleWrites,e)).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}(n.writeTree,n.treePath,e)}function ha(n,e,t,i){return function Kh(n,e,t,i,s){_(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=N(e,t);if(ws(n.visibleWrites,o))return null;{const a=me(n.visibleWrites,o);return Es(a)?s.getChild(t):nt(a,s.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function mn(n,e){return function Jh(n,e){return Me(n.visibleWrites,e)}(n.writeTree,N(n.treePath,e))}function xs(n,e,t){return function Qh(n,e,t,i){const s=N(e,t),o=Me(n.visibleWrites,s);return null!=o?o:i.isCompleteForChild(t)?nt(me(n.visibleWrites,s),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function pa(n,e){return fa(N(n.treePath,e),n.writeTree)}function fa(n,e){return{treePath:n,writeTree:e}}class np{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;_("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),_(".priority"!==i,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(i,Ct(i,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(i,Et(i,s.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(i,Ze(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw Ge("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(i,Ct(i,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const _a=new class ip{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class Is{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new _e(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return xs(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Oe(this.viewCache_),o=function tp(n,e,t,i,s,o){return function Zh(n,e,t,i,s,o,a){let l;const c=me(n.visibleWrites,e),u=Me(c,C());if(null!=u)l=u;else{if(null==t)return[];l=nt(c,t)}if(l=l.withIndex(a),l.isEmpty()||l.isLeafNode())return[];{const h=[],d=a.getCompare(),p=o?l.getReverseIteratorFrom(i,a):l.getIteratorFrom(i,a);let f=p.getNext();for(;f&&h.length<s;)0!==d(f,i)&&h.push(f),f=p.getNext();return h}}(n.writeTree,n.treePath,e,t,i,s,o)}(this.writes_,s,t,1,i,e);return 0===o.length?null:o[0]}}function ma(n,e,t,i,s,o){const a=e.eventCache;if(null!=mn(i,t))return e;{let l,c;if(y(t))if(_(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Oe(e),d=Cs(i,u instanceof g?u:g.EMPTY_NODE);l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const u=_n(i,Oe(e));l=n.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{const u=v(t);if(".priority"===u){_(1===fe(t),"Can't have a priority with additional path components");const h=a.getNode();c=e.serverCache.getNode();const d=ha(i,t,h,c);l=null!=d?n.filter.updatePriority(h,d):a.getNode()}else{const h=I(t);let d;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const p=ha(i,t,a.getNode(),c);d=null!=p?a.getNode().getImmediateChild(u).updateChild(h,p):a.getNode().getImmediateChild(u)}else d=xs(i,u,e.serverCache);l=null!=d?n.filter.updateChild(a.getNode(),u,d,h,s,o):a.getNode()}}return St(e,l,a.isFullyInitialized()||y(t),n.filter.filtersNodes())}}function gn(n,e,t,i,s,o,a,l){const c=e.serverCache;let u;const h=a?n.filter:n.filter.getIndexedFilter();if(y(t))u=h.updateFullNode(c.getNode(),i,null);else if(h.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(t,i);u=h.updateFullNode(c.getNode(),f,null)}else{const f=v(t);if(!c.isCompleteForPath(t)&&fe(t)>1)return e;const m=I(t),A=c.getNode().getImmediateChild(f).updateChild(m,i);u=".priority"===f?h.updatePriority(c.getNode(),A):h.updateChild(c.getNode(),f,A,m,_a,null)}const d=oa(e,u,c.isFullyInitialized()||y(t),h.filtersNodes());return ma(n,d,t,s,new Is(s,d,o),l)}function Ts(n,e,t,i,s,o,a){const l=e.eventCache;let c,u;const h=new Is(s,e,o);if(y(t))u=n.filter.updateFullNode(e.eventCache.getNode(),i,a),c=St(e,u,!0,n.filter.filtersNodes());else{const d=v(t);if(".priority"===d)u=n.filter.updatePriority(e.eventCache.getNode(),i),c=St(e,u,l.isFullyInitialized(),l.isFiltered());else{const p=I(t),f=l.getNode().getImmediateChild(d);let m;if(y(p))m=i;else{const E=h.getCompleteChild(d);m=null!=E?".priority"===ns(p)&&E.getChild(Ho(p)).isEmpty()?E:E.updateChild(p,i):g.EMPTY_NODE}c=f.equals(m)?e:St(e,n.filter.updateChild(l.getNode(),d,m,p,h,a),l.isFullyInitialized(),n.filter.filtersNodes())}}return c}function ga(n,e){return n.eventCache.isCompleteForChild(e)}function va(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Ss(n,e,t,i,s,o,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u,c=e;u=y(t)?i:new k(null).setTree(t,i);const h=e.serverCache.getNode();return u.children.inorderTraversal((d,p)=>{if(h.hasChild(d)){const m=va(0,e.serverCache.getNode().getImmediateChild(d),p);c=gn(n,c,new x(d),m,s,o,a,l)}}),u.children.inorderTraversal((d,p)=>{const f=!e.serverCache.isCompleteForChild(d)&&null===p.value;if(!h.hasChild(d)&&!f){const E=va(0,e.serverCache.getNode().getImmediateChild(d),p);c=gn(n,c,new x(d),E,s,o,a,l)}}),c}class hp{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new us(i.getIndex()),o=function Th(n){return n.loadsAllData()?new us(n.getIndex()):n.hasLimit()?new Ih(n):new xt(n)}(i);this.processor_=function sp(n){return{filter:n}}(o);const a=t.serverCache,l=t.eventCache,c=s.updateFullNode(g.EMPTY_NODE,a.getNode(),null),u=o.updateFullNode(g.EMPTY_NODE,l.getNode(),null),h=new _e(c,a.isFullyInitialized(),s.filtersNodes()),d=new _e(u,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=hn(d,h),this.eventGenerator_=new Oh(this.query_)}get query(){return this.query_}}function _p(n,e){const t=Oe(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!y(e)&&!t.getImmediateChild(v(e)).isEmpty())?t.getChild(e):null}function ya(n){return 0===n.eventRegistrations_.length}function ba(n,e,t){const i=[];if(t){_(null==e,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(t,s);a&&i.push(a)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const a=n.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}else s.push(a)}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function wa(n,e,t,i){e.type===te.MERGE&&null!==e.source.queryId&&(_(Oe(n.viewCache_),"We should always have a full cache before handling merges"),_(pn(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=function op(n,e,t,i,s){const o=new np;let a,l;if(t.type===te.OVERWRITE){const u=t;u.source.fromUser?a=Ts(n,e,u.path,u.snap,i,s,o):(_(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!y(u.path),a=gn(n,e,u.path,u.snap,i,s,l,o))}else if(t.type===te.MERGE){const u=t;u.source.fromUser?a=function lp(n,e,t,i,s,o,a){let l=e;return i.foreach((c,u)=>{const h=N(t,c);ga(e,v(h))&&(l=Ts(n,l,h,u,s,o,a))}),i.foreach((c,u)=>{const h=N(t,c);ga(e,v(h))||(l=Ts(n,l,h,u,s,o,a))}),l}(n,e,u.path,u.children,i,s,o):(_(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),a=Ss(n,e,u.path,u.children,i,s,l,o))}else if(t.type===te.ACK_USER_WRITE){const u=t;a=u.revert?function dp(n,e,t,i,s,o){let a;if(null!=mn(i,t))return e;{const l=new Is(i,e,s),c=e.eventCache.getNode();let u;if(y(t)||".priority"===v(t)){let h;if(e.serverCache.isFullyInitialized())h=_n(i,Oe(e));else{const d=e.serverCache.getNode();_(d instanceof g,"serverChildren would be complete if leaf node"),h=Cs(i,d)}u=n.filter.updateFullNode(c,h,o)}else{const h=v(t);let d=xs(i,h,e.serverCache);null==d&&e.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),u=null!=d?n.filter.updateChild(c,h,d,I(t),l,o):e.eventCache.getNode().hasChild(h)?n.filter.updateChild(c,h,g.EMPTY_NODE,I(t),l,o):c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=_n(i,Oe(e)),a.isLeafNode()&&(u=n.filter.updateFullNode(u,a,o)))}return a=e.serverCache.isFullyInitialized()||null!=mn(i,C()),St(e,u,a,n.filter.filtersNodes())}}(n,e,u.path,i,s,o):function cp(n,e,t,i,s,o,a){if(null!=mn(s,t))return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(null!=i.value){if(y(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return gn(n,e,t,c.getNode().getChild(t),s,o,l,a);if(y(t)){let u=new k(null);return c.getNode().forEachChild(ee,(h,d)=>{u=u.set(new x(h),d)}),Ss(n,e,t,u,s,o,l,a)}return e}{let u=new k(null);return i.foreach((h,d)=>{const p=N(t,h);c.isCompleteForPath(p)&&(u=u.set(h,c.getNode().getChild(p)))}),Ss(n,e,t,u,s,o,l,a)}}(n,e,u.path,u.affectedTree,i,s,o)}else{if(t.type!==te.LISTEN_COMPLETE)throw Ge("Unknown operation type: "+t.type);a=function up(n,e,t,i,s){const o=e.serverCache;return ma(n,oa(e,o.getNode(),o.isFullyInitialized()||y(t),o.isFiltered()),t,i,_a,s)}(n,e,t.path,i,o)}const c=o.getChanges();return function ap(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=pn(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(na(pn(e)))}}(e,a,c),{viewCache:a,changes:c}}(n.processor_,s,e,t,i);return function rp(n,e){_(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),_(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,o.viewCache),_(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,Ea(n,o.changes,o.viewCache.eventCache.getNode(),null)}function Ea(n,e,t,i){return function Mh(n,e,t,i){const s=[],o=[];return e.forEach(a=>{"child_changed"===a.type&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(function xh(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(a.childName,a.snapshotNode))}),Tt(n,s,"child_removed",e,i,t),Tt(n,s,"child_added",e,i,t),Tt(n,s,"child_moved",o,i,t),Tt(n,s,"child_changed",e,i,t),Tt(n,s,"value",e,i,t),s}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}let vn,bn;class Ca{constructor(){this.views=new Map}}function ks(n,e,t,i){const s=e.source.queryId;if(null!==s){const o=n.views.get(s);return _(null!=o,"SyncTree gave us an op for an invalid query."),wa(o,e,t,i)}{let o=[];for(const a of n.views.values())o=o.concat(wa(a,e,t,i));return o}}function wp(n,e,t,i,s,o){const a=function xa(n,e,t,i,s){const a=n.views.get(e._queryIdentifier);if(!a){let l=_n(t,s?i:null),c=!1;l?c=!0:i instanceof g?(l=Cs(t,i),c=!1):(l=g.EMPTY_NODE,c=!1);const u=hn(new _e(l,c,!1),new _e(i,s,!1));return new hp(e,u)}return a}(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,a),function mp(n,e){n.eventRegistrations_.push(e)}(a,t),function gp(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(S,(o,a)=>{i.push(Ze(o,a))}),t.isFullyInitialized()&&i.push(na(t.getNode())),Ea(n,i,t.getNode(),e)}(a,t)}function Ia(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ge(n,e){let t=null;for(const i of n.views.values())t=t||_p(i,e);return t}function Ta(n,e){return e._queryParams.loadsAllData()?yn(n):n.views.get(e._queryIdentifier)}function Sa(n,e){return null!=Ta(n,e)}function ve(n){return null!=yn(n)}function yn(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Ip=1;class ka{constructor(e){this.listenProvider_=e,this.syncPointTree_=new k(null),this.pendingWriteTree_=function ep(){return{visibleWrites:H.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function As(n,e,t,i,s){return function Gh(n,e,t,i,s){_(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=kt(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,s),s?it(n,new je({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function ye(n,e,t=!1){const i=function $h(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function Uh(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);_(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,a=n.allWrites.length-1;for(;s&&a>=0;){const l=n.allWrites[a];l.visible&&(a>=t&&Hh(l,i.path)?s=!1:W(i.path,l.path)&&(o=!0)),a--}return!!s&&(o?(function Yh(n){n.visibleWrites=ua(n.allWrites,qh,C()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=aa(n.visibleWrites,i.path):L(i.children,c=>{n.visibleWrites=aa(n.visibleWrites,N(i.path,c))}),!0))}(n.pendingWriteTree_,e)){let o=new k(null);return null!=i.snap?o=o.set(C(),!0):L(i.children,a=>{o=o.set(new x(a),!0)}),it(n,new dn(i.path,o,t))}return[]}function At(n,e,t){return it(n,new je({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function wn(n,e,t,i,s=!1){const o=e._path,a=n.syncPointTree_.get(o);let l=[];if(a&&("default"===e._queryIdentifier||Sa(a,e))){const c=function Ep(n,e,t,i){const s=e._queryIdentifier,o=[];let a=[];const l=ve(n);if("default"===s)for(const[c,u]of n.views.entries())a=a.concat(ba(u,t,i)),ya(u)&&(n.views.delete(c),u.query._queryParams.loadsAllData()||o.push(u.query));else{const c=n.views.get(s);c&&(a=a.concat(ba(c,t,i)),ya(c)&&(n.views.delete(s),c.query._queryParams.loadsAllData()||o.push(c.query)))}return l&&!ve(n)&&o.push(new(function yp(){return _(vn,"Reference.ts has not been loaded"),vn}())(e._repo,e._path)),{removed:o,events:a}}(a,e,t,i);(function bp(n){return 0===n.views.size})(a)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const u=c.removed;if(l=c.events,!s){const h=-1!==u.findIndex(p=>p._queryParams.loadsAllData()),d=n.syncPointTree_.findOnPath(o,(p,f)=>ve(f));if(h&&!d){const p=n.syncPointTree_.subtree(o);if(!p.isEmpty()){const f=function Dp(n){return n.fold((e,t,i)=>{if(t&&ve(t))return[yn(t)];{let s=[];return t&&(s=Ia(t)),L(i,(o,a)=>{s=s.concat(a)}),s}})}(p);for(let m=0;m<f.length;++m){const E=f[m],A=E.query,Ce=Da(n,E);n.listenProvider_.startListening(Rt(A),Nt(n,A),Ce.hashFn,Ce.onComplete)}}}!d&&u.length>0&&!i&&(h?n.listenProvider_.stopListening(Rt(e),null):u.forEach(p=>{const f=n.queryToTagMap.get(Cn(p));n.listenProvider_.stopListening(Rt(p),f)}))}!function Fp(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=Cn(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}(n,u)}return l}function Ns(n,e,t,i=!1){const s=e._path;let o=null,a=!1;n.syncPointTree_.foreachOnPath(s,(p,f)=>{const m=M(p,s);o=o||ge(f,m),a=a||ve(f)});let c,l=n.syncPointTree_.get(s);l?(a=a||ve(l),o=o||ge(l,C())):(l=new Ca,n.syncPointTree_=n.syncPointTree_.set(s,l)),null!=o?c=!0:(c=!1,o=g.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((f,m)=>{const E=ge(m,C());E&&(o=o.updateImmediateChild(f,E))}));const u=Sa(l,e);if(!u&&!e._queryParams.loadsAllData()){const p=Cn(e);_(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");const f=function Pp(){return Ip++}();n.queryToTagMap.set(p,f),n.tagToQueryMap.set(f,p)}let d=wp(l,e,t,fn(n.pendingWriteTree_,s),o,c);if(!u&&!a&&!i){const p=Ta(l,e);d=d.concat(function Lp(n,e,t){const i=e._path,s=Nt(n,e),o=Da(n,t),a=n.listenProvider_.startListening(Rt(e),s,o.hashFn,o.onComplete),l=n.syncPointTree_.subtree(i);if(s)_(!ve(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,h,d)=>{if(!y(u)&&h&&ve(h))return[yn(h).query];{let p=[];return h&&(p=p.concat(Ia(h).map(f=>f.query))),L(d,(f,m)=>{p=p.concat(m)}),p}});for(let u=0;u<c.length;++u){const h=c[u];n.listenProvider_.stopListening(Rt(h),Nt(n,h))}}return a}(n,e,p))}return d}function En(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(a,l)=>{const u=ge(l,M(a,e));if(u)return u});return da(s,e,o,t,!0)}function it(n,e){return Na(e,n.syncPointTree_,null,fn(n.pendingWriteTree_,C()))}function Na(n,e,t,i){if(y(n.path))return Ra(n,e,t,i);{const s=e.get(C());null==t&&null!=s&&(t=ge(s,C()));let o=[];const a=v(n.path),l=n.operationForChild(a),c=e.children.get(a);if(c&&l){const u=t?t.getImmediateChild(a):null,h=pa(i,a);o=o.concat(Na(l,c,u,h))}return s&&(o=o.concat(ks(s,n,i,t))),o}}function Ra(n,e,t,i){const s=e.get(C());null==t&&null!=s&&(t=ge(s,C()));let o=[];return e.children.inorderTraversal((a,l)=>{const c=t?t.getImmediateChild(a):null,u=pa(i,a),h=n.operationForChild(a);h&&(o=o.concat(Ra(h,l,c,u)))}),s&&(o=o.concat(ks(s,n,i,t))),o}function Da(n,e){const t=e.query,i=Nt(n,t);return{hashFn:()=>(function pp(n){return n.viewCache_.serverCache.getNode()}(e)||g.EMPTY_NODE).hash(),onComplete:s=>{if("ok"===s)return i?function Ap(n,e,t){const i=Rs(n,t);if(i){const s=Ds(i),o=s.path,a=s.queryId,l=M(o,e);return Fs(n,o,new It(vs(a),l))}return[]}(n,t._path,i):function kp(n,e){return it(n,new It({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const o=function Sd(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}(s,t);return wn(n,t,null,o)}}}}function Nt(n,e){const t=Cn(e);return n.queryToTagMap.get(t)}function Cn(n){return n._path.toString()+"$"+n._queryIdentifier}function Rs(n,e){return n.tagToQueryMap.get(e)}function Ds(n){const e=n.indexOf("$");return _(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new x(n.substr(0,e))}}function Fs(n,e,t){const i=n.syncPointTree_.get(e);return _(i,"Missing sync point for query tag that we're tracking"),ks(i,t,fn(n.pendingWriteTree_,e),null)}function Rt(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function xp(){return _(bn,"Reference.ts has not been loaded"),bn}())(n._repo,n._path):n}class Ps{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Ps(t)}node(){return this.node_}}class Ls{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=N(this.path_,e);return new Ls(this.syncTree_,t)}node(){return En(this.syncTree_,this.path_)}}const jp=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},Fa=function(n,e,t){return n&&"object"==typeof n?(_(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Op(n[".sv"],e,t):"object"==typeof n[".sv"]?Mp(n[".sv"],e):void _(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Op=function(n,e,t){if("timestamp"===n)return t.timestamp;_(!1,"Unexpected server value: "+n)},Mp=function(n,e,t){n.hasOwnProperty("increment")||_(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&_(!1,"Unexpected increment value: "+i);const s=e.node();if(_(null!==s&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const a=s.getValue();return"number"!=typeof a?i:a+i},Pa=function(n,e,t,i){return Os(e,new Ls(t,n),i)},js=function(n,e,t){return Os(n,new Ps(e),t)};function Os(n,e,t){const i=n.getPriority().val(),s=Fa(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const a=n,l=Fa(a.getValue(),e,t);return l!==a.getValue()||s!==a.getPriority().val()?new Qe(l,R(s)):n}{const a=n;return o=a,s!==a.getPriority().val()&&(o=o.updatePriority(new Qe(s))),a.forEachChild(S,(l,c)=>{const u=Os(c,e.getImmediateChild(l),t);u!==c&&(o=o.updateImmediateChild(l,u))}),o}}class Ms{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function xn(n,e){let t=e instanceof x?e:new x(e),i=n,s=v(t);for(;null!==s;){const o=We(i.node.children,s)||{children:{},childCount:0};i=new Ms(s,i,o),t=I(t),s=v(t)}return i}function Be(n){return n.node.value}function Bs(n,e){n.node.value=e,Vs(n)}function La(n){return n.node.childCount>0}function In(n,e){L(n.node.children,(t,i)=>{e(new Ms(t,n,i))})}function ja(n,e,t,i){t&&!i&&e(n),In(n,s=>{ja(s,e,!0,i)}),t&&i&&e(n)}function Dt(n){return new x(null===n.parent?n.name:Dt(n.parent)+"/"+n.name)}function Vs(n){null!==n.parent&&function zp(n,e,t){const i=function Bp(n){return void 0===Be(n)&&!La(n)}(t),s=K(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,Vs(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Vs(n))}(n.parent,n.name,n)}const Gp=/[\[\].#$\/\u0000-\u001F\u007F]/,Wp=/[\[\].#$\u0000-\u001F\u007F]/,zs=10485760,Tn=function(n){return"string"==typeof n&&0!==n.length&&!Gp.test(n)},Oa=function(n){return"string"==typeof n&&0!==n.length&&!Wp.test(n)},Pt=function(n,e,t){const i=t instanceof x?new oh(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Pe(i));if("function"==typeof e)throw new Error(n+"contains a function "+Pe(i)+" with contents = "+e.toString());if(Zt(e))throw new Error(n+"contains "+e.toString()+" "+Pe(i));if("string"==typeof e&&e.length>zs/3&&Yt(e)>zs)throw new Error(n+"contains a string greater than "+zs+" utf8 bytes "+Pe(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let s=!1,o=!1;if(L(e,(a,l)=>{if(".value"===a)s=!0;else if(".priority"!==a&&".sv"!==a&&(o=!0,!Tn(a)))throw new Error(n+" contains an invalid key ("+a+") "+Pe(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function ah(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Yt(e),Yo(n)})(i,a),Pt(n,l,i),function lh(n){const e=n.parts_.pop();n.byteLength_-=Yt(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),s&&o)throw new Error(n+' contains ".value" child '+Pe(i)+" in addition to actual children.")}},Ws=function(n,e,t,i){if(!(i&&void 0===t||Oa(t)))throw new Error($e(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Hp=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ws(n,e,t,i)};class Yp{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Sn(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();null!==t&&!is(o,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Va(n,e,t){Sn(n,t),za(n,i=>is(i,e))}function V(n,e,t){Sn(n,t),za(n,i=>W(i,e)||W(e,i))}function za(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];s&&(e(s.path)?(qp(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function qp(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();De&&P("event: "+t.toString()),Xe(i)}}}const Xp=25;class Kp{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Yp,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=un(),this.transactionQueueTree_=new Ms,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Wa(n){const t=n.infoData_.getNode(new x(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function jt(n){return jp({timestamp:Wa(n)})}function $a(n,e,t,i,s){n.dataUpdateCount++;const o=new x(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let a=[];if(s)if(i){const c=Ut(t,u=>R(u));a=function Np(n,e,t,i){const s=Rs(n,i);if(s){const o=Ds(s),a=o.path,l=o.queryId,c=M(a,e),u=k.fromObject(t);return Fs(n,a,new tt(vs(l),c,u))}return[]}(n.serverSyncTree_,o,c,s)}else{const c=R(t);a=function Aa(n,e,t,i){const s=Rs(n,i);if(null!=s){const o=Ds(s),a=o.path,l=o.queryId,c=M(a,e);return Fs(n,a,new je(vs(l),c,t))}return[]}(n.serverSyncTree_,o,c,s)}else if(i){const c=Ut(t,u=>R(u));a=function Sp(n,e,t){const i=k.fromObject(t);return it(n,new tt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,o,c)}else{const c=R(t);a=At(n.serverSyncTree_,o,c)}let l=o;a.length>0&&(l=rt(n,o)),V(n.eventQueue_,l,a)}function Ua(n,e){$s(n,"connected",e),!1===e&&function tf(n){st(n,"onDisconnectEvents");const e=jt(n),t=un();_s(n.onDisconnect_,C(),(s,o)=>{const a=Pa(s,o,n.serverSyncTree_,e);et(t,s,a)});let i=[];_s(t,C(),(s,o)=>{i=i.concat(At(n.serverSyncTree_,s,o));const a=qs(n,s);rt(n,a)}),n.onDisconnect_=un(),V(n.eventQueue_,C(),i)}(n)}function $s(n,e,t){const i=new x("/.info/"+e),s=R(t);n.infoData_.updateSnapshot(i,s);const o=At(n.infoSyncTree_,i,s);V(n.eventQueue_,i,o)}function kn(n){return n.nextWriteId_++}function Us(n,e,t,i,s){st(n,"set",{path:e.toString(),value:t,priority:i});const o=jt(n),a=R(t,i),l=En(n.serverSyncTree_,e),c=js(a,l,o),u=kn(n),h=As(n.serverSyncTree_,e,c,u,!0);Sn(n.eventQueue_,h),n.server_.put(e.toString(),a.val(!0),(p,f)=>{const m="ok"===p;m||j("set at "+e+" failed: "+p);const E=ye(n.serverSyncTree_,u,!m);V(n.eventQueue_,e,E),function be(n,e,t,i){e&&Xe(()=>{if("ok"===t)e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const a=new Error(o);a.code=s,e(a)}})}(0,s,p,f)});const d=qs(n,e);rt(n,d),V(n.eventQueue_,d,[])}function Hs(n,e,t){let i;i=".info"===v(e._path)?wn(n.infoSyncTree_,e,t):wn(n.serverSyncTree_,e,t),Va(n.eventQueue_,e._path,i)}function st(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),P(t,...e)}function Ys(n,e,t){return En(n.serverSyncTree_,e,t)||g.EMPTY_NODE}function An(n,e=n.transactionQueueTree_){if(e||Nn(n,e),Be(e)){const t=Xa(n,e);_(t.length>0,"Sending zero length transaction queue"),t.every(s=>0===s.status)&&function cf(n,e,t){const i=t.map(u=>u.currentWriteId),s=Ys(n,e,i);let o=s;const a=s.hash();for(let u=0;u<t.length;u++){const h=t[u];_(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=M(e,h.path);o=o.updateChild(d,h.currentOutputSnapshotRaw)}const l=o.val(!0),c=e;n.server_.put(c.toString(),l,u=>{st(n,"transaction put response",{path:c.toString(),status:u});let h=[];if("ok"===u){const d=[];for(let p=0;p<t.length;p++)t[p].status=2,h=h.concat(ye(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&d.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();Nn(n,xn(n.transactionQueueTree_,e)),An(n,n.transactionQueueTree_),V(n.eventQueue_,e,h);for(let p=0;p<d.length;p++)Xe(d[p])}else{if("datastale"===u)for(let d=0;d<t.length;d++)t[d].status=3===t[d].status?4:0;else{j("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=u}rt(n,e)}},a)}(n,Dt(e),t)}else La(e)&&In(e,t=>{An(n,t)})}function rt(n,e){const t=qa(n,e),i=Dt(t);return function uf(n,e,t){if(0===e.length)return;const i=[];let s=[];const a=e.filter(l=>0===l.status).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],u=M(t,c.path);let d,h=!1;if(_(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,d=c.abortReason,s=s.concat(ye(n.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=Xp)h=!0,d="maxretry",s=s.concat(ye(n.serverSyncTree_,c.currentWriteId,!0));else{const p=Ys(n,c.path,a);c.currentInputSnapshot=p;const f=e[l].update(p.val());if(void 0!==f){Pt("transaction failed: Data returned ",f,c.path);let m=R(f);"object"==typeof f&&null!=f&&K(f,".priority")||(m=m.updatePriority(p.getPriority()));const A=c.currentWriteId,Ce=jt(n),Pn=js(m,p,Ce);c.currentOutputSnapshotRaw=m,c.currentOutputSnapshotResolved=Pn,c.currentWriteId=kn(n),a.splice(a.indexOf(A),1),s=s.concat(As(n.serverSyncTree_,c.path,Pn,c.currentWriteId,c.applyLocally)),s=s.concat(ye(n.serverSyncTree_,A,!0))}else h=!0,d="nodata",s=s.concat(ye(n.serverSyncTree_,c.currentWriteId,!0))}V(n.eventQueue_,t,s),s=[],h&&(e[l].status=2,setTimeout(e[l].unwatcher,Math.floor(0)),e[l].onComplete&&i.push("nodata"===d?()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot):()=>e[l].onComplete(new Error(d),!1,null)))}Nn(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Xe(i[l]);An(n,n.transactionQueueTree_)}(n,Xa(n,t),i),i}function qa(n,e){let t,i=n.transactionQueueTree_;for(t=v(e);null!==t&&void 0===Be(i);)i=xn(i,t),t=v(e=I(e));return i}function Xa(n,e){const t=[];return Ka(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Ka(n,e,t){const i=Be(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);In(e,s=>{Ka(n,s,t)})}function Nn(n,e){const t=Be(e);if(t){let i=0;for(let s=0;s<t.length;s++)2!==t[s].status&&(t[i]=t[s],i++);t.length=i,Bs(e,t.length>0?t:void 0)}In(e,i=>{Nn(n,i)})}function qs(n,e){const t=Dt(qa(n,e)),i=xn(n.transactionQueueTree_,e);return function Vp(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,s=>{Xs(n,s)}),Xs(n,i),ja(i,s=>{Xs(n,s)}),t}function Xs(n,e){const t=Be(e);if(t){const i=[];let s=[],o=-1;for(let a=0;a<t.length;a++)3===t[a].status||(1===t[a].status?(_(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=3,t[a].abortReason="set"):(_(0===t[a].status,"Unexpected transaction status in abort"),t[a].unwatcher(),s=s.concat(ye(n.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&i.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Bs(e,void 0):t.length=o+1,V(n.eventQueue_,Dt(e),s);for(let a=0;a<i.length;a++)Xe(i[a])}}const Ks=function(n,e){const t=pf(n),i=t.namespace;return"firebase.com"===t.domain&&Z(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&Z("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&j("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Ki(t.host,t.secure,i,"ws"===t.scheme||"wss"===t.scheme,e,"",i!==t.subdomain),path:new x(t.pathString)}},pf=function(n){let e="",t="",i="",s="",o="",a=!0,l="https",c=443;if("string"==typeof n){let u=n.indexOf("//");u>=0&&(l=n.substring(0,u-1),n=n.substring(u+2));let h=n.indexOf("/");-1===h&&(h=n.length);let d=n.indexOf("?");-1===d&&(d=n.length),e=n.substring(0,Math.min(h,d)),h<d&&(s=function df(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}(n.substring(h,d)));const p=function hf(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):j(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,d)));u=e.indexOf(":"),u>=0?(a="https"===l||"wss"===l,c=parseInt(e.substring(u+1),10)):u=e.length;const f=e.slice(0,u);if("localhost"===f.toLowerCase())t="localhost";else if(f.split(".").length<=2)t=f;else{const m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),t=e.substring(m+1),o=i}"ns"in p&&(o=p.ns)}return{host:e,port:c,domain:t,subdomain:i,secure:a,scheme:l,pathString:s,namespace:o}};class Ja{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+D(this.snapshot.exportVal())}}class Za{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Qs{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return _(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class z{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return y(this._path)?null:ns(this._path)}get ref(){return new Y(this._repo,this._path)}get _queryIdentifier(){const e=sa(this._queryParams),t=qi(e);return"{}"===t?"default":t}get _queryObject(){return sa(this._queryParams)}isEqual(e){if(!((e=Te(e))instanceof z))return!1;const t=this._repo===e._repo,i=is(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function sh(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class Y extends z{constructor(e,t){super(e,t,new ds,!1)}get parent(){const e=Ho(this._path);return null===e?null:new Y(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ve{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new x(e),i=ot(this.ref,e);return new Ve(this._node.getChild(t),i,S)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,s)=>e(new Ve(s,ot(this.ref,i),S)))}hasChild(e){const t=new x(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Js(n,e){return(n=Te(n))._checkNotDeleted("ref"),void 0!==e?ot(n._root,e):n._root}function ot(n,e){return null===v((n=Te(n))._path)?Hp("child","path",e,!1):Ws("child","path",e,!1),new Y(n._repo,N(n._path,e))}function Zs(n,e){(function(n,e){if(".info"===v(e))throw new Error(n+" failed = Can't modify data under /.info/")})("set",(n=Te(n))._path),function(n,e,t,i){i&&void 0===e||Pt($e(n,"value"),e,t)}("set",e,n._path,!1);const t=new at;return Us(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}class Ot{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const i=t._queryParams.getIndex();return new Ja("value",this,new Ve(e.snapshotNode,new Y(t._repo,t._path),i))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Za(this,e,t):null}matches(e){return e instanceof Ot&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Fn{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Za(this,e,t):null}createEvent(e,t){_(null!=e.childName,"Child events should have a childName.");const i=ot(new Y(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new Ja(e.type,this,new Ve(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Fn&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function el(n,e,t,i){return function Mt(n,e,t,i,s){let o;if("object"==typeof i&&(o=void 0,s=i),"function"==typeof i&&(o=i),s&&s.onlyOnce){const c=t,u=(h,d)=>{Hs(n._repo,n,l),c(h,d)};u.userCallback=t.userCallback,u.context=t.context,t=u}const a=new Qs(t,o||void 0),l="value"===e?new Ot(a):new Fn(e,a);return function of(n,e,t){let i;i=".info"===v(e._path)?Ns(n.infoSyncTree_,e,t):Ns(n.serverSyncTree_,e,t),Va(n.eventQueue_,e._path,i)}(n._repo,n,l),()=>Hs(n._repo,n,l)}(n,"value",e,t,i)}(function vp(n){_(!vn,"__referenceConstructor has already been defined"),vn=n})(Y),function Cp(n){_(!bn,"__referenceConstructor has already been defined"),bn=n}(Y);const er={};function sl(n,e,t,i,s){let o=i||n.options.databaseURL;void 0===o&&(n.options.projectId||Z("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),P("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c,u,a=Ks(o,s),l=a.repoInfo;typeof process<"u"&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(c=!0,o=`http://${u}?ns=${l.namespace}`,a=Ks(o,s),l=a.repoInfo):c=!a.repoInfo.secure;const h=s&&c?new gt(gt.OWNER):new Fd(n.name,n.options,e);(function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Tn(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Oa(n)}(t))throw new Error($e(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),y(a.path)||Z("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function kf(n,e,t,i){let s=er[e.name];s||(s={},er[e.name]=s);let o=s[n.toURLString()];return o&&Z("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Kp(n,false,t,i),s[n.toURLString()]=o,o}(l,n,h,new Dd(n,t));return new Nf(d,n)}class Nf{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Qp(n,e,t){if(n.stats_=Zi(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new cn(n.repoInfo_,(i,s,o,a)=>{$a(n,i,s,o,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Ua(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{D(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Le(n.repoInfo_,e,(i,s,o,a)=>{$a(n,i,s,o,a)},i=>{Ua(n,i)},i=>{!function Jp(n,e){L(e,(t,i)=>{$s(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function jd(n,e){const t=n.toString();return Ji[t]||(Ji[t]=e()),Ji[t]}(n.repoInfo_,()=>new jh(n.stats_,n.server_)),n.infoData_=new Rh,n.infoSyncTree_=new ka({startListening:(i,s,o,a)=>{let l=[];const c=n.infoData_.getNode(i._path);return c.isEmpty()||(l=At(n.infoSyncTree_,i._path,c),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),$s(n,"connected",!1),n.serverSyncTree_=new ka({startListening:(i,s,o,a)=>(n.server_.listen(i,o,s,(l,c)=>{const u=a(l,c);V(n.eventQueue_,i._path,u)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Y(this._repo,C())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Sf(n,e){const t=er[e];(!t||t[n.key]!==n)&&Z(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function Ya(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Z("Cannot call "+e+" on a deleted database.")}}function ol(n=Ir(),e){const t=Ue(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=(n=>{const e=(n=>{var e,t;return null===(t=null===(e=zt())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[n]})(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),i]:[e.substring(0,t),i]})("database");i&&function Rf(n,e,t,i={}){(n=Te(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Z("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Z('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new gt(gt.OWNER);else if(i.mockUserToken){const a="string"==typeof i.mockUserToken?i.mockUserToken:function vl(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Bt(JSON.stringify({alg:"none",type:"JWT"})),Bt(JSON.stringify(a)),""].join(".")}(i.mockUserToken,n.app.options.projectId);o=new gt(a)}!function Tf(n,e,t,i){n.repoInfo_=new Ki(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(s,e,t,o)}(t,...i)}return t}Le.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Le.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Df(n){(function lo(n){Ui=n})("11.3.0"),de(new re("database",(e,{instanceIdentifier:t})=>sl(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),$(oo,"1.0.12",n),$(oo,"1.0.12","esm2017")}();var Ee=X(7801),r=X(2598),Lf=X(5365),al=X(4105);const jf=["workarea"];function Of(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",122)(2,"h4"),r.EFF(3,"Path"),r.k0s(),r.j41(4,"div",96)(5,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"x"))}),r.j41(6,"input",123,124),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"x",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"y"))}),r.j41(11,"input",123,125),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"y",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Y"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.x),r.R7$(5),r.Y8G("value",t.selectedElement.y)}}function Mf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",126)(2,"h4"),r.EFF(3,"Rectangle"),r.k0s(),r.j41(4,"div",96)(5,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"x"))}),r.j41(6,"input",123,127),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"x",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"y"))}),r.j41(11,"input",123,128),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"y",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Y"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"width"))}),r.j41(16,"input",123,129),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"width",+s.value))}),r.k0s(),r.j41(18,"span",100),r.EFF(19,"Width"),r.k0s()(),r.j41(20,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"height"))}),r.j41(21,"input",123,130),r.bIt("input",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"height",+s.value))}),r.k0s(),r.j41(23,"span",100),r.EFF(24,"Height"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.x),r.R7$(5),r.Y8G("value",t.selectedElement.y),r.R7$(5),r.Y8G("value",t.selectedElement.options.width),r.R7$(5),r.Y8G("value",t.selectedElement.options.height)}}function Bf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",131)(2,"h4"),r.EFF(3,"Image"),r.k0s(),r.j41(4,"div",96)(5,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"x"))}),r.j41(6,"input",132,133),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"x",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"y"))}),r.j41(11,"input",134,135),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"y",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Y"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"width"))}),r.j41(16,"input",123,136),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"width",+s.value))}),r.k0s(),r.j41(18,"span",100),r.EFF(19,"Width"),r.k0s()(),r.j41(20,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"height"))}),r.j41(21,"input",123,137),r.bIt("input",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"height",+s.value))}),r.k0s(),r.j41(23,"span",100),r.EFF(24,"Height"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.x),r.R7$(5),r.Y8G("value",t.selectedElement.y),r.R7$(5),r.Y8G("value",t.selectedElement.options.width),r.R7$(5),r.Y8G("value",t.selectedElement.options.height)}}function Vf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",138)(2,"h4"),r.EFF(3,"Ellipse"),r.k0s(),r.j41(4,"div",96)(5,"label",139),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"cx"))}),r.j41(6,"input",140,141),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"cx",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"cy"))}),r.j41(11,"input",142,143),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"cy",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Y"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"rx"))}),r.j41(16,"input",144,145),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"rx",+s.value))}),r.k0s(),r.j41(18,"span"),r.EFF(19,"Radius X"),r.k0s()(),r.j41(20,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"ry"))}),r.j41(21,"input",146,147),r.bIt("input",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"ry",+s.value))}),r.k0s(),r.j41(23,"span"),r.EFF(24,"Radius Y"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.options.cx),r.R7$(5),r.Y8G("value",t.selectedElement.options.cy),r.R7$(5),r.Y8G("value",t.selectedElement.options.rx),r.R7$(5),r.Y8G("value",t.selectedElement.options.ry)}}function zf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",148)(2,"h4"),r.EFF(3,"Line"),r.k0s(),r.j41(4,"div",96)(5,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"x1"))}),r.j41(6,"input",149,150),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"x1",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"Start X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"y1"))}),r.j41(11,"input",151,152),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"y1",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Start Y"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"x2"))}),r.j41(16,"input",153,154),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"x2",+s.value))}),r.k0s(),r.j41(18,"span"),r.EFF(19,"End X"),r.k0s()(),r.j41(20,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"y2"))}),r.j41(21,"input",155,156),r.bIt("input",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"y2",+s.value))}),r.k0s(),r.j41(23,"span"),r.EFF(24,"End Y"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.options.x1),r.R7$(5),r.Y8G("value",t.selectedElement.options.y1),r.R7$(5),r.Y8G("value",t.selectedElement.options.x2),r.R7$(5),r.Y8G("value",t.selectedElement.options.y2)}}function Gf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",157)(2,"h4"),r.EFF(3,"Arrow"),r.k0s(),r.j41(4,"div",96)(5,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"x1"))}),r.j41(6,"input",149,150),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"x1",+s.value))}),r.k0s(),r.j41(8,"span"),r.EFF(9,"Start X"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"y1"))}),r.j41(11,"input",151,152),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"y1",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"Start Y"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"x2"))}),r.j41(16,"input",153,154),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"x2",+s.value))}),r.k0s(),r.j41(18,"span"),r.EFF(19,"End X"),r.k0s()(),r.j41(20,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"y2"))}),r.j41(21,"input",155,156),r.bIt("input",function(){r.eBV(t);const s=r.sdS(22),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"y2",+s.value))}),r.k0s(),r.j41(23,"span"),r.EFF(24,"End Y"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.options.x1),r.R7$(5),r.Y8G("value",t.selectedElement.options.y1),r.R7$(5),r.Y8G("value",t.selectedElement.options.x2),r.R7$(5),r.Y8G("value",t.selectedElement.options.y2)}}function Wf(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"div",158)(2,"h4"),r.EFF(3,"Text"),r.k0s(),r.j41(4,"div",96)(5,"label",159)(6,"input",160,161),r.bIt("input",function(){r.eBV(t);const s=r.sdS(7),o=r.XpG(2);return r.Njj(o.selectedElement.value=s.value)}),r.k0s(),r.j41(8,"span"),r.EFF(9,"Content"),r.k0s()(),r.j41(10,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"x"))}),r.j41(11,"input",162,163),r.bIt("input",function(){r.eBV(t);const s=r.sdS(12),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"x",+s.value))}),r.k0s(),r.j41(13,"span"),r.EFF(14,"X"),r.k0s()(),r.j41(15,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement,"y"))}),r.j41(16,"input",164,165),r.bIt("input",function(){r.eBV(t);const s=r.sdS(17),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement,"y",+s.value))}),r.k0s(),r.j41(18,"span"),r.EFF(19,"Y"),r.k0s()(),r.j41(20,"div",166)(21,"span"),r.EFF(22,"Font"),r.k0s(),r.j41(23,"div",167),r.EFF(24),r.k0s(),r.nrm(25,"div",118)(26,"input",168),r.j41(27,"select",169,170),r.bIt("change",function(){r.eBV(t);const s=r.sdS(28),o=r.XpG(2);return r.Njj(o.selectedElement.options.fontFamily=s.value)}),r.j41(29,"option",171),r.EFF(30,"Arial"),r.k0s(),r.j41(31,"option",172),r.EFF(32,"Arial Black"),r.k0s(),r.j41(33,"option",173),r.EFF(34,"Comic Sans MS"),r.k0s(),r.j41(35,"option",174),r.EFF(36,"Courier New"),r.k0s(),r.j41(37,"option",175),r.EFF(38,"Georgia"),r.k0s(),r.j41(39,"option",176),r.EFF(40,"Impact"),r.k0s(),r.j41(41,"option",177),r.EFF(42,"Lucida Console"),r.k0s(),r.j41(43,"option",178),r.EFF(44,"Lucida Sans Unicode"),r.k0s(),r.j41(45,"option",179),r.EFF(46,"Monospace"),r.k0s(),r.j41(47,"option",180),r.EFF(48,"Palatino Linotype"),r.k0s(),r.j41(49,"option",181),r.EFF(50,"Sans-serif"),r.k0s(),r.j41(51,"option",182),r.EFF(52,"Serif"),r.k0s(),r.j41(53,"option",183),r.EFF(54,"Tahoma"),r.k0s(),r.j41(55,"option",184),r.EFF(56,"Times New Roman"),r.k0s(),r.j41(57,"option",185),r.EFF(58,"Trebuchet MS"),r.k0s(),r.j41(59,"option",186),r.EFF(60,"Verdana"),r.k0s()()(),r.j41(61,"div",187)(62,"span"),r.EFF(63,"Font Style"),r.k0s(),r.j41(64,"div",188),r.bIt("click",function(){r.eBV(t);const s=r.XpG(2);return r.Njj(s.toggleFontWeight())}),r.EFF(65," B "),r.k0s(),r.j41(66,"div",189),r.bIt("click",function(){r.eBV(t);const s=r.XpG(2);return r.Njj(s.toggleFontStyle())}),r.EFF(67," i "),r.k0s()(),r.j41(68,"label",190),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(70),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"fontSize"))}),r.j41(69,"input",191,192),r.bIt("input",function(){r.eBV(t);const s=r.sdS(70),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"fontSize",+s.value))}),r.k0s(),r.j41(71,"span",193),r.EFF(72,"Font Size"),r.k0s()()()(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(6),r.Y8G("value",t.selectedElement.value),r.R7$(5),r.Y8G("value",t.selectedElement.x),r.R7$(5),r.Y8G("value",t.selectedElement.y),r.R7$(7),r.xc7("font-family",t.selectedElement.options.fontFamily),r.R7$(1),r.SpI(" ",t.selectedElement.options.fontFamily," "),r.R7$(3),r.Y8G("value",t.selectedElement.options.fontFamily),r.R7$(37),r.AVh("active","bold"===t.selectedElement.options.fontWeight),r.R7$(2),r.AVh("active","italic"===t.selectedElement.options.fontStyle),r.R7$(3),r.Y8G("value",t.selectedElement.options.fontSize)}}function $f(n,e){if(1&n){const t=r.RV6();r.qex(0),r.j41(1,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(3),o=r.XpG(2);return r.Njj(o.onDragDown(s,o.selectedElement.options,"rx"))}),r.j41(2,"input",194,195),r.bIt("input",function(){r.eBV(t);const s=r.sdS(3),o=r.XpG(2);return r.Njj(o.setNumberValue(o.selectedElement.options,"rx",+s.value))}),r.k0s(),r.j41(4,"span",100),r.EFF(5,"Roundness"),r.k0s(),r.nrm(6,"div",196),r.k0s(),r.bVm()}if(2&n){const t=r.XpG(2);r.R7$(2),r.Y8G("value",t.selectedElement.options.rx)}}function Uf(n,e){1&n&&(r.qex(0),r.EFF(1,"\xb7\xb7\xb7"),r.bVm())}function Hf(n,e){1&n&&(r.qex(0),r.EFF(1,"- -"),r.bVm())}function Yf(n,e){1&n&&(r.qex(0),r.EFF(1,"-\xb7-"),r.bVm())}function qf(n,e){1&n&&(r.qex(0),r.EFF(1,"-\xb7\xb7-"),r.bVm())}function Xf(n,e){1&n&&(r.qex(0),r.EFF(1,"\u2014"),r.bVm())}function Kf(n,e){1&n&&r.eu8(0)}function Qf(n,e){if(1&n&&(r.qex(0),r.DNE(1,Kf,1,0,"ng-container",197),r.bVm()),2&n){r.XpG(2);const t=r.sdS(47);r.R7$(1),r.Y8G("ngTemplateOutlet",t)}}function Jf(n,e){if(1&n){const t=r.RV6();r.qex(0)(1,93),r.DNE(2,Of,15,2,"ng-container",94),r.DNE(3,Mf,25,4,"ng-container",94),r.DNE(4,Bf,25,4,"ng-container",94),r.DNE(5,Vf,25,4,"ng-container",94),r.DNE(6,zf,25,4,"ng-container",94),r.DNE(7,Gf,25,4,"ng-container",94),r.DNE(8,Wf,73,12,"ng-container",94),r.j41(9,"div",95)(10,"div",96)(11,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(13),o=r.XpG();return r.Njj(o.onDragDown(s,o.selectedElement,"rotation"))}),r.j41(12,"input",98,99),r.bIt("input",function(){r.eBV(t);const s=r.sdS(13),o=r.XpG();return r.Njj(o.setNumberValue(o.selectedElement,"rotation",+s.value))}),r.k0s(),r.j41(14,"span",100),r.EFF(15,"Rotation"),r.k0s(),r.j41(16,"div",101),r.nrm(17,"div",102),r.k0s()(),r.j41(18,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(20),o=r.XpG();return r.Njj(o.onDragDown(s,o.selectedElement,"opacity"))}),r.j41(19,"input",103,104),r.bIt("input",function(){r.eBV(t);const s=r.sdS(20),o=r.XpG();return r.Njj(o.setNumberValue(o.selectedElement,"opacity",+s.value))}),r.k0s(),r.j41(21,"span",105),r.EFF(22,"Opacity"),r.k0s()(),r.DNE(23,$f,7,1,"ng-container",94),r.k0s()(),r.j41(24,"div",106)(25,"h4"),r.EFF(26,"Stroke"),r.k0s(),r.j41(27,"div",96)(28,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(30),o=r.XpG();return r.Njj(o.onDragDown(s,o.selectedElement.options,"strokeWidth"))}),r.j41(29,"input",107,108),r.bIt("input",function(){r.eBV(t);const s=r.sdS(30),o=r.XpG();return r.Njj(o.setNumberValue(o.selectedElement.options,"strokeWidth",+s.value))}),r.k0s(),r.j41(31,"span",100),r.EFF(32,"Width"),r.k0s(),r.nrm(33,"div",109),r.k0s(),r.j41(34,"div",110)(35,"span"),r.EFF(36,"Dash"),r.k0s(),r.j41(37,"select",111,112),r.bIt("change",function(){r.eBV(t);const s=r.sdS(38),o=r.XpG();return r.Njj(o.selectedElement.options.dasharray=s.value)}),r.j41(39,"option",113),r.EFF(40,"\u2014"),r.k0s(),r.j41(41,"option",114),r.EFF(42,"\xb7\xb7\xb7"),r.k0s(),r.j41(43,"option",115),r.EFF(44,"- -"),r.k0s(),r.j41(45,"option",116),r.EFF(46,"-\xb7-"),r.k0s(),r.j41(47,"option",117),r.EFF(48,"-\xb7\xb7-"),r.k0s()(),r.nrm(49,"div",118),r.j41(50,"label",119),r.qex(51,93),r.DNE(52,Uf,2,0,"ng-container",94),r.DNE(53,Hf,2,0,"ng-container",94),r.DNE(54,Yf,2,0,"ng-container",94),r.DNE(55,qf,2,0,"ng-container",94),r.DNE(56,Xf,2,0,"ng-container",120),r.bVm(),r.k0s()(),r.j41(57,"label",121)(58,"span",100),r.EFF(59,"Stroke Join"),r.k0s()(),r.j41(60,"label",121)(61,"span",100),r.EFF(62,"Stroke Cap"),r.k0s()()()(),r.DNE(63,Qf,2,1,"ng-container",120),r.bVm()()}if(2&n){const t=r.XpG();r.R7$(1),r.Y8G("ngSwitch",t.selectedElement.type),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.BRUSH),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.RECT),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.IMAGE),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.ELLIPSE),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.LINE),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.ARROW),r.R7$(1),r.Y8G("ngSwitchCase",t.elementTypeEnum.TEXT),r.R7$(4),r.Y8G("value",t.selectedElement.rotation),r.R7$(4),r.Aen("transform: rotate("+t.selectedElement.rotation+"deg);"),r.R7$(3),r.Y8G("value",t.selectedElement.opacity),r.R7$(4),r.Y8G("ngSwitchCase",t.elementTypeEnum.RECT),r.R7$(6),r.Y8G("value",t.selectedElement.options.strokeWidth),r.R7$(8),r.Y8G("value",t.selectedElement.options.dasharray),r.R7$(14),r.Y8G("ngSwitch",t.selectedElement.options.dasharray),r.R7$(1),r.Y8G("ngSwitchCase","2,2"),r.R7$(1),r.Y8G("ngSwitchCase","5,5"),r.R7$(1),r.Y8G("ngSwitchCase","5,2,2,2"),r.R7$(1),r.Y8G("ngSwitchCase","5,2,2,2,2,2")}}function Zf(n,e){1&n&&r.eu8(0)}function e_(n,e){if(1&n&&(r.qex(0),r.DNE(1,Zf,1,0,"ng-container",197),r.bVm()),2&n){r.XpG();const t=r.sdS(47);r.R7$(1),r.Y8G("ngTemplateOutlet",t)}}function t_(n,e){1&n&&(r.qex(0),r.EFF(1,"\xb7\xb7\xb7"),r.bVm())}function n_(n,e){1&n&&(r.qex(0),r.EFF(1,"- -"),r.bVm())}function i_(n,e){1&n&&(r.qex(0),r.EFF(1,"-\xb7-"),r.bVm())}function s_(n,e){1&n&&(r.qex(0),r.EFF(1,"-\xb7\xb7-"),r.bVm())}function r_(n,e){1&n&&(r.qex(0),r.EFF(1,"\u2014"),r.bVm())}function o_(n,e){if(1&n){const t=r.RV6();r.j41(0,"div",198)(1,"h4"),r.EFF(2,"Whiteboard"),r.k0s(),r.j41(3,"div",96)(4,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(6),o=r.XpG();return r.Njj(o.onDragDown(s,o.options,"canvasWidth"))}),r.j41(5,"input",199,200),r.bIt("input",function(){r.eBV(t);const s=r.sdS(6),o=r.XpG();return o.setNumberValue(o.options,"canvasWidth",+s.value),r.Njj(o.updateOptions())}),r.k0s(),r.j41(7,"span",100),r.EFF(8,"Width"),r.k0s()(),r.j41(9,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(11),o=r.XpG();return r.Njj(o.onDragDown(s,o.options,"canvasHeight"))}),r.j41(10,"input",199,201),r.bIt("input",function(){r.eBV(t);const s=r.sdS(11),o=r.XpG();return o.setNumberValue(o.options,"canvasHeight",+s.value),r.Njj(o.updateOptions())}),r.k0s(),r.j41(12,"span",100),r.EFF(13,"Height"),r.k0s()(),r.j41(14,"label",202)(15,"span"),r.EFF(16,"Color"),r.k0s(),r.j41(17,"div",203)(18,"div",204),r.bIt("change",function(s){r.eBV(t);const o=r.XpG();return r.Njj(o.options.backgroundColor=s)}),r.j41(19,"div",61),r.nrm(20,"div",205),r.j41(21,"div",206),r.qSk(),r.j41(22,"svg",207),r.nrm(23,"rect",208),r.k0s()()()()()(),r.joV(),r.j41(24,"div",209)(25,"span"),r.EFF(26,"Sizes"),r.k0s(),r.j41(27,"select",210,211),r.bIt("change",function(){r.eBV(t);const s=r.sdS(28),o=r.XpG();return r.Njj(o.setSizeResolution(s.value))}),r.j41(29,"option",212),r.EFF(30,"Custom"),r.k0s(),r.j41(31,"option",213),r.EFF(32,"Fit to Content"),r.k0s(),r.j41(33,"optgroup",214)(34,"option",215),r.EFF(35,"Twitter Post (1012 \xd7 506)"),r.k0s(),r.j41(36,"option",216),r.EFF(37,"Twitter Header (1500 \xd7 500)"),r.k0s(),r.j41(38,"option",217),r.EFF(39,"Facebook Post (1200 \xd7 630)"),r.k0s(),r.j41(40,"option",218),r.EFF(41,"Facebook Cover (820 \xd7 312)"),r.k0s(),r.j41(42,"option",219),r.EFF(43,"Instagram Post (1080 \xd7 1080)"),r.k0s(),r.j41(44,"option",220),r.EFF(45,"Instagram Story (1080 \xd7 1920)"),r.k0s(),r.j41(46,"option",221),r.EFF(47,"Dribble Shot (400 \xd7 300)"),r.k0s(),r.j41(48,"option",222),r.EFF(49,"Dribble Shot HD (800 \xd7 600)"),r.k0s(),r.j41(50,"option",223),r.EFF(51,"LinkedIn Cover (1584 \xd7 396)"),r.k0s()(),r.j41(52,"optgroup",224)(53,"option",225),r.EFF(54,"16:9 (1920 \xd7 1080)"),r.k0s(),r.j41(55,"option",226),r.EFF(56,"4:3 (1024 \xd7 768)"),r.k0s()(),r.j41(57,"optgroup",227)(58,"option",228),r.EFF(59,"Desktop (1140 \xd7 1024)"),r.k0s(),r.j41(60,"option",229),r.EFF(61,"MacBook (834 \xd7 1194)"),r.k0s(),r.j41(62,"option",230),r.EFF(63,"MacBook Pro (1024 \xd7 1366)"),r.k0s(),r.j41(64,"option",231),r.EFF(65,"Surface Book (1440 \xd7 990)"),r.k0s(),r.j41(66,"option",232),r.EFF(67,"iMac (1368 \xd7 912)"),r.k0s()(),r.j41(68,"optgroup",233)(69,"option",234),r.EFF(70,"iPad Mini (768 \xd7 1024)"),r.k0s(),r.j41(71,"option",229),r.EFF(72,'iPad Pro 11" (834 \xd7 1194)'),r.k0s(),r.j41(73,"option",230),r.EFF(74,'iPad Pro 12.9" (1024 \xd7 1366)'),r.k0s(),r.j41(75,"option",231),r.EFF(76,"Surface Pro 3 (1440 \xd7 990)"),r.k0s(),r.j41(77,"option",232),r.EFF(78,"Surface Pro 4 (1368 \xd7 912)"),r.k0s()(),r.j41(79,"optgroup",235)(80,"option",236),r.EFF(81,"iPhone 11 ProMax (414 \xd7 896)"),r.k0s(),r.j41(82,"option",237),r.EFF(83,"iPhone 11 Pro / X (375 \xd7 812)"),r.k0s(),r.j41(84,"option",238),r.EFF(85,"iPhone 8 Plus (414 \xd7 736)"),r.k0s(),r.j41(86,"option",239),r.EFF(87,"iPhone 8 (375 \xd7 667)"),r.k0s(),r.j41(88,"option",240),r.EFF(89,"Google Pixel 2 (411 \xd7 731)"),r.k0s(),r.j41(90,"option",241),r.EFF(91,"Google Pixel XL (411 \xd7 823)"),r.k0s(),r.j41(92,"option",242),r.EFF(93,"Android (360 \xd7 640)"),r.k0s()(),r.j41(94,"optgroup",243)(95,"option",244),r.EFF(96,"A4 (595 \xd7 842)"),r.k0s(),r.j41(97,"option",245),r.EFF(98,"A5 (420 \xd7 595)"),r.k0s(),r.j41(99,"option",246),r.EFF(100,"A6 (297 \xd7 420)"),r.k0s(),r.j41(101,"option",247),r.EFF(102,"Letter (612 \xd7 792)"),r.k0s(),r.j41(103,"option",248),r.EFF(104,"Tabloid (792 \xd7 1224)"),r.k0s()()(),r.nrm(105,"div",118),r.j41(106,"label",249),r.EFF(107),r.k0s()()(),r.j41(108,"div",106)(109,"h4"),r.EFF(110,"Stroke"),r.k0s(),r.j41(111,"div",96)(112,"label",97),r.bIt("mousedown",function(){r.eBV(t);const s=r.sdS(114),o=r.XpG();return r.Njj(o.onDragDown(s,o.options,"strokeWidth"))}),r.j41(113,"input",107,108),r.bIt("input",function(){r.eBV(t);const s=r.sdS(114),o=r.XpG();return r.Njj(o.setNumberValue(o.options,"strokeWidth",+s.value))}),r.k0s(),r.j41(115,"span",100),r.EFF(116,"Width"),r.k0s(),r.nrm(117,"div",109),r.k0s(),r.j41(118,"div",110)(119,"span"),r.EFF(120,"Dash"),r.k0s(),r.j41(121,"select",111,112),r.bIt("change",function(){r.eBV(t);const s=r.sdS(122),o=r.XpG();return o.options.dasharray=s.value,r.Njj(o.updateOptions())}),r.j41(123,"option",113),r.EFF(124,"\u2014"),r.k0s(),r.j41(125,"option",114),r.EFF(126,"\xb7\xb7\xb7"),r.k0s(),r.j41(127,"option",115),r.EFF(128,"- -"),r.k0s(),r.j41(129,"option",116),r.EFF(130,"-\xb7-"),r.k0s(),r.j41(131,"option",117),r.EFF(132,"-\xb7\xb7-"),r.k0s()(),r.nrm(133,"div",118),r.j41(134,"label",119),r.qex(135,93),r.DNE(136,t_,2,0,"ng-container",94),r.DNE(137,n_,2,0,"ng-container",94),r.DNE(138,i_,2,0,"ng-container",94),r.DNE(139,s_,2,0,"ng-container",94),r.DNE(140,r_,2,0,"ng-container",120),r.bVm(),r.k0s()(),r.j41(141,"label",121)(142,"span",100),r.EFF(143,"Stroke Join"),r.k0s()(),r.j41(144,"label",121)(145,"span",100),r.EFF(146,"Stroke Cap"),r.k0s()()()()()}if(2&n){const t=r.sdS(28),i=r.XpG();r.R7$(5),r.Y8G("value",i.options.canvasWidth),r.R7$(5),r.Y8G("value",i.options.canvasHeight),r.R7$(13),r.BMQ("fill",i.options.backgroundColor),r.R7$(84),r.JRh(t.value),r.R7$(6),r.Y8G("value",i.options.strokeWidth),r.R7$(8),r.Y8G("value",i.options.dasharray),r.R7$(14),r.Y8G("ngSwitch",i.options.dasharray),r.R7$(1),r.Y8G("ngSwitchCase","2,2"),r.R7$(1),r.Y8G("ngSwitchCase","5,5"),r.R7$(1),r.Y8G("ngSwitchCase","5,2,2,2"),r.R7$(1),r.Y8G("ngSwitchCase","5,2,2,2,2,2")}}const a_=[{path:"",component:(()=>{class n{constructor(t){this._whiteboardService=t,this.data=[],this.toolsEnum=xe.VQ,this.elementTypeEnum=xe.Q8,this.selectedTool=xe.VQ.BRUSH,this.selectedElement=null,this.options={strokeColor:"#ec407a",strokeWidth:5,fill:"#000",backgroundColor:"#fff",canvasHeight:600,canvasWidth:800,dasharray:""},this.formatTypes=xe.o8,this.outerWidth=1200,this.outerHeight=750,this.zoom=1,this.x=0,this.y=0,this.loading=!1}ngOnInit(){const t=xr({apiKey:Ee.c.apiKey,authDomain:Ee.c.authDomain,projectId:Ee.c.projectId,storageBucket:Ee.c.storageBucket,messagingSenderId:Ee.c.messagingSenderId,appId:Ee.c.appId,measurementId:Ee.c.measurementId,databaseURL:Ee.c.databaseURL});!function md(n=Ir()){const e=Ue(n=Te(n),Qt);return e.isInitialized()?e.getImmediate():function gd(n,e={}){const t=Ue(n,Qt);if(t.isInitialized()){const s=t.getImmediate();if(Ht(e,t.getOptions()))return s;throw O.create("already-initialized")}return t.initialize({options:e})}(n)}(t);const s=Js(ol(t),"data/");this.loading=!0,el(s,o=>{this.loading=!1;const a=o.val();this.data=a||[]})}ngAfterViewInit(){setTimeout(()=>{this.calculateSize()},0)}onDataChange(t){this.loading||(this.data=t,Zs(Js(ol(),"data/"),t))}calculateSize(){const t=this.workarea.nativeElement,i={w:this.options.canvasWidth,h:this.options.canvasHeight};let s=t.clientWidth,o=t.clientHeight;const a=s,l=o,c=this.zoom;s=Math.max(a,i.w*c*2),o=Math.max(l,i.h*c*2);const h=s/2-a/2,d=o/2-l/2;this.outerWidth=s,this.outerHeight=o,this.updateSize(i.w,i.h),setTimeout(()=>{t.scrollLeft=h,t.scrollTop=d},0)}updateSize(t,i){this.options.canvasWidth=t,this.options.canvasHeight=i;const s=this.zoom,l=this.outerWidth/2-t*s/2,c=this.outerHeight/2-i*s/2;setTimeout(()=>{this.x=l,this.y=c},0)}zoomWheel(t){const i=t;(i.altKey||i.ctrlKey)&&(t.preventDefault(),this.setZoom(Math.trunc(100*this.zoom-i.deltaY/100*(i.altKey?10:5))))}setZoom(t){const i=this.zoom;let s=+t/100;s<.001&&(s=.1);const o={w:this.options.canvasWidth,h:this.options.canvasHeight};let a=null;null!=a&&window.cancelAnimationFrame(a);const l=Date.now(),u=s-i,h=()=>{let p=(Date.now()-l)/500;p=Math.pow(p-1,3)+1,this.zoom=i+u*p,this.updateSize(o.w,o.h),p<1&&p>-.9?a=requestAnimationFrame(h):(this.zoom=s,this.updateSize(o.w,o.h))};h()}setSizeResolution(t){let i=this.options.canvasWidth,s=this.options.canvasHeight;const o=[];if(o[0]=parseInt(t.split("x")[0]),o[1]=parseInt(t.split("x")[1]),"Custom"==t)return;"content"==t&&(o[0]=100,o[1]=100);const a=o[0]-i,l=o[1]-s;let c=null;null!=c&&window.cancelAnimationFrame(c);const u=Date.now(),d=()=>{let f=(Date.now()-u)/500;f=Math.pow(f-1,3)+1,i=parseInt((o[0]-a+f*a).toFixed(0)),s=parseInt((o[1]-l+f*l).toFixed(0)),this.updateSize(i,s),f<1&&f>-.9?c=requestAnimationFrame(d):this.updateSize(i,s)};d()}onDragDown(t,i,s){const o=t.min?parseInt(t.min,10):null,a=t.max?parseInt(t.max,10):null,l=parseInt(t.step,10);let c=200;o&&a&&(c=a-o>0?(a-o)/l:200);const u=c/70*l;let h=0,d=parseInt(t.value,10);const p=m=>{0===h&&(h=m.pageY);const E=-1*(m.pageY-h);h=m.pageY;let A=E*u*1;A.toFixed(l<1?1:0),A=Math.floor(Number(d)+Number(A)),null!==a&&(A=Math.min(A,a)),null!==o&&(A=Math.max(A,o)),d=A,i[s]=d,t.value=d.toString()},f=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}setNumberValue(t,i,s){isNaN(s)||(t[i]=s)}toggleFontWeight(){this.selectedElement&&(this.selectedElement.options.fontWeight="normal"===this.selectedElement.options.fontWeight?"bold":"normal")}toggleFontStyle(){this.selectedElement&&(this.selectedElement.options.fontStyle="normal"===this.selectedElement.options.fontStyle?"italic":"normal")}newDocument(){this._whiteboardService.erase()}saveAs(t){this._whiteboardService.save(t)}addImage(t){if(t){const i=t.files;if(i){const s=new FileReader;s.onload=o=>{this._whiteboardService.addImage(o.target.result)},s.readAsDataURL(i[0])}}}undo(){this._whiteboardService.undo()}redo(){this._whiteboardService.redo()}colorChange(t,i){this.selectedElement?this.selectedElement.options[t]=i:(this.options[t]=i,this.updateOptions())}swapColors(){[this.options.fill,this.options.strokeColor]=[this.options.strokeColor,this.options.fill],this.updateOptions()}updateOptions(){this.options=Object.assign({},this.options)}setSelectedElement(t){this.selectedElement=t}static{this.\u0275fac=function(i){return new(i||n)(r.rXU(xe.Ky))}}static{this.\u0275cmp=r.VBU({type:n,selectors:[["app-whiteboard-live-app"]],viewQuery:function(i,s){if(1&i&&r.GBs(jf,5),2&i){let o;r.mGM(o=r.lsd())&&(s.workarea=o.first)}},features:[r.Jv_([xe.Ky])],decls:130,vars:38,consts:[[1,"editor"],["id","rulers"],["id","ruler_corner"],["id","ruler_x"],["id","ruler_y"],["id","workarea",1,"select",2,"overflow","scroll",3,"mousewheel"],["workarea",""],["id","svgcanvas"],[3,"data","selectedTool","options","strokeWidth","zoom","canvasHeight","canvasWidth","x","y","fullScreen","strokeColor","fill","backgroundColor","dataChange","selectElement","toolChanged"],["whiteboard",""],["id","menu_bar",1,"active"],[1,"menu"],["title","New document",1,"menu_title",3,"click"],["viewBox","0 0 16 16","width","20","height","20"],["fill","#565a66","d","m9.5 1.1l3.4 3.5l.1.4v2h-1V6H8V2H3v11h4v1H2.5l-.5-.5v-12l.5-.5h6.7l.3.1zM9 2v3h2.9L9 2zm4 14h-1v-3H9v-1h3V9h1v3h3v1h-3v3z"],["title","Save Board",1,"menu_title"],["viewBox","0 0 20 20","width","20","height","20"],["d","M12.984 12.656l2.625-2.578 1.406 1.406-5.016 5.016-5.016-5.016 1.406-1.406 2.625 2.578v-9.656h1.969v9.656zM18.984 12h2.016v6.984q0 0.797-0.609 1.406t-1.406 0.609h-13.969q-0.797 0-1.406-0.609t-0.609-1.406v-6.984h2.016v6.984h13.969v-6.984z","fill","#565a66"],["id","file_menu",1,"menu_list","inverted-undo"],[1,"menu_item",3,"click"],["title","Add image",1,"menu_title"],["fill","#565a66","d","M4 5h13v7h2V5c0-1.103-.897-2-2-2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h8v-2H4V5z"],["fill","#565a66","d","m8 11l-3 4h11l-4-6l-3 4z"],["fill","#565a66","d","M19 14h-2v3h-3v2h3v3h2v-3h3v-2h-3z"],["type","file",1,"file-input",3,"change"],["title","Undo",1,"menu_title",3,"click"],["fill","#565a66","d","M9 10h6c1.654 0 3 1.346 3 3s-1.346 3-3 3h-3v2h3c2.757 0 5-2.243 5-5s-2.243-5-5-5H9V5L4 9l5 4v-3z"],["title","Redo",1,"menu_title",3,"click"],["fill","#565a66","d","M9 18h3v-2H9c-1.654 0-3-1.346-3-3s1.346-3 3-3h6v3l5-4l-5-4v3H9c-2.757 0-5 2.243-5 5s2.243 5 5 5z"],["id","panels",1,"tools_panel"],[4,"ngIf"],["main_context_panel",""],["id","tools_left",1,"tools_panel"],["title","Select Tool",1,"tool_button",3,"click"],["viewBox","0 0 24 24","width","24","height","24"],["d","M17.15 20.76l-2.94 1.5-3.68-6-4.41 3V1.24l12.5 12.01-4.41 1.5 2.94 6z"],["title","Brush Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24",2,"transform","scale(-1, 1)"],["d","M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"],["title","Image Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24"],["d","M0 0h24v24H0z","fill","none"],["d","M17 7l-5 5 5 5V7zm-2 9.17L12.83 12 15 9.83 17.17 12 15 14.17zM3 3v18h18V3H3zm16 16H5V5h14v14z"],["title","Line Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["d","M 3 1 L 26 24 L 24 26 L 1 3 L 3 1 Z"],["title","Square/Rect Tool",1,"tool_button",3,"click"],["d","M 0 8 L 0 24 L 24 24 L 25 8 L 0 8 Z"],["title","Ellipse/Circle Tool",1,"tool_button",3,"click"],["cx","13","cy","13","rx","13","ry","9"],["title","Text Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27","height","27"],["d","M5 4v3h5.5v12h3V7H19V4z"],["title","Eraser Tool",1,"tool_button",3,"click"],["d","M19 13H5v-2h14v2z"],["id","color_tools"],["id","tool_switch","title","Switch stroke and fill colors [X]",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 11 11"],["d","M3.01 2A6 6 0 019 8h1.83l-2.91 2.91L5 8h2a4 4 0 00-3.99-4v1.93L.1 3.02 3.01.1V2z"],["id","tool_fill","ngx-colors-trigger","",1,"color_tool","active",3,"change"],["title","Change fill color",1,"icon_label"],[1,"color_block"],["id","fill_bg"],["id","fill_color",1,"color_block"],["xmlns","http://www.w3.org/2000/svg","width","100%"],["width","100%","height","100%","opacity","1"],["id","tool_stroke","ngx-colors-trigger","",1,"color_tool",3,"change"],["title","Change stroke color",1,"icon_label"],["id","stroke_bg"],["id","stroke_color","title","Change stroke color",1,"color_block"],["id","tools_bottom",1,"tools_panel"],["id","zoom_select",3,"change"],["zoomSelect",""],["value","6"],["value","12"],["value","16"],["value","25"],["value","50"],["value","75"],["value","100","selected","selected"],["value","150"],["value","200"],["value","300"],["value","400"],["value","600"],["value","800"],["value","1600"],["id","zoom_panel","title","Change zoom level",1,"toolset"],["id","zoom_label",1,"select-input"],["id","zoomLabel",1,"zoom_tool","icon_label"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27"],["d","M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"],["id","zoom","type","text","readonly","readonly",3,"value"],[3,"ngSwitch"],[4,"ngSwitchCase"],["id","selected_panel",1,"context_panel",2,"display","block"],[1,"draginputs"],[1,"draginput",3,"mousedown"],["step","2","min","-180","max","180","type","text",1,"attr_changer",3,"value","input"],["angle",""],[1,"icon_label"],["id","tool_angle_indicator",1,"angle"],["id","tool_angle_indicator_cursor",1,"angle-cursor"],["step","5","min","0","max","100","type","text",1,"attr_changer",3,"value","input"],["group_opacity",""],["id","group_opacityLabel",1,"icon_label"],["id","stroke_panel",1,"context_panel",2,"display","block"],["size","2","value","1","data-attr","stroke-width","min","0","max","99","step","1",3,"value","input"],["stroke_width",""],[1,"draginput_cursor",2,"top","68.9394px"],[1,"stroke_tool","draginput"],["id","stroke_style",3,"value","change"],["dasharray",""],["selected","selected","value","none"],["value","2,2"],["value","5,5"],["value","5,2,2,2"],["value","5,2,2,2,2,2"],[1,"caret"],["id","stroke_style_label"],[4,"ngSwitchDefault"],[2,"display","none"],["id","path_panel",1,"context_panel","clearfix",2,"display","block"],["type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["path_x",""],["path_y",""],["id","rect_panel",1,"context_panel",2,"display","block"],["rect_x",""],["rect_y",""],["rect_width",""],["rect_height",""],["id","image_panel",1,"context_panel","clearfix",2,"display","block"],["title","Change X coordinate","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["image_x",""],["title","Change Y coordinate","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["image_y",""],["image_width",""],["image_height",""],["id","ellipse_panel",1,"context_panel",2,"display","block"],["id","tool_ellipse_cx",1,"draginput",3,"mousedown"],["title","Change ellipse's cx coordinate","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["ellipse_cx",""],["title","Change ellipse's cy coordinate","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["ellipse_cy",""],["title","Change ellipse's x radius","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["ellipse_rx",""],["title","Change ellipse's y radius","type","text","min","","max","","step","1",1,"attr_changer",3,"value","input"],["ellipse_ry",""],["id","line_panel",1,"context_panel","clearfix",2,"display","block"],["type","text","min","","max","","step","1","title","Change line's starting x coordinate",1,"attr_changer",3,"value","input"],["line_x1",""],["type","text","min","","max","","step","1","title","Change line's starting y coordinate",1,"attr_changer",3,"value","input"],["line_y1",""],["type","text","min","","max","","step","1","title","Change line's ending x coordinate",1,"attr_changer",3,"value","input"],["line_x2",""],["type","text","min","","max","","step","1","title","Change line's ending y coordinate",1,"attr_changer",3,"value","input"],["line_y2",""],["id","Arrow_panel",1,"context_panel","clearfix",2,"display","block"],["id","text_panel",1,"context_panel",2,"display","block"],["data-title","Change Content",1,"draginput","twocol","textcontent"],["id","text","type","text",3,"value","input"],["text",""],["type","text","min","","max","","step","1","title","Change text x coordinate",1,"attr_changer",3,"value","input"],["text_x",""],["type","text","min","","max","","step","1","title","Change text y coordinate",1,"attr_changer",3,"value","input"],["text_y",""],["id","tool_font_family",1,"toolset","draginput","twocol"],["id","preview_font"],["id","font_family","data-title","Change Font Family","size","12","type","hidden"],["id","font_family_dropdown",3,"value","change"],["font_family",""],["value","Arial"],["value","Arial Black"],["value","Comic Sans MS"],["value","Courier New"],["value","Georgia"],["value","Impact"],["value","Lucida Console"],["value","Lucida Sans Unicode"],["value","monospace","selected",""],["value","Palatino Linotype"],["value","sans-serif","selected",""],["value","serif","selected",""],["value","Tahoma"],["value","Times New Roman"],["value","Trebuchet MS"],["value","Verdana"],[1,"draginput","font_style"],["id","tool_bold","data-title","Bold Text [B]",3,"click"],["id","tool_italic","data-title","Italic Text [I]",3,"click"],["id","tool_font_size","data-title","Change Font Size",1,"draginput",3,"mousedown"],["type","text","min","0","max","","step","1","title","Change text font size",1,"attr_changer",3,"value","input"],["font_size",""],["id","font_sizeLabel",1,"icon_label"],["type","text","step","5","min","0","max","100",1,"attr_changer",3,"value","input"],["rect_rx",""],[1,"draginput_cursor",2,"top","70px"],[4,"ngTemplateOutlet"],["id","canvas_panel",1,"context_panel"],["type","text","min","10","max","","step","1","pattern","[0-9]*",3,"value","input"],["canvas_width",""],["canvas_height",""],["data-title","Change canvas color",1,"draginput"],["id","color_canvas_tools"],["id","tool_canvas","ngx-colors-trigger","",1,"color_tool","active",3,"change"],["id","canvas_bg"],["id","canvas_color"],["xmlns","http://www.w3.org/2000/svg","width","60.5"],["width","100%","height","100%"],[1,"draginput"],[3,"change"],["resolution",""],["id","selectedPredefined","selected","selected"],["id","fitToContent","value","content"],["label","Social Media"],["value","1012x506"],["value","1500x500"],["value","1200x630"],["value","820x312"],["value","1080x1080"],["value","1080x1920"],["value","400x300"],["value","800x600"],["value","1584x396"],["label","Presentation"],["value","1920x1080"],["value","1024x768"],["label","Desktop"],["value","1140x1024"],["value","834x1194"],["value","1024x1366"],["value","1440x990"],["value","1368x912"],["label","Tablet"],["value","768x1024"],["label","Phone"],["value","414x896"],["value","375x812"],["value","414x736"],["value","375x667"],["value","411x731"],["value","411x823"],["value","360x640"],["label","Paper"],["value","595x842"],["value","420x595"],["value","297x420"],["value","612x792"],["value","792x1224"],["id","resolution_label"]],template:function(i,s){if(1&i){const o=r.RV6();r.j41(0,"div",0)(1,"div",1),r.nrm(2,"div",2)(3,"div",3)(4,"div",4),r.k0s(),r.j41(5,"div",5,6),r.bIt("mousewheel",function(l){return s.zoomWheel(l)}),r.j41(7,"div",7)(8,"ng-whiteboard",8,9),r.bIt("dataChange",function(l){return s.onDataChange(l)})("selectElement",function(l){return s.setSelectedElement(l)})("toolChanged",function(l){return s.selectedTool=l}),r.k0s()()(),r.j41(10,"div",10)(11,"div",11)(12,"div",12),r.bIt("click",function(){return s.newDocument()}),r.qSk(),r.j41(13,"svg",13),r.nrm(14,"path",14),r.k0s()()(),r.joV(),r.j41(15,"div",11)(16,"div",15),r.qSk(),r.j41(17,"svg",16),r.nrm(18,"path",17),r.k0s()(),r.joV(),r.j41(19,"div",18)(20,"div",19),r.bIt("click",function(){return s.saveAs(s.formatTypes.Png)}),r.EFF(21,"Save as PNG"),r.k0s(),r.j41(22,"div",19),r.bIt("click",function(){return s.saveAs(s.formatTypes.Jpeg)}),r.EFF(23,"Save as JPEG"),r.k0s(),r.j41(24,"div",19),r.bIt("click",function(){return s.saveAs(s.formatTypes.Svg)}),r.EFF(25,"Save as SVG"),r.k0s(),r.j41(26,"div",19),r.bIt("click",function(){return s.saveAs(s.formatTypes.Base64)}),r.EFF(27,"Copy Base-64"),r.k0s()()(),r.j41(28,"div",11)(29,"label",20),r.qSk(),r.j41(30,"svg",16),r.nrm(31,"path",21)(32,"path",22)(33,"path",23),r.k0s(),r.joV(),r.j41(34,"input",24),r.bIt("change",function(l){return s.addImage(l.target)}),r.k0s()()(),r.j41(35,"div",11)(36,"div",25),r.bIt("click",function(){return s.undo()}),r.qSk(),r.j41(37,"svg",16),r.nrm(38,"path",26),r.k0s()()(),r.joV(),r.j41(39,"div",11)(40,"div",27),r.bIt("click",function(){return s.redo()}),r.qSk(),r.j41(41,"svg",16),r.nrm(42,"path",28),r.k0s()()()(),r.joV(),r.j41(43,"div",29),r.DNE(44,Jf,64,20,"ng-container",30),r.DNE(45,e_,2,1,"ng-container",30),r.DNE(46,o_,147,11,"ng-template",null,31,r.C5r),r.k0s(),r.j41(48,"div",32)(49,"div",33),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.SELECT}),r.qSk(),r.j41(50,"svg",34),r.nrm(51,"path",35),r.k0s()(),r.joV(),r.j41(52,"div",36),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.BRUSH}),r.qSk(),r.j41(53,"svg",37),r.nrm(54,"path",38),r.k0s()(),r.joV(),r.j41(55,"div",39),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.IMAGE}),r.qSk(),r.j41(56,"svg",40),r.nrm(57,"path",41)(58,"path",42),r.k0s()(),r.joV(),r.j41(59,"div",43),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.LINE}),r.qSk(),r.j41(60,"svg",44),r.nrm(61,"path",45),r.k0s()(),r.joV(),r.j41(62,"div",46),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.RECT}),r.qSk(),r.j41(63,"svg",44),r.nrm(64,"path",47),r.k0s()(),r.joV(),r.j41(65,"div",48),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.ELLIPSE}),r.qSk(),r.j41(66,"svg",44),r.nrm(67,"ellipse",49),r.k0s()(),r.joV(),r.j41(68,"div",50),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.TEXT}),r.qSk(),r.j41(69,"svg",51),r.nrm(70,"path",52),r.k0s()(),r.joV(),r.j41(71,"div",53),r.bIt("click",function(){return s.selectedTool=s.toolsEnum.ERASER}),r.qSk(),r.j41(72,"svg",40),r.nrm(73,"path",41)(74,"path",54),r.k0s()(),r.joV(),r.j41(75,"div",55)(76,"div",56),r.bIt("click",function(){return s.swapColors()}),r.qSk(),r.j41(77,"svg",57),r.nrm(78,"path",58),r.k0s()(),r.joV(),r.j41(79,"div",59),r.bIt("change",function(l){return s.colorChange("fill",l)}),r.nrm(80,"label",60),r.j41(81,"div",61),r.nrm(82,"div",62),r.j41(83,"div",63),r.qSk(),r.j41(84,"svg",64),r.nrm(85,"rect",65),r.k0s()()()(),r.joV(),r.j41(86,"div",66),r.bIt("change",function(l){return s.colorChange("strokeColor",l)}),r.nrm(87,"label",67),r.j41(88,"div",61),r.nrm(89,"div",68),r.j41(90,"div",69),r.qSk(),r.j41(91,"svg",64),r.nrm(92,"rect",65),r.k0s()()()()()(),r.joV(),r.j41(93,"div",70)(94,"select",71,72),r.bIt("change",function(){r.eBV(o);const l=r.sdS(95);return r.Njj(s.setZoom(l.value))}),r.j41(96,"option",73),r.EFF(97,"6%"),r.k0s(),r.j41(98,"option",74),r.EFF(99,"12%"),r.k0s(),r.j41(100,"option",75),r.EFF(101,"16%"),r.k0s(),r.j41(102,"option",76),r.EFF(103,"25%"),r.k0s(),r.j41(104,"option",77),r.EFF(105,"50%"),r.k0s(),r.j41(106,"option",78),r.EFF(107,"75%"),r.k0s(),r.j41(108,"option",79),r.EFF(109,"100%"),r.k0s(),r.j41(110,"option",80),r.EFF(111,"150%"),r.k0s(),r.j41(112,"option",81),r.EFF(113,"200%"),r.k0s(),r.j41(114,"option",82),r.EFF(115,"300%"),r.k0s(),r.j41(116,"option",83),r.EFF(117,"400%"),r.k0s(),r.j41(118,"option",84),r.EFF(119,"600%"),r.k0s(),r.j41(120,"option",85),r.EFF(121,"800%"),r.k0s(),r.j41(122,"option",86),r.EFF(123,"1600%"),r.k0s()(),r.j41(124,"div",87)(125,"div",88)(126,"span",89),r.qSk(),r.j41(127,"svg",90),r.nrm(128,"path",91),r.k0s()(),r.joV(),r.nrm(129,"input",92),r.k0s()()()()}2&i&&(r.R7$(7),r.xc7("width",s.outerWidth,"px")("height",s.outerHeight,"px"),r.R7$(1),r.Y8G("data",s.data)("selectedTool",s.selectedTool)("options",s.options)("strokeWidth",s.options.strokeWidth)("zoom",s.zoom)("canvasHeight",s.options.canvasHeight)("canvasWidth",s.options.canvasWidth)("x",s.x)("y",s.y)("fullScreen",!1)("strokeColor",s.options.strokeColor)("fill",s.options.fill)("backgroundColor",s.options.backgroundColor),r.R7$(36),r.Y8G("ngIf",s.selectedElement),r.R7$(1),r.Y8G("ngIf",!s.selectedElement),r.R7$(4),r.AVh("active",s.selectedTool===s.toolsEnum.SELECT),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.BRUSH),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.IMAGE),r.R7$(4),r.AVh("active",s.selectedTool===s.toolsEnum.LINE),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.RECT),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.ELLIPSE),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.TEXT),r.R7$(3),r.AVh("active",s.selectedTool===s.toolsEnum.ERASER),r.R7$(14),r.BMQ("fill",s.options.fill),r.R7$(7),r.BMQ("fill",s.options.strokeColor),r.R7$(37),r.Y8G("value",100*s.zoom+"%"))},dependencies:[ze.bT,ze.T3,ze.ux,ze.e1,ze.fG,Lf.I,al.db],styles:['@charset "UTF-8";.demo{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.editor{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;margin:0;padding:0}::selection{background:#000;color:#fff}::-moz-selection{background:#000;color:#fff}.editor{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}::-webkit-scrollbar-track{border-radius:10px;background:transparent}::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}::-webkit-scrollbar-corner{background:transparent}input[type=submit],input[type=button],button{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit]:hover,input[type=button]:hover,button:hover{background:var(--accent9)}input[type=submit]:active,input[type=button]:active,button:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit]:focus,input[type=button]:focus,button:focus{outline:none}button.cancel,input.Cancel,input.cancel,input.jGraduate_Cancel{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel{display:block}#tool_bold span,#tool_italic span{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix:before,.clearfix:after{content:"";display:table}.clearfix:after{clear:both}#color_canvas_tools,#fill_bg,#stroke_bg{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools{display:block}#stroke_style_label{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool .caret{top:60%}.draginputs{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging .draginput{pointer-events:none}.dragging .draginput.active{pointer-events:all;box-shadow:none}.draginput:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput:hover span,.draginput.active span{color:var(--z15)}.draginput:hover input,.draginput.active input{color:var(--accent8)}.draginput.active,.draginput.active:hover{background-color:var(--z0)}.draginput.active:hover{transition:none}.draginput .caret{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput label{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput label#resolution_label,.draginput label#seg_type_label{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput label#seg_type_label{margin-top:40px}.draginput label#seg_type_label .caret{top:66%}.draginput label#resolution_label .pull{position:relative;left:-15px}.draginput label#resolution_label span{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput input{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput input::selection{background:var(--accent9)}.draginput.text-input input,.draginput.text-input input:hover,.draginput.text-input input:active{cursor:text}.draginput.text-input input{text-align:left;text-indent:var(--x2)}.draginput.textcontent input{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent input,.draginput.textcontent input:hover,.draginput.textcontent input:active{cursor:text}.draginput input,.draginput input:hover,.draginput input:active{cursor:grab;cursor:-moz-grab}.draginput input[type=checkbox],.draginput input[type=checkbox]:hover,.draginput input[type=checkbox]:active{cursor:pointer}.draginput input:invalid{color:var(--a7)}.draginput span{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput select{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput:hover .draginput_cursor{border-color:var(--accent6)}.draginput_cursor{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput input[readonly=readonly]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.draginput input:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput input:focus+span{z-index:10;color:var(--z15)}.draginput .push_bottom{bottom:0;position:absolute}.draginput .angle{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging .draginput .angle{background-color:var(--z1)}.draginput:hover .angle{background:var(--z4)}.draginput .angle-cursor{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar{padding:0 0 0 var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar .menu:hover .menu_list{display:block}.menu{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu .menu_title:hover{background:var(--z2)}.menu_list .separator{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active .menu.open .menu_title{background:var(--z15);color:var(--z1)}.menu .menu_list{display:none;position:absolute}.menu_list .menu_item{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list .menu_item.tool_button{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list .menu_item.push_button_pressed:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list .menu_item:hover,.menu_list .menu_item.push_button_pressed:hover{background:var(--accent15);color:#000}.menu_list .menu_item.disabled:hover,.menu_list .menu_item.push_button_pressed.disabled:hover{background:transparent;color:var(--z3)}.menu_list .menu_item.push_button_pressed{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list .menu_item span{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list .menu_item:not(.disabled):hover span{background:var(--accent13)}.menu-right button:hover svg{fill:var(--z12)}.menu-right svg{fill:var(--z5)}#logo svg{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo svg path:last-child{fill:var(--z13)}#logo:hover svg{fill:var(--z9)}#logo svg path:last-child{fill:var(--z15)}#rulers>div{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers #ruler_corner{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x>div,#ruler_y>div{overflow:hidden}#stroke_color:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch svg{fill:var(--z6)}#tool_switch:hover svg{fill:var(--z15)}.color_block{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block svg{width:22px;height:22px}#tool_stroke .color_block>div{position:absolute;bottom:0;right:0}#color_tools{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools{width:auto;height:auto}#tool_fill{position:absolute;top:0;left:0;z-index:1}#tool_stroke{top:14px;left:14px}#tool_fill,#tool_stroke,#tool_canvas{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas .color_block{width:58px;height:38px}#tool_canvas .color_block svg{width:auto;height:auto}#shape_cats>div{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas{background-color:var(--z2);display:block;width:100%;height:100%}#workarea{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button:hover{transform:scale(1)}.tool_button:hover svg{fill:var(--z13)}.tool_button.active{transform:scale(1.4)}.tool_button svg{vertical-align:center;fill:var(--z5)}.tool_button.active svg{fill:var(--accent8)}.tool_button.active svg{fill:var(--accent7)}.tool_button.disabled svg{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect svg{position:relative;top:-1px;left:1px}#tool_ellipse svg{position:relative;top:2px;left:1px}.select-input{margin:var(--x2) 0;position:relative}.select-input:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input select{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input select:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel{display:none}.context_panel h4{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel label{display:block;color:var(--z13);white-space:nowrap}#align_tools{display:none}.align_buttons{margin-bottom:var(--x2)}.align_button,.align_button *{transition:var(--transition)}.align_button:hover,.align_button:hover *{transition:none}.align_button{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button:hover{background-color:var(--z0);border-color:var(--z3)}.align_button svg{fill:var(--z10)}.align_button:hover svg{fill:var(--z15);transition:none}.align_button:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons .push_button{display:block;float:left}#tool_bold,#tool_italic{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold{right:0}#tool_italic{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold:hover,#tool_italic:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled,#tool_italic.disabled{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active,#tool_italic.active{color:#50a0ff}#preview_font{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font+.caret{right:var(--x2)}.draginput:hover #preview_font:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel,#zoom_select{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label:after{content:""}#zoom_select{opacity:0;z-index:100}#zoom_select:hover+div{opacity:1}#zoom_label{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel .caret{margin-top:-5px}#zoom_label img,#zoom_label svg{width:var(--x4);height:var(--x4)}#zoomLabel{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel svg{fill:var(--z10);position:relative;top:2px}#zoom_label input{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label select{-webkit-appearance:none;position:absolute;inset:0}#zoom_label span{top:0;left:0}\n'],encapsulation:3})}}return n})()}];let l_=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=r.$C({type:n})}static{this.\u0275inj=r.G2t({imports:[ir.iI.forChild(a_),ir.iI]})}}return n})(),c_=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=r.$C({type:n})}static{this.\u0275inj=r.G2t({imports:[ze.MD,l_,xe.bn,al.gG]})}}return n})()}}]);